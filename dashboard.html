<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Lloyd's GO!">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#007A3D">
    <meta name="msapplication-TileColor" content="#007A3D">
    <title>Lloyd's GO! - Tableau de bord</title>
    
    <!-- Google Fonts - Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- EmailJS SDK pour l'envoi d'emails -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    
    <!-- Chart.js pour les graphiques en temps r√©el -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            color: #333;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 200px;
            background: linear-gradient(180deg, rgba(0, 122, 61, 0.225) 0%, rgba(0, 122, 61, 0.12) 50%, transparent 100%);
            pointer-events: none;
            z-index: 1;
        }

        .dashboard-container {
            display: flex;
            min-height: 100vh;
        }

        /* Bottom Navigation - Style Coinbase/Trust Wallet */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            border-top: 1px solid #E5E7EB;
            padding: 8px 0;
            z-index: 1000;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.1);
        }

        .nav-container {
            display: flex;
            justify-content: space-around;
            align-items: center;
            max-width: 400px;
            margin: 0 auto;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 8px 12px;
            border-radius: 12px;
            transition: all 0.3s ease;
            cursor: pointer;
            min-width: 60px;
        }

        .nav-icon {
            font-size: 24px;
            transition: all 0.3s ease;
        }

        .nav-label {
            font-size: 10px;
            font-weight: 600;
            color: #6B7280;
            transition: all 0.3s ease;
        }

        .nav-item.active .nav-icon {
            color: #007A3D;
            transform: scale(1.1);
        }

        .nav-item.active .nav-label {
            color: #007A3D;
        }

        .nav-item:not(.active):hover {
            background: #F9FAFB;
        }

        .nav-item:not(.active):hover .nav-icon {
            color: #007A3D;
        }

        .nav-item:not(.active):hover .nav-label {
            color: #007A3D;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            padding: 30px;
            padding-bottom: 100px; /* Space for bottom navigation */
        }

        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
            position: relative;
        }

        .profile-container {
            position: absolute;
            right: 0;
            top: 0;
            margin: 0;
        }

        .profile-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #007A3D 0%, #005A2D 100%);
            border-radius: 50%;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0, 122, 61, 0.3);
            color: white;
            font-size: 18px;
            font-weight: 700;
            font-family: 'Arial', sans-serif;
            text-shadow: 0 1px 2px rgba(0,0,0,0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .profile-icon:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 16px rgba(0, 122, 61, 0.4);
        }

        .profile-icon:active {
            transform: scale(0.95);
        }

        .profile-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15);
            padding: 16px;
            min-width: 200px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 1000;
            border: 1px solid rgba(0,0,0,0.05);
        }

        .profile-dropdown.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .profile-info {
            border-bottom: 1px solid #f0f0f0;
            padding-bottom: 12px;
            margin-bottom: 12px;
        }

        .profile-name {
            font-size: 16px;
            font-weight: 600;
            color: #1F2937;
            margin-bottom: 4px;
        }

        .profile-email {
            font-size: 14px;
            color: #6B7280;
        }

        .profile-actions {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .profile-action-btn {
            background: none;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 14px;
            color: #1F2937;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: left;
            width: 100%;
            display: block;
        }

        .profile-action-btn:hover {
            background: #f9fafb;
            color: #007A3D;
            transform: translateX(4px);
        }

        .profile-action-btn:active {
            background: #e5e7eb;
            transform: translateX(2px);
        }

        .page-title {
            font-size: 18px;
            font-weight: 500;
            color: #6B7280;
            text-align: left;
        }

        /* Logo Styles */
        .logo-container {
            display: flex;
            align-items: center;
            gap: 12px;
            margin: 0;
            position: relative;
        }

        .logo-horse {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #007A3D 0%, #005A2D 100%);
            border-radius: 12px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0, 122, 61, 0.3);
        }

        .logo-horse {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #007A3D 0%, #005A2D 100%);
            border-radius: 50%;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0, 122, 61, 0.3);
            color: #1a1a1a;
            font-size: 22px;
            font-weight: 900;
            font-family: 'Georgia', 'Times New Roman', serif;
            text-shadow: 0 1px 2px rgba(255,255,255,0.3);
        }

        .logo-container h1 {
            font-size: 24px;
            font-weight: 700;
            font-family: 'Segoe UI', 'Helvetica Neue', 'Arial', sans-serif;
            background: linear-gradient(135deg, #007A3D 0%, #005A2D 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 0;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            letter-spacing: 0.8px;
        }



        .header-actions {
            display: flex;
            gap: 15px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #007A3D, #005A2C);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 122, 61, 0.3);
        }

        .btn-secondary {
            background: white;
            color: #1F2937;
            border: 2px solid #1F2937;
        }

        .btn-secondary:hover {
            background: #1F2937;
            color: white;
        }

        /* Page Content */
        .page-content {
            display: none;
        }

        .page-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Home Page - Style Lloyd's Bank */
        .balance-overview-card {
            background: linear-gradient(135deg, #1a3d1a 0%, #0f2a0f 100%);
            color: white;
            padding: 32px;
            border-radius: 16px;
            margin-bottom: 30px;
            border: 1px solid #2d5a2d;
            box-shadow: 0 8px 24px rgba(26, 61, 26, 0.3);
            animation: fadeInBalance 1.2s ease-out;
            opacity: 0;
            animation-fill-mode: forwards;
        }

        @keyframes fadeInBalance {
            0% {
                opacity: 0;
                transform: translateY(20px) scale(0.95);
            }
            50% {
                opacity: 0.7;
                transform: translateY(-5px) scale(1.02);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .balance-overview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid #4a7c4a;
        }

        .balance-overview-title {
            font-size: 18px;
            font-weight: 600;
            color: #a8d5a8;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .balance-overview-amount {
            font-size: 32px;
            font-weight: 700;
            color: white;
            font-family: 'Inter', 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        .balance-overview-details {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .balance-detail-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
        }

        .detail-label {
            font-size: 14px;
            color: #999999;
            font-weight: 500;
        }

        .detail-value {
            font-size: 16px;
            font-weight: 600;
            color: white;
            font-family: 'Inter', 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        .balance-display {
            margin-top: 20px;
            padding: 25px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .balance-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
            margin-top: 20px;
        }

        .balance-label {
            font-size: 14px;
            font-weight: 500;
            opacity: 0.9;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .balance-amount-large {
            font-size: 42px;
            font-weight: 800;
            margin-bottom: 8px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            animation: balancePulse 2s ease-in-out infinite;
        }

        @keyframes balancePulse {
            0%, 100% {
                transform: scale(1);
                text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            }
            50% {
                transform: scale(1.02);
                text-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
            }
        }

        .balance-change {
            font-size: 14px;
            font-weight: 500;
            padding: 6px 16px;
            border-radius: 20px;
            display: inline-block;
            background: rgba(255, 255, 255, 0.2);
        }

        .balance-change.positive {
            background: rgba(16, 185, 129, 0.3);
            color: #10B981;
        }

        .balance-change.negative {
            background: rgba(239, 68, 68, 0.3);
            color: #EF4444;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 30px;
            border-radius: 24px;
            box-shadow: 0 12px 40px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            border: 2px solid rgba(0,0,0,0.05);
            position: relative;
            overflow: hidden;
            animation: cardSlideIn 0.6s ease-out;
            animation-fill-mode: both;
        }

        .stat-card:nth-child(1) { animation-delay: 0.1s; }
        .stat-card:nth-child(2) { animation-delay: 0.2s; }
        .stat-card:nth-child(3) { animation-delay: 0.3s; }

        @keyframes cardSlideIn {
            0% {
                opacity: 0;
                transform: translateY(20px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #007A3D, #005A2C);
        }

        .stat-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.12);
        }

        .stat-value {
            font-size: 42px;
            font-weight: 300;
            font-family: 'Inter', 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #007A3D, #005A2C);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 12px;
            line-height: 1.1;
            letter-spacing: -0.02em;
        }

        .stat-change {
            font-size: 14px;
            color: #10B981;
            font-weight: 600;
            font-family: 'Inter', 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            display: flex;
            align-items: center;
            gap: 6px;
            margin-bottom: 8px;
            letter-spacing: 0.3px;
        }

        .stat-change.negative {
            color: #EF4444;
        }

        .stat-card p {
            color: #6B7280;
            font-weight: 500;
            font-family: 'Inter', 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            font-size: 14px;
            margin-top: 0;
            text-transform: uppercase;
            letter-spacing: 0.8px;
        }



        /* Quick Actions */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 30px;
        }

        .action-card {
            background: white;
            padding: 24px;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.06);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 1px solid rgba(0,0,0,0.05);
            text-align: center;
        }

        .action-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 30px rgba(0,0,0,0.12);
        }

        .action-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #007A3D, #005A2C);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 16px;
            color: white;
            font-size: 20px;
        }

        .action-title {
            font-weight: 600;
            color: #1F2937;
            margin-bottom: 8px;
        }

        .action-desc {
            font-size: 14px;
            color: #6B7280;
        }

        /* News Section */
        .news-section {
            margin-bottom: 30px;
        }

        .news-section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .section-title {
            font-size: 24px;
            font-weight: 700;
            color: #1F2937;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title::before {
            content: '';
            width: 4px;
            height: 24px;
            background: linear-gradient(135deg, #007A3D, #005A2C);
            border-radius: 2px;
        }

        .news-controls {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .news-refresh-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: #FF6B35;
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
            font-weight: 500;
        }

        .news-refresh-btn:hover {
            background: #e55a2b;
            transform: translateY(-2px);
        }

        .news-refresh-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .news-status {
            font-size: 12px;
            color: #6B7280;
            font-weight: 500;
        }

        .news-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .news-loading {
            grid-column: 1 / -1;
            text-align: center;
            padding: 40px;
            color: #6B7280;
        }

        .news-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #FF6B35;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .news-card {
            background: white;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            border: 1px solid rgba(0,0,0,0.05);
            cursor: pointer;
        }

        .news-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 30px rgba(0,0,0,0.15);
        }

        .news-image {
            width: 100%;
            height: 180px;
            overflow: hidden;
            position: relative;
        }

        .news-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .news-card:hover .news-image img {
            transform: scale(1.05);
        }

        .news-content {
            padding: 20px;
        }

        .news-category {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 12px;
        }

        .news-category.crypto {
            background: rgba(16, 185, 129, 0.1);
            color: #10B981;
        }

        .news-category.cointelegraph {
            background: #FF6B35;
            color: white;
        }

        .news-category.finance {
            background: rgba(59, 130, 246, 0.1);
            color: #3B82F6;
        }

        .news-category.economy {
            background: rgba(59, 130, 246, 0.1);
            color: #3B82F6;
        }

        .news-category.tech {
            background: rgba(168, 85, 247, 0.1);
            color: #A855F7;
        }

        .news-title {
            font-size: 16px;
            font-weight: 600;
            color: #1F2937;
            margin-bottom: 8px;
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .news-excerpt {
            font-size: 14px;
            color: #6B7280;
            line-height: 1.5;
            margin-bottom: 16px;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .news-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 12px;
            color: #9CA3AF;
        }

        .news-time {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .news-time::before {
            content: 'üïê';
            font-size: 10px;
        }

        .news-source {
            font-weight: 500;
            color: #007A3D;
        }

        /* Top Performers Section */
        .top-performers {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .performer-card {
            background: linear-gradient(135deg, #007A3D 0%, #005A2C 100%);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 122, 61, 0.3);
            border: 1px solid #007A3D;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .performer-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 16px 40px rgba(0, 122, 61, 0.4);
            border-color: #10B981;
        }

        .performer-card.gainer {
            border-left: 3px solid #10B981;
        }

        .performer-card.loser {
            border-left: 3px solid #EF4444;
        }

        .performer-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
        }

        .performer-title {
            font-size: 12px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.8);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .performer-badge {
            font-size: 14px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .performer-content {
            text-align: center;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .performer-name {
            font-size: 18px;
            font-weight: 700;
            color: #FFFFFF;
            margin-bottom: 8px;
        }

        .performer-change {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            margin-bottom: 8px;
            font-size: 20px;
            font-weight: 800;
        }

        .change-icon {
            font-size: 16px;
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-2px); }
        }

        .performer-change.positive {
            color: #FFFFFF;
        }

        .performer-change.negative {
            color: #FFFFFF;
        }

        .performer-price {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 500;
            margin-bottom: 16px;
        }

        .performer-chart {
            opacity: 0.7;
            transition: opacity 0.3s ease;
            margin-top: auto;
        }

        .performer-card:hover .performer-chart {
            opacity: 1;
        }

        .performer-card.gainer .performer-chart {
            color: #FFFFFF;
        }

        .performer-card.loser .performer-chart {
            color: #FFFFFF;
        }

        /* Section Divider */
        .section-divider {
            height: 3px;
            background: linear-gradient(90deg, transparent 0%, #000000 15%, #111827 35%, #000000 50%, #111827 65%, #000000 85%, transparent 100%);
            margin: 30px 0;
            opacity: 1;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.5);
        }

        .chart-line {
            stroke-dasharray: 200;
            stroke-dashoffset: 200;
            animation: drawLine 2s ease-out forwards;
        }

        .gainer-line {
            animation-delay: 0.5s;
        }

        .loser-line {
            animation-delay: 0.5s;
        }

        .chart-dot {
            opacity: 0;
            animation: fadeInDot 0.5s ease-out 2.5s forwards;
        }

        @keyframes drawLine {
            to {
                stroke-dashoffset: 0;
            }
        }

        @keyframes fadeInDot {
            to {
                opacity: 1;
            }
        }

        /* Wallet Page Styles */
        .balance-overview {
            margin-bottom: 30px;
        }

        .balance-card {
            background: linear-gradient(135deg, #007A3D 0%, #005A2C 100%);
            color: white;
            padding: 40px;
            border-radius: 24px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0, 122, 61, 0.3);
            animation: welcomeSlideIn 0.8s ease-out;
        }

        .balance-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: float 6s ease-in-out infinite;
        }

        .balance-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
            margin-top: 20px;
            position: relative;
            z-index: 1;
        }

        .balance-header h3 {
            font-size: 18px;
            font-weight: 600;
            opacity: 0.9;
        }

        .balance-actions {
            display: flex;
            gap: 8px;
        }

        .btn-icon {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 8px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-icon:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }

        .btn-icon:active {
            transform: scale(0.95);
        }

        .balance-amount {
            font-size: 36px;
            font-weight: 800;
            margin-bottom: 8px;
        }

        .balance-change {
            font-size: 14px;
            font-weight: 500;
            padding: 6px 16px;
            border-radius: 20px;
            display: inline-block;
            background: rgba(255, 255, 255, 0.2);
            position: relative;
            z-index: 1;
        }

        .balance-change.positive {
            color: #10B981;
        }

        .balance-change.negative {
            color: #EF4444;
        }

        /* Balance Actions Row */
        .balance-actions-row {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin-top: 20px;
            padding: 0 5px;
        }

        .balance-action-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 16px 8px;
            color: #10B981;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s ease;
            cursor: pointer;
            backdrop-filter: blur(10px);
            min-height: 80px;
            width: 100%;
        }

        .balance-action-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .balance-action-btn .action-icon {
            width: 32px;
            height: 32px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #10B981;
            flex-shrink: 0;
        }

        .balance-action-btn span {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: #10B981;
            text-align: center;
            line-height: 1.2;
            white-space: nowrap;
        }

        /* AI Investment Assistant */
        .ai-assistant-section {
            margin-top: 30px;
            background: linear-gradient(135deg, #1F2937 0%, #111827 100%);
            border-radius: 20px;
            padding: 24px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid #374151;
        }

        .ai-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 24px;
        }

        .ai-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #10B981, #059669);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .ai-title h3 {
            color: #F9FAFB;
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .ai-title p {
            color: #9CA3AF;
            font-size: 14px;
            margin: 0;
        }

        /* Chat Interface Styles */
        .chat-container {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            overflow: hidden;
            height: 400px;
            display: flex;
            flex-direction: column;
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 18px;
            word-wrap: break-word;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .user-message {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            align-self: flex-end;
            margin-left: auto;
        }

        .ai-message {
            background: rgba(255, 255, 255, 0.1);
            color: #F9FAFB;
            align-self: flex-start;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .ai-message .bot-name {
            font-weight: bold;
            color: #10B981;
            margin-bottom: 5px;
            font-size: 12px;
        }

        .typing-indicator {
            display: none;
            align-self: flex-start;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 18px;
            padding: 12px 16px;
            margin: 0 20px 10px 20px;
        }

        .typing-dots {
            display: flex;
            gap: 4px;
        }

        .typing-dots span {
            width: 8px;
            height: 8px;
            background: #94a3b8;
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }

        .typing-dots span:nth-child(2) { animation-delay: 0.2s; }
        .typing-dots span:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }

        .chat-input-container {
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .chat-input-wrapper {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .chat-input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            font-size: 14px;
            outline: none;
            transition: border-color 0.3s;
            background: rgba(255, 255, 255, 0.1);
            color: #F9FAFB;
        }

        .chat-input:focus {
            border-color: #10B981;
        }

        .chat-input::placeholder {
            color: #9CA3AF;
        }

        .send-button {
            background: linear-gradient(135deg, #10B981, #059669);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s;
            font-size: 16px;
        }

        .send-button:hover {
            transform: scale(1.05);
        }

        .send-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .suggestions {
            display: flex;
            gap: 8px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .suggestion-chip {
            background: rgba(255, 255, 255, 0.1);
            color: #F9FAFB;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .suggestion-chip:hover {
            background: #10B981;
            color: white;
            border-color: #10B981;
        }

        .crypto-data {
            display: inline-block;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 4px 8px;
            border-radius: 8px;
            font-weight: bold;
            margin: 2px;
        }

        .warning {
            background: rgba(245, 243, 199, 0.1);
            color: #fbbf24;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 12px;
            margin-top: 8px;
            border-left: 3px solid #f59e0b;
        }

        .ai-suggestions {
            display: grid;
            gap: 16px;
            margin-bottom: 24px;
        }

        .suggestion-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .suggestion-card:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .suggestion-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .suggestion-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .suggestion-icon.positive {
            background: rgba(16, 185, 129, 0.2);
        }

        .suggestion-icon.neutral {
            background: rgba(59, 130, 246, 0.2);
        }

        .suggestion-type {
            font-size: 12px;
            font-weight: 600;
            color: #9CA3AF;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .suggestion-card h4 {
            color: #F9FAFB;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .suggestion-card p {
            color: #D1D5DB;
            font-size: 14px;
            line-height: 1.5;
            margin-bottom: 12px;
        }

        .suggestion-metrics {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .metric {
            background: rgba(255, 255, 255, 0.1);
            color: #10B981;
            font-size: 12px;
            font-weight: 600;
            padding: 4px 8px;
            border-radius: 6px;
        }

        .ai-actions {
            display: flex;
            gap: 12px;
        }

        .ai-btn {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px 16px;
            border: none;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .ai-btn.primary {
            background: linear-gradient(135deg, #10B981, #059669);
            color: white;
        }

        .ai-btn.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .ai-btn.secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #D1D5DB;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .ai-btn.secondary:hover {
            background: rgba(255, 255, 255, 0.15);
            color: #F9FAFB;
        }

        .assets-section {
            margin-bottom: 30px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .crypto-header-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .realtime-indicator {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 4px 8px;
            background: rgba(16, 185, 129, 0.1);
            border-radius: 12px;
            border: 1px solid rgba(16, 185, 129, 0.2);
        }

        .realtime-dot {
            width: 8px;
            height: 8px;
            background: #10B981;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .realtime-text {
            font-size: 11px;
            font-weight: 600;
            color: #10B981;
        }

                 @keyframes pulse {
             0% { opacity: 1; }
             50% { opacity: 0.5; }
             100% { opacity: 1; }
         }

         .refresh-btn {
             background: none;
             border: none;
             padding: 8px;
             border-radius: 8px;
             cursor: pointer;
             color: #007A3D;
             transition: all 0.3s ease;
             display: flex;
             align-items: center;
             justify-content: center;
             position: relative;
         }
         
         .refresh-btn:disabled {
             opacity: 0.6;
             cursor: not-allowed;
         }
         
         .refresh-btn::after {
             content: '';
             position: absolute;
             width: 16px;
             height: 16px;
             border: 2px solid transparent;
             border-top: 2px solid #007A3D;
             border-radius: 50%;
             animation: spin 1s linear infinite;
             opacity: 0;
             transition: opacity 0.3s ease;
         }
         
         .refresh-btn:disabled::after {
             opacity: 1;
         }
         
         @keyframes spin {
             0% { transform: rotate(0deg); }
             100% { transform: rotate(360deg); }
         }

         .refresh-btn:hover {
             background: rgba(0, 122, 61, 0.1);
             transform: rotate(180deg);
         }

         .refresh-btn:active {
             transform: rotate(360deg);
         }

        .section-header h3 {
            font-size: 20px;
            font-weight: 700;
            color: #1F2937;
        }

        .btn-text {
            background: none;
            border: none;
            color: #007A3D;
            font-weight: 600;
            cursor: pointer;
            padding: 8px 16px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .btn-text:hover {
            background: rgba(0, 122, 61, 0.1);
        }

        .crypto-list {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.06);
            overflow: hidden;
        }

        .crypto-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid #F3F4F6;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .crypto-item:last-child {
            border-bottom: none;
        }

        .crypto-item {
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .crypto-item:hover {
            background: rgba(0, 122, 61, 0.05);
            transform: translateY(-2px);
        }

        .hidden-crypto {
            display: none;
        }

        .hidden-crypto.show {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .crypto-info {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .crypto-icon {
            width: 56px;
            height: 56px;
            background: white;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            overflow: hidden;
        }

        .crypto-icon img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            border-radius: 6px;
        }

        .crypto-details {
            display: flex;
            flex-direction: column;
        }

        .crypto-name {
            font-weight: 600;
            color: #1F2937;
            margin-bottom: 4px;
        }

        .crypto-amount {
            font-size: 14px;
            color: #6B7280;
        }

        .crypto-value {
            text-align: right;
        }

        .value-amount {
            font-weight: 600;
            color: #1F2937;
            margin-bottom: 4px;
        }

        .value-change {
            font-size: 14px;
            font-weight: 600;
        }

        .value-change.positive {
            color: #10B981;
        }

                 .value-change.negative {
             color: #EF4444;
         }



         .crypto-value {
             text-align: right;
             display: flex;
             flex-direction: column;
             align-items: flex-end;
             gap: 4px;
         }

        .wallet-actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
        }

        .action-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            padding: 20px;
            border: none;
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .action-btn.primary {
            background: linear-gradient(135deg, #007A3D, #005A2C);
            color: white;
        }

        .action-btn.secondary {
            background: white;
            color: #1F2937;
            border: 1px solid #E5E7EB;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .action-btn .action-icon {
            font-size: 24px;
        }

        /* Banking Page Styles */
        .account-overview {
            margin-bottom: 30px;
        }

        .account-card {
            background: linear-gradient(135deg, #1F2937 0%, #374151 100%);
            color: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(31, 41, 55, 0.3);
        }

        .account-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 25px;
        }

        .account-info h3 {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .account-info p {
            font-size: 14px;
            opacity: 0.8;
        }

        .account-balance {
            text-align: right;
        }

        .account-balance .balance-amount {
            display: block;
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 4px;
        }

        .account-balance .balance-label {
            font-size: 14px;
            opacity: 0.8;
        }

        .account-actions {
            display: flex;
            gap: 12px;
        }

        .account-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 12px 20px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 14px;
        }

        .account-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .transactions-section {
            margin-bottom: 30px;
        }

        .transactions-list {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.06);
            overflow: hidden;
        }

        .transaction-item {
            display: flex;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid #F3F4F6;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .transaction-item:last-child {
            border-bottom: none;
        }

        .transaction-item:hover {
            background: #F9FAFB;
        }

        .transaction-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            margin-right: 16px;
        }

        .transaction-icon.credit {
            background: linear-gradient(135deg, #10B981, #059669);
            color: white;
        }

        .transaction-icon.debit {
            background: linear-gradient(135deg, #EF4444, #DC2626);
            color: white;
        }

        .transaction-details {
            flex: 1;
        }

        .transaction-title {
            font-weight: 600;
            color: #1F2937;
            margin-bottom: 4px;
        }

        .transaction-date {
            font-size: 14px;
            color: #6B7280;
        }

        .transaction-amount {
            font-weight: 700;
            font-size: 16px;
        }

        .transaction-amount.credit {
            color: #10B981;
        }

        .transaction-amount.debit {
            color: #EF4444;
        }

        .banking-actions {
            margin-bottom: 30px;
        }

        .action-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
        }

        .banking-action {
            background: white;
            border: 1px solid #E5E7EB;
            border-radius: 16px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            text-align: center;
        }

        .banking-action:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 30px rgba(0,0,0,0.1);
            border-color: #007A3D;
        }

        .banking-action .action-icon {
            font-size: 24px;
            margin-bottom: 4px;
        }

        .banking-action span {
            font-weight: 600;
            color: #1F2937;
            font-size: 14px;
        }

        /* Analytics Page Styles */
        .performance-overview {
            margin-bottom: 30px;
        }

        .performance-card {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.08);
            border: 1px solid rgba(0,0,0,0.05);
        }

        .performance-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .performance-header h3 {
            font-size: 20px;
            font-weight: 700;
            color: #1F2937;
        }

        .time-filter {
            display: flex;
            gap: 8px;
        }

        .time-btn {
            background: #F3F4F6;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            color: #6B7280;
        }

        .time-btn.active,
        .time-btn:hover {
            background: linear-gradient(135deg, #007A3D, #005A2C);
            color: white;
        }

        .performance-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .stat-item {
            text-align: center;
            padding: 20px;
            background: #F9FAFB;
            border-radius: 12px;
        }

        .stat-label {
            font-size: 14px;
            color: #6B7280;
            margin-bottom: 8px;
        }

        .stat-item .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #1F2937;
            margin-bottom: 4px;
        }

        .stat-item .stat-value.positive {
            color: #10B981;
        }

        .stat-percentage {
            font-size: 14px;
            font-weight: 600;
            color: #6B7280;
        }

        .stat-percentage.positive {
            color: #10B981;
        }

        .portfolio-section {
            margin-bottom: 30px;
        }

        .portfolio-chart {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.08);
        }

        .chart-placeholder {
            display: flex;
            align-items: center;
            gap: 40px;
        }

        .chart-circle {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: conic-gradient(
                #007A3D 0deg 120deg,
                #005A2C 120deg 192deg,
                #10B981 192deg 210deg,
                #1F2937 210deg 232deg,
                #374151 232deg 360deg
            );
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .chart-inner {
            width: 120px;
            height: 120px;
            background: white;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .chart-percentage {
            font-size: 24px;
            font-weight: 800;
            color: #1F2937;
        }

        .chart-label {
            font-size: 12px;
            color: #6B7280;
            margin-top: 4px;
        }

        .chart-legend {
            flex: 1;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 4px;
        }

        .legend-item span {
            font-weight: 600;
            color: #1F2937;
        }

        .trends-section {
            margin-bottom: 30px;
        }

        .trends-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px;
        }

        .trend-card {
            background: white;
            padding: 20px;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.06);
            border: 1px solid #E5E7EB;
            transition: all 0.3s ease;
        }

        .trend-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 30px rgba(0,0,0,0.1);
        }

        .trend-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .trend-icon {
            font-size: 20px;
        }

        .trend-title {
            font-weight: 600;
            color: #1F2937;
        }

        .trend-price {
            font-size: 20px;
            font-weight: 700;
            color: #1F2937;
            margin-bottom: 4px;
        }

        .trend-change {
            font-size: 14px;
            font-weight: 600;
        }

        .trend-card.positive .trend-change {
            color: #10B981;
        }

        .trend-card.negative .trend-change {
            color: #EF4444;
        }

        /* Staking Page Styles */
        .staking-overview {
            margin-bottom: 30px;
        }

        .staking-card {
            background: linear-gradient(135deg, #10B981 0%, #059669 100%);
            color: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(16, 185, 129, 0.3);
        }

        .staking-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .staking-header h3 {
            font-size: 20px;
            font-weight: 700;
        }

        .staking-actions {
            display: flex;
            gap: 12px;
        }

        .staking-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 10px 16px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 14px;
        }

        .staking-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .staking-balance {
            text-align: center;
        }

        .balance-main {
            font-size: 36px;
            font-weight: 800;
            margin-bottom: 8px;
        }

        .balance-subtitle {
            font-size: 16px;
            opacity: 0.9;
            margin-bottom: 8px;
        }

        .balance-apy {
            font-size: 18px;
            font-weight: 600;
            opacity: 0.8;
        }

        .active-staking-section {
            margin-bottom: 30px;
        }

        .staking-list {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.06);
            overflow: hidden;
        }

        .staking-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid #F3F4F6;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .staking-item:last-child {
            border-bottom: none;
        }

        .staking-item:hover {
            background: #F9FAFB;
        }

        .staking-info {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .staking-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #10B981, #059669);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
            font-weight: bold;
        }

        .staking-details {
            display: flex;
            flex-direction: column;
        }

        .staking-name {
            font-weight: 600;
            color: #1F2937;
            margin-bottom: 4px;
        }

        .staking-amount {
            font-size: 14px;
            color: #6B7280;
        }

        .staking-rewards {
            text-align: right;
        }

        .reward-amount {
            font-weight: 700;
            color: #10B981;
            font-size: 18px;
            margin-bottom: 4px;
        }

        .reward-apy {
            font-size: 14px;
            color: #6B7280;
            font-weight: 600;
        }

        .opportunities-section {
            margin-bottom: 30px;
        }

        .opportunities-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .opportunity-card {
            background: white;
            padding: 24px;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.06);
            border: 1px solid #E5E7EB;
            transition: all 0.3s ease;
        }

        .opportunity-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 30px rgba(0,0,0,0.1);
        }

        .opportunity-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 20px;
        }

        .opportunity-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #1F2937, #374151);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
            font-weight: bold;
        }

        .opportunity-info {
            flex: 1;
        }

        .opportunity-name {
            font-weight: 600;
            color: #1F2937;
            margin-bottom: 4px;
        }

        .opportunity-apy {
            font-size: 14px;
            color: #10B981;
            font-weight: 600;
        }

        .opportunity-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .opportunity-status.available {
            background: #D1FAE5;
            color: #065F46;
        }

        .opportunity-details {
            margin-bottom: 20px;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #F3F4F6;
        }

        .detail-item:last-child {
            border-bottom: none;
        }

        .detail-item span:first-child {
            color: #6B7280;
            font-size: 14px;
        }

        .detail-item span:last-child {
            font-weight: 600;
            color: #1F2937;
        }

        .risk-low {
            color: #10B981 !important;
        }

        .risk-medium {
            color: #1F2937 !important;
        }

        .risk-high {
            color: #EF4444 !important;
        }

        .opportunity-btn {
            width: 100%;
            background: linear-gradient(135deg, #10B981, #059669);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 14px;
        }

        .opportunity-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.3);
        }

        /* Optimisations Mobile et iPhone */
        @media (max-width: 768px) {
            body {
                -webkit-overflow-scrolling: touch;
            }
            
            .dashboard-container {
                flex-direction: column;
            }
            
            .main-content {
                padding: 20px 15px;
                padding-bottom: 100px;
            }
            
            .bottom-nav {
                padding: 6px 0;
            }
            
            .nav-item {
                padding: 6px 8px;
                min-width: 50px;
            }
            
            .nav-icon {
                font-size: 20px;
            }
            
            .nav-label {
                font-size: 9px;
            }
            
            .page-header {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
                margin-bottom: 25px;
                padding-bottom: 15px;
            }
            
            .page-title {
                font-size: 24px;
            }
            
            .header-actions {
                width: 100%;
                gap: 10px;
            }
            
            .btn {
                flex: 1;
                padding: 12px 16px;
                font-size: 14px;
                border-radius: 10px;
                min-height: 44px;
            }
            
            .welcome-section {
                padding: 25px 20px;
                border-radius: 15px;
                margin-bottom: 25px;
                text-align: center;
            }
            
            .welcome-title {
                font-size: 24px;
                margin-bottom: 8px;
            }
            
            .welcome-subtitle {
                font-size: 16px;
                margin-bottom: 20px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
                gap: 15px;
                margin-bottom: 25px;
            }
            
            .stat-card {
                padding: 20px;
                border-radius: 12px;
            }
            
            .stat-value {
                font-size: 24px;
            }
            
            .stat-change {
                font-size: 13px;
            }
            
            .stat-card p {
                font-size: 13px;
                margin-top: 8px;
            }
        }
        
        @media (max-width: 480px) {
            .main-content {
                padding: 15px 10px;
                padding-bottom: 90px;
            }
            
            .nav-item {
                padding: 4px 6px;
                min-width: 45px;
            }
            
            .nav-icon {
                font-size: 18px;
            }
            
            .nav-label {
                font-size: 8px;
            }
            
            .page-title {
                font-size: 22px;
            }
            
            .welcome-section {
                padding: 20px 15px;
            }
            
            .welcome-title {
                font-size: 22px;
            }
            
            .welcome-subtitle {
                font-size: 15px;
            }
            
            .stat-card {
                padding: 18px;
            }
            
            .stat-value {
                font-size: 22px;
            }
        }
        
        /* Crypto Detail Page */
        .crypto-detail-page {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: white;
            z-index: 2000;
            overflow-y: auto;
        }

        .crypto-detail-header {
            background: linear-gradient(135deg, #007A3D 0%, #005A2D 100%);
            color: white;
            padding: 20px;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .crypto-detail-back {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
            cursor: pointer;
            font-weight: 600;
        }

        .crypto-detail-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .crypto-detail-price {
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 8px;
            display: none; /* Masquer le prix */
        }

        .crypto-detail-change {
            font-size: 16px;
            padding: 4px 12px;
            border-radius: 20px;
            display: inline-block;
        }

        .crypto-detail-change.positive {
            background: rgba(16, 185, 129, 0.2);
            color: #10B981;
        }

        .crypto-detail-change.negative {
            background: rgba(239, 68, 68, 0.2);
            color: #EF4444;
        }

        .crypto-detail-content {
            padding: 20px;
        }

        .crypto-chart-container {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        .crypto-chart-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
            color: #1F2937;
        }

                 .crypto-chart {
             height: 400px;
             background: transparent;
             display: flex;
             flex-direction: column;
             padding: 0;
             color: white;
         }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .chart-timeframe {
            display: flex;
            gap: 8px;
        }

                 .timeframe-btn {
             background: rgba(255, 255, 255, 0.08);
             border: 1px solid rgba(255, 255, 255, 0.1);
             padding: 8px 16px;
             border-radius: 8px;
             color: #9CA3AF;
             font-size: 13px;
             font-weight: 600;
             cursor: pointer;
             transition: all 0.3s ease;
             backdrop-filter: blur(10px);
         }

         .timeframe-btn.active {
             background: linear-gradient(135deg, #007A3D 0%, #005A2D 100%);
             color: white;
             border-color: #007A3D;
             box-shadow: 0 4px 12px rgba(0, 122, 61, 0.3);
         }

         .timeframe-btn:hover {
             background: rgba(0, 122, 61, 0.2);
             color: white;
             transform: translateY(-1px);
             box-shadow: 0 4px 12px rgba(0, 122, 61, 0.2);
         }

                 .chart-live-indicator {
             display: flex;
             align-items: center;
             gap: 8px;
             padding: 8px 12px;
             background: linear-gradient(135deg, rgba(16, 185, 129, 0.15) 0%, rgba(16, 185, 129, 0.05) 100%);
             border-radius: 10px;
             border: 1px solid rgba(16, 185, 129, 0.3);
             backdrop-filter: blur(10px);
             box-shadow: 0 2px 8px rgba(16, 185, 129, 0.2);
         }

                 .live-dot {
             width: 8px;
             height: 8px;
             background: linear-gradient(135deg, #10B981 0%, #059669 100%);
             border-radius: 50%;
             animation: pulse 1.5s infinite;
             box-shadow: 0 0 8px rgba(16, 185, 129, 0.5);
         }

                 .live-text {
             font-size: 12px;
             font-weight: 700;
             color: #10B981;
             text-shadow: 0 0 8px rgba(16, 185, 129, 0.3);
         }

         .last-update {
             font-size: 10px;
             color: #6B7280;
             margin-left: 8px;
         }

         .test-chart-btn {
             background: #007A3D;
             color: white;
             border: none;
             padding: 6px 12px;
             border-radius: 6px;
             font-size: 11px;
             font-weight: 600;
             cursor: pointer;
             margin-left: 8px;
         }

         .test-chart-btn:hover {
             background: #005A2D;
         }

         /* Styles pour la modal de d√©p√¥t */
         .deposit-modal {
             position: fixed;
             top: 0;
             left: 0;
             width: 100%;
             height: 100%;
             background: rgba(0, 0, 0, 0.8);
             display: flex;
             align-items: center;
             justify-content: center;
             z-index: 10000;
             opacity: 0;
             transition: opacity 0.3s ease;
         }

         .deposit-modal-content {
             background: white;
             border-radius: 16px;
             max-width: 500px;
             width: 90%;
             max-height: 90vh;
             overflow-y: auto;
             transform: translateY(-20px);
             transition: transform 0.3s ease;
             box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
         }

         .deposit-modal-header {
             display: flex;
             justify-content: space-between;
             align-items: center;
             padding: 20px 24px;
             border-bottom: 1px solid #E5E7EB;
         }

         .deposit-modal-header h3 {
             margin: 0;
             font-size: 20px;
             font-weight: 700;
             color: #1F2937;
         }

         .close-btn {
             background: none;
             border: none;
             padding: 8px;
             border-radius: 8px;
             cursor: pointer;
             color: #6B7280;
             transition: all 0.3s ease;
         }

         .close-btn:hover {
             background: #F3F4F6;
             color: #1F2937;
         }

         .deposit-modal-body {
             padding: 24px;
         }

         .qr-code-container {
             text-align: center;
             margin-bottom: 24px;
             padding: 20px;
             background: #F9FAFB;
             border-radius: 12px;
         }

         .qr-note {
             margin-top: 12px;
             font-size: 14px;
             color: #6B7280;
             font-weight: 500;
         }

         .wallet-address-container {
             margin-bottom: 24px;
         }

         .wallet-address-container label {
             display: block;
             margin-bottom: 8px;
             font-size: 14px;
             font-weight: 600;
             color: #374151;
         }

         .address-input-group {
             display: flex;
             gap: 8px;
             align-items: center;
         }

         .address-input-group input {
             flex: 1;
             padding: 12px 16px;
             border: 2px solid #E5E7EB;
             border-radius: 8px;
             font-size: 14px;
             font-family: 'Courier New', monospace;
             background: #F9FAFB;
             color: #1F2937;
             cursor: text;
         }

         .address-input-group input:focus {
             outline: none;
             border-color: #007A3D;
             background: white;
         }

         .copy-btn, .share-btn {
             padding: 12px 16px;
             border: none;
             border-radius: 8px;
             font-size: 14px;
             font-weight: 600;
             cursor: pointer;
             display: flex;
             align-items: center;
             gap: 6px;
             transition: all 0.3s ease;
             white-space: nowrap;
         }

         .copy-btn {
             background: #007A3D;
             color: white;
         }

         .copy-btn:hover {
             background: #005A2D;
             transform: translateY(-1px);
         }

         .share-btn {
             background: #3B82F6;
             color: white;
         }

         .share-btn:hover {
             background: #2563EB;
             transform: translateY(-1px);
         }

         .deposit-warning {
             display: flex;
             gap: 12px;
             padding: 16px;
             background: #FEF3C7;
             border: 1px solid #F59E0B;
             border-radius: 8px;
             margin-top: 16px;
         }

         .warning-icon {
             font-size: 20px;
             flex-shrink: 0;
         }

         .warning-text {
             font-size: 14px;
             color: #92400E;
             line-height: 1.5;
         }

         /* Styles pour la modal de retrait */
         .withdraw-modal {
             position: fixed;
             top: 0;
             left: 0;
             width: 100%;
             height: 100%;
             background: rgba(0, 0, 0, 0.8);
             display: flex;
             align-items: center;
             justify-content: center;
             z-index: 10000;
             opacity: 0;
             transition: opacity 0.3s ease;
         }

         .withdraw-modal-content {
             background: white;
             border-radius: 16px;
             max-width: 500px;
             width: 90%;
             max-height: 90vh;
             overflow-y: auto;
             transform: translateY(-20px);
             transition: transform 0.3s ease;
             box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
         }

         .withdraw-modal-header {
             display: flex;
             justify-content: space-between;
             align-items: center;
             padding: 20px 24px;
             border-bottom: 1px solid #E5E7EB;
         }

         .withdraw-modal-header h3 {
             margin: 0;
             font-size: 20px;
             font-weight: 700;
             color: #1F2937;
         }

         .close-btn {
             background: none;
             border: none;
             padding: 8px;
             border-radius: 8px;
             cursor: pointer;
             color: #6B7280;
             transition: all 0.3s ease;
         }

         .close-btn:hover {
             background: #F3F4F6;
             color: #1F2937;
         }

         .withdraw-modal-body {
             padding: 24px;
         }

         .withdraw-form .form-group {
             margin-bottom: 20px;
         }

         .withdraw-form label {
             display: block;
             margin-bottom: 8px;
             font-size: 14px;
             font-weight: 600;
             color: #374151;
         }

         .crypto-selector {
             display: flex;
             align-items: center;
             gap: 12px;
             padding: 12px 16px;
             background: #F9FAFB;
             border: 2px solid #E5E7EB;
             border-radius: 8px;
             cursor: pointer;
             transition: all 0.3s ease;
         }

         .crypto-selector:hover {
             border-color: #007A3D;
             background: #F0FDF4;
         }

         .crypto-icon {
             width: 32px;
             height: 32px;
             border-radius: 50%;
         }

         .crypto-name {
             flex: 1;
             font-weight: 600;
             color: #1F2937;
         }

         .crypto-symbol {
             font-size: 20px;
             font-weight: 700;
             color: #1F2937;
             background: #F3F4F6;
             padding: 8px 16px;
             border-radius: 8px;
             border: 2px solid #E5E7EB;
         }

         .balance-display {
             display: flex;
             justify-content: space-between;
             align-items: center;
             padding: 12px 16px;
             background: #F0FDF4;
             border: 2px solid #10B981;
             border-radius: 8px;
         }

         .balance-amount {
             font-size: 16px;
             font-weight: 700;
             color: #10B981;
         }

         .balance-value {
             font-size: 14px;
             color: #6B7280;
         }

         .withdraw-input {
             width: 100%;
             padding: 12px 16px;
             border: 2px solid #E5E7EB;
             border-radius: 8px;
             font-size: 14px;
             transition: border-color 0.3s ease;
         }

         .withdraw-input:focus {
             outline: none;
             border-color: #007A3D;
         }

         .withdraw-input.error {
             border-color: #EF4444;
             background: #FEF2F2;
         }

         .error-message {
             color: #EF4444;
             font-size: 12px;
             margin-top: 4px;
             font-weight: 500;
         }

         .amount-input-group {
             display: flex;
             align-items: center;
             gap: 8px;
             background: white;
             border: 2px solid #E5E7EB;
             border-radius: 8px;
             padding: 4px;
         }

         .amount-input-group:focus-within {
             border-color: #007A3D;
         }

         .amount-input-group.error {
             border-color: #EF4444;
             background: #FEF2F2;
         }

         .amount-input-group input {
             flex: 1;
             border: none;
             padding: 12px 16px;
             font-size: 16px;
             font-weight: 600;
             color: #1F2937;
             background: transparent;
         }

         .amount-input-group input:focus {
             outline: none;
         }

         .amount-options {
             display: flex;
             gap: 8px;
             margin-top: 8px;
         }

         .amount-btn {
             padding: 8px 12px;
             border: 1px solid #E5E7EB;
             border-radius: 6px;
             background: white;
             color: #374151;
             font-size: 12px;
             font-weight: 600;
             cursor: pointer;
             transition: all 0.3s ease;
         }

         .amount-btn:hover {
             background: #F3F4F6;
             border-color: #007A3D;
         }

         .amount-value {
             margin-top: 8px;
             font-size: 14px;
             color: #6B7280;
             text-align: right;
         }

         .withdraw-fees {
             background: #F9FAFB;
             border-radius: 8px;
             padding: 16px;
             margin: 20px 0;
         }

         .fee-item {
             display: flex;
             justify-content: space-between;
             align-items: center;
             margin-bottom: 8px;
             font-size: 14px;
         }

         .fee-item:last-child {
             margin-bottom: 0;
             padding-top: 8px;
             border-top: 1px solid #E5E7EB;
             font-weight: 600;
         }

         .fee-item span:first-child {
             color: #6B7280;
         }

         .fee-amount {
             color: #EF4444;
             font-weight: 600;
         }

         .received-amount {
             color: #10B981;
             font-weight: 600;
         }

         .withdraw-warning {
             display: flex;
             gap: 12px;
             padding: 16px;
             background: #FEF3C7;
             border: 1px solid #F59E0B;
             border-radius: 8px;
             margin: 20px 0;
         }

         .warning-icon {
             font-size: 20px;
             flex-shrink: 0;
         }

         .warning-text {
             font-size: 14px;
             color: #92400E;
             line-height: 1.5;
         }

         .withdraw-btn {
             width: 100%;
             padding: 16px;
             background: #E5E7EB;
             color: #9CA3AF;
             border: none;
             border-radius: 12px;
             font-size: 16px;
             font-weight: 700;
             cursor: not-allowed;
             display: flex;
             align-items: center;
             justify-content: center;
             gap: 8px;
             transition: all 0.3s ease;
         }

         .withdraw-btn:not(:disabled) {
             background: #007A3D;
             color: white;
             cursor: pointer;
         }

         .withdraw-btn:not(:disabled):hover {
             background: #005A2D;
             transform: translateY(-1px);
         }

         /* Responsive pour mobile */
         @media (max-width: 768px) {
             .deposit-modal-content {
                 width: 95%;
                 margin: 20px;
             }

             .address-input-group {
                 flex-direction: column;
                 gap: 12px;
             }

             .copy-btn, .share-btn {
                 width: 100%;
                 justify-content: center;
             }
         }

                 .chart-container {
             position: relative;
             flex: 1;
             background: transparent;
             overflow: hidden;
         }

        .chart-overlay {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 10;
        }

                 .price-indicator {
             background: rgba(0, 0, 0, 0.8);
             padding: 8px 12px;
             border-radius: 6px;
             display: flex;
             flex-direction: column;
             align-items: flex-end;
             gap: 2px;
         }

         .current-price {
             font-size: 16px;
             font-weight: 800;
             color: white;
             text-shadow: 0 0 8px rgba(255, 255, 255, 0.3);
         }

         .price-change {
             font-size: 12px;
             font-weight: 700;
             color: #10B981;
             text-shadow: 0 0 6px rgba(16, 185, 129, 0.4);
         }

         .price-change.negative {
             color: #EF4444;
             text-shadow: 0 0 6px rgba(239, 68, 68, 0.4);
         }

         .chart-loading {
             position: absolute;
             top: 50%;
             left: 50%;
             transform: translate(-50%, -50%);
             display: flex;
             flex-direction: column;
             align-items: center;
             gap: 16px;
             color: #9CA3AF;
             z-index: 5;
         }

         .loading-spinner {
             width: 32px;
             height: 32px;
             border: 3px solid rgba(255, 255, 255, 0.1);
             border-top: 3px solid #007A3D;
             border-radius: 50%;
             animation: spin 1s linear infinite;
             box-shadow: 0 0 16px rgba(0, 122, 61, 0.3);
         }

         @keyframes spin {
             0% { transform: rotate(0deg); }
             100% { transform: rotate(360deg); }
         }

         @keyframes fadeInUp {
             from {
                 opacity: 0;
                 transform: translateY(20px);
             }
             to {
                 opacity: 1;
                 transform: translateY(0);
             }
         }

         .chart-container {
             animation: fadeInUp 0.8s ease-out;
         }

        .crypto-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 16px;
            margin-bottom: 20px;
        }

        .crypto-stat-card {
            background: white;
            border-radius: 12px;
            padding: 16px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.06);
            text-align: center;
        }

        .crypto-stat-label {
            font-size: 12px;
            color: #6B7280;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .crypto-stat-value {
            font-size: 18px;
            font-weight: 700;
            color: #1F2937;
        }

        .crypto-actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }

        .crypto-action-btn {
            background: linear-gradient(135deg, #007A3D 0%, #005A2D 100%);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 16px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .crypto-action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 122, 61, 0.3);
        }

        .crypto-action-btn.secondary {
            background: white;
            color: #007A3D;
            border: 2px solid #007A3D;
        }

        .crypto-action-btn.secondary:hover {
            background: #007A3D;
            color: white;
        }

        /* Optimisations sp√©cifiques iPhone */
        @supports (-webkit-touch-callout: none) {
            .btn {
                -webkit-appearance: none;
                border-radius: 10px;
            }
            
            .nav-item {
                -webkit-appearance: none;
                border-radius: 10px;
            }
        }
        
        /* Am√©lioration de l'accessibilit√© tactile */
        @media (hover: none) and (pointer: coarse) {
            .nav-item {
                min-height: 44px;
            }
            
            .btn {
                min-height: 44px;
            }
            
            .stat-card {
                min-height: 44px;
            }
        }
        
        /* Mode paysage sur mobile */
        @media (max-width: 768px) and (orientation: landscape) {
            .main-content {
                padding: 15px;
                padding-bottom: 80px;
            }
            
            .bottom-nav {
                padding: 4px 0;
            }
            
            .nav-item {
                padding: 4px 6px;
            }
        }


        /* Contact Support Page Styles */
        .contact-support-page {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: white;
            z-index: 15000;
            overflow-y: auto;
        }

        .contact-support-header {
            background: linear-gradient(135deg, #007A3D 0%, #005A2D 100%);
            color: white;
            padding: 20px;
            position: sticky;
            top: 0;
            z-index: 15001;
        }

        .contact-support-back {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
            cursor: pointer;
            font-weight: 600;
        }

        .contact-support-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .contact-support-subtitle {
            font-size: 16px;
            opacity: 0.9;
        }

        .contact-support-content {
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
        }

        .support-info-card {
            background: white;
            border: 2px solid #E5E7EB;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }

        .support-info-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }

        .support-info-title {
            font-size: 20px;
            font-weight: 700;
            color: #1F2937;
            margin-bottom: 12px;
        }

        .support-info-email {
            font-size: 18px;
            font-weight: 600;
            color: #007A3D;
            margin-bottom: 20px;
            word-break: break-all;
        }

        .copy-email-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            background: #007A3D;
            color: white;
            border: none;
            border-radius: 12px;
            padding: 12px 24px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 0 auto;
        }

        .copy-email-btn:hover {
            background: #005A2D;
            transform: translateY(-2px);
        }

        .support-details {
            background: white;
            border: 2px solid #E5E7EB;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 30px;
        }

        .support-detail-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 16px 0;
            border-bottom: 1px solid #F3F4F6;
        }

        .support-detail-item:last-child {
            border-bottom: none;
        }

        .support-detail-icon {
            font-size: 24px;
            width: 40px;
            text-align: center;
        }

        .support-detail-text {
            flex: 1;
        }

        .support-detail-title {
            font-size: 16px;
            font-weight: 600;
            color: #1F2937;
            margin-bottom: 4px;
        }

        .support-detail-desc {
            font-size: 14px;
            color: #6B7280;
        }

        .support-actions {
            text-align: center;
        }

        .support-action-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            background: #007A3D;
            color: white;
            border: none;
            border-radius: 12px;
            padding: 16px 32px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 0 auto;
        }

        .support-action-btn:hover {
            background: #005A2D;
            transform: translateY(-2px);
        }

        /* About Us Page Styles */
        .about-us-page {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: white;
            z-index: 15000;
            overflow-y: auto;
        }

        .about-us-header {
            background: linear-gradient(135deg, #007A3D 0%, #005A2D 100%);
            color: white;
            padding: 20px;
            position: sticky;
            top: 0;
            z-index: 15001;
        }

        .about-us-back {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
            cursor: pointer;
            font-weight: 600;
        }

        .about-us-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .about-us-subtitle {
            font-size: 16px;
            opacity: 0.9;
        }

        .about-us-content {
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
        }

        .about-us-logo {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px 0;
        }

        .logo-icon {
            font-size: 64px;
            margin-bottom: 16px;
        }

        .logo-text {
            font-size: 28px;
            font-weight: 700;
            color: #007A3D;
        }

        .about-us-section {
            background: white;
            border: 2px solid #E5E7EB;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }

        .about-us-section h3 {
            font-size: 20px;
            font-weight: 700;
            color: #1F2937;
            margin-bottom: 16px;
        }

        .about-us-section p {
            font-size: 16px;
            line-height: 1.6;
            color: #6B7280;
        }

        .values-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
        }

        .value-item {
            text-align: center;
            padding: 16px;
            background: #F9FAFB;
            border-radius: 12px;
        }

        .value-icon {
            font-size: 32px;
            margin-bottom: 8px;
        }

        .value-title {
            font-size: 16px;
            font-weight: 600;
            color: #1F2937;
            margin-bottom: 4px;
        }

        .value-desc {
            font-size: 14px;
            color: #6B7280;
        }

        .services-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .service-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: #F9FAFB;
            border-radius: 8px;
        }

        .service-icon {
            font-size: 24px;
            width: 40px;
            text-align: center;
        }

        .service-text {
            font-size: 16px;
            color: #1F2937;
        }

        .about-us-footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            border-top: 1px solid #E5E7EB;
        }

        .version-info {
            font-size: 14px;
            color: #6B7280;
            margin-bottom: 8px;
        }

        .version-info span {
            margin: 0 8px;
        }

        .copyright {
            font-size: 14px;
            color: #9CA3AF;
        }

        /* Backup Phrase Page Styles */
        .backup-phrase-page {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: white;
            z-index: 15000;
            overflow-y: auto;
        }

        .backup-phrase-header {
            background: linear-gradient(135deg, #007A3D 0%, #005A2D 100%);
            color: white;
            padding: 20px;
            position: sticky;
            top: 0;
            z-index: 15001;
        }

        .backup-phrase-back {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
            cursor: pointer;
            font-weight: 600;
        }

        .backup-phrase-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .backup-phrase-subtitle {
            font-size: 16px;
            opacity: 0.9;
        }

        .backup-phrase-content {
            padding: 20px;
        }

        .backup-step {
            max-width: 600px;
            margin: 0 auto;
        }

        .backup-warning {
            background: #FEF3C7;
            border: 2px solid #F59E0B;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .warning-icon {
            font-size: 24px;
            margin-bottom: 12px;
        }

        .warning-content h3 {
            color: #92400E;
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 12px;
        }

        .warning-content p {
            color: #92400E;
            font-size: 14px;
            line-height: 1.5;
            margin-bottom: 12px;
        }

        .warning-content ul {
            color: #92400E;
            font-size: 14px;
            line-height: 1.6;
            padding-left: 20px;
        }

        .warning-content li {
            margin-bottom: 6px;
        }

        .backup-words-container {
            background: white;
            border: 2px solid #E5E7EB;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 30px;
        }

        .backup-words-title {
            font-size: 18px;
            font-weight: 700;
            color: #1F2937;
            margin-bottom: 20px;
            text-align: center;
        }

        .backup-words-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
        }

        .backup-word {
            background: #F9FAFB;
            border: 2px solid #E5E7EB;
            border-radius: 8px;
            padding: 12px 8px;
            text-align: center;
            font-weight: 600;
            color: #1F2937;
            font-size: 14px;
            position: relative;
            transition: all 0.3s ease;
        }

        .backup-word:hover {
            border-color: #007A3D;
            background: #F0FDF4;
        }

        .word-number {
            position: absolute;
            top: -8px;
            left: -8px;
            background: #007A3D;
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            font-size: 10px;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .backup-actions {
            display: flex;
            gap: 12px;
            justify-content: center;
        }

        .backup-btn {
            padding: 16px 24px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .backup-btn.primary {
            background: linear-gradient(135deg, #007A3D, #005A2D);
            color: white;
        }

        .backup-btn.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 122, 61, 0.3);
        }

        .backup-btn.secondary {
            background: white;
            color: #007A3D;
            border: 2px solid #007A3D;
        }

        .backup-btn.secondary:hover {
            background: #007A3D;
            color: white;
        }

        /* Verification Styles */
        .verification-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .verification-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }

        .verification-title {
            font-size: 24px;
            font-weight: 700;
            color: #1F2937;
            margin-bottom: 8px;
        }

        .verification-subtitle {
            font-size: 16px;
            color: #6B7280;
            line-height: 1.5;
        }

        .verification-progress {
            margin-bottom: 30px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #E5E7EB;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 12px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #007A3D, #10B981);
            border-radius: 4px;
            transition: width 0.3s ease;
            width: 0%;
        }

        .progress-text {
            text-align: center;
            font-size: 14px;
            color: #6B7280;
            font-weight: 600;
        }

        .verification-container {
            background: white;
            border: 2px solid #E5E7EB;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 30px;
        }

        .word-to-verify {
            text-align: center;
            font-size: 18px;
            font-weight: 700;
            color: #1F2937;
            margin-bottom: 24px;
            padding: 16px;
            background: #F9FAFB;
            border-radius: 8px;
        }

        .word-options-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
        }

        .word-option {
            background: white;
            border: 2px solid #E5E7EB;
            border-radius: 8px;
            padding: 16px 12px;
            text-align: center;
            font-weight: 600;
            color: #1F2937;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .word-option:hover {
            border-color: #007A3D;
            background: #F0FDF4;
        }

        .word-option.selected {
            background: #007A3D;
            color: white;
            border-color: #007A3D;
        }

        .word-option.correct {
            background: #10B981;
            color: white;
            border-color: #10B981;
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .word-option.incorrect {
            background: #EF4444;
            color: white;
            border-color: #EF4444;
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
        }

        /* Styles pour les sections de v√©rification */
        .verification-section {
            background: white;
            border: 2px solid #E5E7EB;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
            transition: all 0.3s ease;
        }

        .verification-section.completed {
            border-color: #10B981;
            background: #F0FDF4;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
        }

        .section-number {
            background: #007A3D;
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 16px;
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: #1F2937;
        }

        .word-instruction {
            font-size: 16px;
            color: #6B7280;
            margin-bottom: 16px;
            text-align: center;
        }

        .word-position {
            font-weight: 700;
            color: #007A3D;
        }

        .section-status {
            text-align: center;
            margin-top: 16px;
            font-size: 14px;
            font-weight: 600;
        }

        .section-status.pending {
            color: #6B7280;
        }

        .section-status.correct {
            color: #10B981;
        }

        .section-status.incorrect {
            color: #EF4444;
        }

        /* Styles pour la confirmation finale */
        .final-confirmation-container {
            background: white;
            border: 2px solid #E5E7EB;
            border-radius: 16px;
            padding: 40px 24px;
            text-align: center;
        }

        .final-confirmation-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }

        .final-confirmation-title {
            font-size: 28px;
            font-weight: 700;
            color: #1F2937;
            margin-bottom: 16px;
        }

        .final-confirmation-message {
            font-size: 16px;
            color: #6B7280;
            line-height: 1.6;
            margin-bottom: 30px;
        }

        .final-confirmation-warning {
            background: #FEF3C7;
            border: 2px solid #F59E0B;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
            text-align: left;
        }

        .final-confirmation-actions {
            display: flex;
            gap: 12px;
            justify-content: center;
        }

        .final-confirmation-btn {
            padding: 16px 24px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .final-confirmation-btn.primary {
            background: linear-gradient(135deg, #007A3D, #005A2D);
            color: white;
        }

        .final-confirmation-btn.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 122, 61, 0.3);
        }

        .final-confirmation-btn.secondary {
            background: white;
            color: #6B7280;
            border: 2px solid #E5E7EB;
        }

        .final-confirmation-btn.secondary:hover {
            background: #F3F4F6;
            border-color: #D1D5DB;
        }



        .verification-actions {
            display: flex;
            gap: 12px;
            justify-content: center;
        }

        .verification-btn {
            padding: 16px 24px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .verification-btn.primary {
            background: linear-gradient(135deg, #007A3D, #005A2D);
            color: white;
        }

        .verification-btn.primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 122, 61, 0.3);
        }

        .verification-btn.primary:disabled {
            background: #E5E7EB;
            color: #9CA3AF;
            cursor: not-allowed;
            pointer-events: none;
        }

        .verification-btn.secondary {
            background: white;
            color: #6B7280;
            border: 2px solid #E5E7EB;
        }

        .verification-btn.secondary:hover {
            background: #F3F4F6;
            border-color: #D1D5DB;
        }

        /* Confirmation Styles */
        .confirmation-container {
            text-align: center;
            background: white;
            border: 2px solid #E5E7EB;
            border-radius: 16px;
            padding: 40px 24px;
            margin-bottom: 30px;
        }

        .confirmation-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }

        .confirmation-title {
            font-size: 28px;
            font-weight: 700;
            color: #1F2937;
            margin-bottom: 16px;
        }

        .confirmation-message {
            font-size: 16px;
            color: #6B7280;
            line-height: 1.6;
            margin-bottom: 30px;
        }

        .confirmation-message p {
            margin-bottom: 12px;
        }

        .security-tips {
            text-align: left;
            background: #F9FAFB;
            border-radius: 12px;
            padding: 20px;
            border-left: 4px solid #007A3D;
        }

        .security-tips h4 {
            color: #1F2937;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 12px;
        }

        .security-tips ul {
            color: #6B7280;
            font-size: 14px;
            line-height: 1.6;
            padding-left: 20px;
        }

        .security-tips li {
            margin-bottom: 8px;
        }

        .confirmation-actions {
            display: flex;
            justify-content: center;
        }

        .confirmation-btn {
            padding: 16px 32px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .confirmation-btn.primary {
            background: linear-gradient(135deg, #007A3D, #005A2D);
            color: white;
        }

        .confirmation-btn.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 122, 61, 0.3);
        }

        /* Responsive pour mobile */
        @media (max-width: 768px) {
            .backup-words-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .word-options-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .backup-actions,
            .verification-actions {
                flex-direction: column;
            }

            .backup-btn,
            .verification-btn {
                width: 100%;
                justify-content: center;
            }
        }

        /* Styles pour la modal d'√©change */
        .exchange-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .exchange-modal-content {
            background: white;
            border-radius: 16px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            transform: translateY(-20px);
            transition: transform 0.3s ease;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .exchange-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 24px;
            border-bottom: 1px solid #E5E7EB;
        }

        .exchange-modal-header h3 {
            margin: 0;
            font-size: 20px;
            font-weight: 700;
            color: #1F2937;
        }

        .exchange-modal-body {
            padding: 24px;
        }

        .exchange-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .exchange-section {
            background: #F9FAFB;
            border-radius: 12px;
            padding: 20px;
            border: 2px solid #E5E7EB;
        }

        .exchange-section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .exchange-section-header h4 {
            margin: 0;
            font-size: 16px;
            font-weight: 600;
            color: #1F2937;
        }

        .balance-info {
            font-size: 14px;
            color: #6B7280;
        }

        .balance-amount {
            font-weight: 600;
            color: #007A3D;
        }

        .selected-crypto {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .dropdown-arrow {
            color: #6B7280;
            transition: transform 0.3s ease;
        }

        .crypto-selector:hover .dropdown-arrow {
            transform: rotate(180deg);
        }

        .amount-input-group {
            display: flex;
            gap: 8px;
            margin-top: 12px;
        }

        .amount-input-group input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid #E5E7EB;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            background: white;
            transition: all 0.3s ease;
        }

        .amount-input-group input:focus {
            outline: none;
            border-color: #007A3D;
            box-shadow: 0 0 0 3px rgba(0, 122, 61, 0.1);
        }

        .max-btn {
            padding: 12px 16px;
            background: #007A3D;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .max-btn:hover {
            background: #005A2E;
            transform: translateY(-1px);
        }

        .amount-value {
            margin-top: 8px;
            text-align: right;
            font-size: 14px;
            color: #6B7280;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 6px;
        }

        .value-icon {
            font-size: 16px;
        }

        .exchange-arrow {
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
        }

        .exchange-arrow-line {
            position: absolute;
            width: 2px;
            height: 40px;
            background: linear-gradient(to bottom, #007A3D, #10B981);
            border-radius: 1px;
        }

        .exchange-arrow-head {
            position: absolute;
            bottom: -5px;
            width: 0;
            height: 0;
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-top: 8px solid #10B981;
        }

        .exchange-swap-btn {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 40px;
            height: 40px;
            background: #007A3D;
            color: white;
            border: 3px solid white;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 1;
            box-shadow: 0 2px 8px rgba(0, 122, 61, 0.3);
        }

        .exchange-swap-btn:hover {
            background: #005A2E;
            transform: scale(1.1);
        }

        .exchange-info {
            background: #F9FAFB;
            border-radius: 12px;
            padding: 16px;
            margin-top: 20px;
        }

        .exchange-summary {
            background: #F0FDF4;
            border: 1px solid #BBF7D0;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 16px;
        }

        .exchange-equivalence {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .equivalence-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
        }

        .equivalence-label {
            font-size: 14px;
            font-weight: 600;
            color: #166534;
        }

        .equivalence-value {
            font-size: 16px;
            font-weight: 700;
            color: #166534;
        }

        .exchange-details {
            border-top: 1px solid #E5E7EB;
            padding-top: 16px;
        }

        .exchange-rate,
        .exchange-fees,
        .exchange-slippage,
        .exchange-net {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .exchange-rate:last-child,
        .exchange-fees:last-child,
        .exchange-slippage:last-child,
        .exchange-net:last-child {
            margin-bottom: 0;
        }

        .exchange-rate span:first-child,
        .exchange-fees span:first-child,
        .exchange-slippage span:first-child,
        .exchange-net span:first-child {
            color: #6B7280;
        }

        .exchange-rate span:last-child,
        .exchange-fees span:last-child,
        .exchange-slippage span:last-child,
        .exchange-net span:last-child {
            font-weight: 600;
            color: #1F2937;
        }

        .exchange-btn {
            width: 100%;
            padding: 16px;
            background: #E5E7EB;
            color: #9CA3AF;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: not-allowed;
            transition: all 0.3s ease;
            margin-top: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .exchange-btn.active {
            background: #007A3D;
            color: white;
            cursor: pointer;
        }

        .exchange-btn.active:hover {
            background: #005A2E;
            transform: translateY(-1px);
        }

        .exchange-actions {
            display: flex;
            gap: 8px;
            margin-top: 20px;
        }

        .debug-prices-btn {
            padding: 16px 12px;
            background: #FEF3C7;
            color: #92400E;
            border: 2px solid #F59E0B;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            flex: 0.5;
        }

        .debug-prices-btn:hover {
            background: #FDE68A;
            border-color: #D97706;
            transform: translateY(-1px);
        }

        .refresh-prices-btn {
            padding: 16px 20px;
            background: #F3F4F6;
            color: #374151;
            border: 2px solid #E5E7EB;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            flex: 1.5;
        }

        .refresh-prices-btn:hover {
            background: #E5E7EB;
            border-color: #D1D5DB;
            transform: translateY(-1px);
        }

        .exchange-btn {
            flex: 2;
        }

        /* Styles pour le s√©lecteur de cryptomonnaies */
        .crypto-selector-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10001;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .crypto-selector-content {
            background: white;
            border-radius: 16px;
            max-width: 400px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            transform: translateY(-20px);
            transition: transform 0.3s ease;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .crypto-selector-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 24px;
            border-bottom: 1px solid #E5E7EB;
        }

        .crypto-selector-header h4 {
            margin: 0;
            font-size: 18px;
            font-weight: 700;
            color: #1F2937;
        }

        .crypto-list-selector {
            padding: 16px;
        }

        .crypto-option {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 1px solid #F3F4F6;
        }

        .crypto-option:last-child {
            border-bottom: none;
        }

        .crypto-option:hover {
            background: #F9FAFB;
        }

        .crypto-balance {
            margin-left: auto;
            text-align: right;
        }

        .balance-symbol {
            font-size: 12px;
            color: #6B7280;
            margin-left: 4px;
        }

        /* Styles pour les d√©tails de transaction d'√©change */
        .transaction-success {
            text-align: center;
            margin-bottom: 24px;
            padding: 20px;
            background: #F0FDF4;
            border-radius: 12px;
            border: 1px solid #BBF7D0;
        }

        .success-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }

        .transaction-success h4 {
            margin: 0 0 8px 0;
            color: #166534;
            font-size: 18px;
            font-weight: 600;
        }

        .transaction-success p {
            margin: 0;
            color: #166534;
            font-size: 14px;
        }

        .transaction-details {
            background: #F9FAFB;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
        }

        .transaction-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            font-size: 14px;
        }

        .transaction-row:last-child {
            margin-bottom: 0;
        }

        .transaction-row span:first-child {
            color: #6B7280;
        }

        .transaction-row span:last-child {
            font-weight: 600;
            color: #1F2937;
        }

        .transaction-id {
            font-family: monospace;
            font-size: 12px;
            background: #E5E7EB;
            padding: 4px 8px;
            border-radius: 4px;
        }

        /* Styles pour la modal d'historique */
        .history-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .history-modal-content {
            background: white;
            border-radius: 16px;
            max-width: 800px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            transform: translateY(-20px);
            transition: transform 0.3s ease;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .history-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 24px;
            border-bottom: 1px solid #E5E7EB;
            flex-wrap: wrap;
            gap: 16px;
        }

        .history-modal-header h3 {
            margin: 0;
            font-size: 20px;
            font-weight: 700;
            color: #1F2937;
        }

        .history-filters {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 8px 16px;
            background: #F3F4F6;
            color: #6B7280;
            border: 1px solid #E5E7EB;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .filter-btn:hover {
            background: #E5E7EB;
            color: #374151;
        }

        .filter-btn.active {
            background: #007A3D;
            color: white;
            border-color: #007A3D;
        }

        .history-modal-body {
            padding: 24px;
        }

        .history-summary {
            background: #F9FAFB;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 16px;
        }

        .summary-item {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .summary-label {
            font-size: 12px;
            color: #6B7280;
            font-weight: 500;
        }

        .summary-value {
            font-size: 16px;
            font-weight: 700;
            color: #1F2937;
        }

        .transactions-container {
            max-height: 400px;
            overflow-y: auto;
            margin-bottom: 20px;
        }

        .transactions-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .transaction-item {
            background: white;
            border: 1px solid #E5E7EB;
            border-radius: 12px;
            padding: 16px;
            transition: all 0.3s ease;
        }

        .transaction-item:hover {
            border-color: #007A3D;
            box-shadow: 0 4px 12px rgba(0, 122, 61, 0.1);
        }

        .transaction-item.deposit {
            border-left: 4px solid #10B981;
        }

        .transaction-item.withdraw {
            border-left: 4px solid #EF4444;
        }

        .transaction-item.exchange {
            border-left: 4px solid #3B82F6;
        }

        .transaction-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .transaction-type {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            color: #1F2937;
        }

        .transaction-status {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 12px;
            font-weight: 500;
            padding: 4px 8px;
            border-radius: 12px;
        }

        .transaction-status.completed {
            background: #D1FAE5;
            color: #065F46;
        }

        .transaction-status.pending {
            background: #FEF3C7;
            color: #92400E;
        }

        .transaction-status.failed {
            background: #FEE2E2;
            color: #991B1B;
        }

        .transaction-status.cancelled {
            background: #F3F4F6;
            color: #6B7280;
        }

        .transaction-details {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .transaction-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
        }

        .transaction-row span:first-child {
            color: #6B7280;
            font-weight: 500;
        }

        .transaction-row span:last-child {
            font-weight: 600;
            color: #1F2937;
        }

        .amount.positive {
            color: #10B981;
        }

        .amount.negative {
            color: #EF4444;
        }

        .address {
            font-family: monospace;
            font-size: 12px;
            background: #F3F4F6;
            padding: 2px 6px;
            border-radius: 4px;
        }

        .no-transactions {
            text-align: center;
            padding: 40px 20px;
            color: #6B7280;
        }

        .no-transactions-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }

        .no-transactions h4 {
            margin: 0 0 8px 0;
            color: #374151;
            font-size: 18px;
        }

        .no-transactions p {
            margin: 0;
            font-size: 14px;
        }

        /* Styles pour les transactions bancaires vides */
        .transactions-list .no-transactions {
            text-align: center;
            padding: 40px 20px;
            color: #6B7280;
            background: #F9FAFB;
            border-radius: 12px;
            border: 2px dashed #E5E7EB;
        }

        .transactions-list .no-transactions-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }

        .transactions-list .no-transactions h4 {
            margin: 0 0 8px 0;
            color: #374151;
            font-size: 18px;
        }

        .transactions-list .no-transactions p {
            margin: 0;
            font-size: 14px;
        }

        .history-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        .export-btn,
        .clear-btn,
        .test-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .test-btn {
            background: #8B5CF6;
            color: white;
        }

        .test-btn:hover {
            background: #7C3AED;
            transform: translateY(-1px);
        }

        .export-btn {
            background: #007A3D;
            color: white;
        }

        .export-btn:hover {
            background: #005A2E;
            transform: translateY(-1px);
        }

        .clear-btn {
            background: #EF4444;
            color: white;
        }

                         .clear-btn:hover {
            background: #DC2626;
            transform: translateY(-1px);
        }

        /* Styles pour la modal de param√®tres */
        .settings-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .settings-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .settings-modal-content {
            background: white;
            border-radius: 16px;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            transform: translateY(-20px);
            transition: transform 0.3s ease;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .settings-modal.active .settings-modal-content {
            transform: translateY(0);
        }

        .settings-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 24px;
            border-bottom: 1px solid #E5E7EB;
        }

        .settings-modal-header h3 {
            margin: 0;
            font-size: 20px;
            font-weight: 700;
            color: #1F2937;
        }

        .settings-modal-body {
            padding: 24px;
        }

        .settings-section {
            margin-bottom: 32px;
        }

        .settings-section-title {
            font-size: 18px;
            font-weight: 600;
            color: #1F2937;
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 2px solid #F3F4F6;
        }



        .account-section {
            background: #F9FAFB;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #E5E7EB;
        }

        .account-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0;
            border-bottom: 1px solid #E5E7EB;
        }

        .account-row:last-child {
            border-bottom: none;
        }

        .account-option {
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 8px;
            border-radius: 8px;
            width: 100%;
        }

        .account-option:hover {
            background: rgba(0, 122, 61, 0.1);
        }

        .account-option-icon {
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #007A3D 0%, #005A2C 100%);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            box-shadow: 0 2px 4px rgba(0, 122, 61, 0.2);
        }

        .account-option-text {
            flex: 1;
        }

        .account-option-title {
            font-weight: 600;
            color: #1F2937;
            margin-bottom: 2px;
        }

        .account-option-desc {
            font-size: 14px;
            color: #6B7280;
        }

        .account-option-arrow {
            color: #9CA3AF;
            transition: transform 0.3s ease;
        }

        .account-option:hover .account-option-arrow {
            transform: translateX(4px);
            color: #007A3D;
        }

        /* Styles pour l'option langue dans la section compte */
        .account-language-option {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px;
            border-radius: 8px;
            width: 100%;
        }

        .language-dropdown-container {
            margin-left: auto;
        }

        .language-dropdown {
            background: white;
            border: 2px solid #E5E7EB;
            border-radius: 8px;
            padding: 8px 12px;
            font-size: 14px;
            font-weight: 500;
            color: #1F2937;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 140px;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 8px center;
            background-size: 16px;
            padding-right: 32px;
        }



        .language-dropdown option {
            padding: 8px 12px;
            background: white;
            color: #1F2937;
        }

        /* Styles pour la section s√©curit√© */
        .security-section {
            background: #FEF2F2;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #FECACA;
        }

        .security-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0;
            border-bottom: 1px solid #F3F4F6;
        }

        .security-row:last-child {
            border-bottom: none;
        }

        .security-option {
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 8px;
            border-radius: 8px;
            width: 100%;
        }

        .security-option:hover {
            background: rgba(239, 68, 68, 0.1);
        }

        .security-option-icon {
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #007A3D 0%, #005A2C 100%);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            box-shadow: 0 2px 4px rgba(0, 122, 61, 0.2);
        }

        .security-option-text {
            flex: 1;
        }

        .security-option-title {
            font-weight: 600;
            color: #1F2937;
            margin-bottom: 2px;
        }

        .security-option-desc {
            font-size: 14px;
            color: #6B7280;
        }

        .security-option-arrow {
            color: #9CA3AF;
            transition: transform 0.3s ease;
        }

        .security-option:hover .security-option-arrow {
            transform: translateX(4px);
            color: #007A3D;
        }

        /* Styles pour la section support */
        .support-section {
            background: #F0F9FF;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #BAE6FD;
        }

        .support-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0;
            border-bottom: 1px solid #F3F4F6;
        }

        .support-row:last-child {
            border-bottom: none;
        }

        .support-option {
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 8px;
            border-radius: 8px;
            width: 100%;
        }

        .support-option:hover {
            background: rgba(59, 130, 246, 0.1);
        }

        .support-option-icon {
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #007A3D 0%, #005A2C 100%);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            box-shadow: 0 2px 4px rgba(0, 122, 61, 0.2);
        }

        .support-option-text {
            flex: 1;
        }

        .support-option-title {
            font-weight: 600;
            color: #1F2937;
            margin-bottom: 2px;
        }

        .support-option-desc {
            font-size: 14px;
            color: #6B7280;
        }

        .support-option-arrow {
            color: #9CA3AF;
            transition: transform 0.3s ease;
        }

        .support-option:hover .support-option-arrow {
            transform: translateX(4px);
            color: #007A3D;
        }

        .settings-modal-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            padding: 20px 24px;
            border-top: 1px solid #E5E7EB;
        }

        .settings-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .settings-btn.primary {
            background: #007A3D;
            color: white;
        }

        .settings-btn.primary:hover {
            background: #005A2E;
            transform: translateY(-1px);
        }

        .settings-btn.secondary {
            background: #F3F4F6;
            color: #374151;
        }

        .settings-btn.secondary:hover {
            background: #E5E7EB;
        }

        /* Styles pour les informations de version */
        .app-version-info {
            background: #F8F9FA;
            border-top: 1px solid #E5E7EB;
            padding: 16px 24px;
            text-align: center;
        }

        .version-details {
            display: flex;
            flex-direction: column;
            gap: 4px;
            align-items: center;
        }

        .version-text {
            font-size: 14px;
            font-weight: 600;
            color: #007A3D;
        }

        .build-text {
            font-size: 12px;
            color: #6B7280;
            font-family: 'Courier New', monospace;
        }

        .update-text {
            font-size: 12px;
            color: #9CA3AF;
        }

        /* Th√®me coh√©rent avec le site Lloyd's GO! */
        .settings-modal-content {
            background: white;
            border-radius: 20px;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            transform: translateY(-20px);
            transition: transform 0.3s ease;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            border: 1px solid rgba(0,0,0,0.05);
        }



        .settings-modal-header {
            background: linear-gradient(135deg, #007A3D 0%, #005A2C 100%);
            color: white;
            border-radius: 20px 20px 0 0;
        }

        .settings-modal-header h3 {
            color: white;
            font-weight: 700;
        }

        .settings-section-title {
            font-size: 20px;
            font-weight: 700;
            color: #1F2937;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid #f0f0f0;
            position: relative;
        }

        .settings-section-title::before {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 4px;
            height: 2px;
            background: linear-gradient(90deg, #007A3D, #00A651);
        }

        .account-section {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.08);
            border: 1px solid rgba(0,0,0,0.05);
        }

        .security-section {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.08);
            border: 1px solid rgba(0,0,0,0.05);
        }

        .support-section {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.08);
            border: 1px solid rgba(0,0,0,0.05);
        }

        .account-option:hover {
            background: #F9FAFB;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .security-option:hover {
            background: #F9FAFB;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .support-option:hover {
            background: #F9FAFB;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .language-dropdown:hover {
            border-color: #007A3D;
            background: #F0FDF4;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 122, 61, 0.15);
        }

        .language-dropdown:focus {
            outline: none;
            border-color: #007A3D;
            box-shadow: 0 0 0 3px rgba(0, 122, 61, 0.1);
            background: white;
        }

        /* Styles pour la modal Profil */
        .profile-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .profile-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .profile-modal-content {
            background: white;
            border-radius: 20px;
            max-width: 800px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            transform: translateY(-20px);
            transition: transform 0.3s ease;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            border: 1px solid rgba(0,0,0,0.05);
        }

        .profile-modal.active .profile-modal-content {
            transform: translateY(0);
        }

        .profile-modal-header {
            background: linear-gradient(135deg, #007A3D 0%, #005A2C 100%);
            color: white;
            border-radius: 20px 20px 0 0;
            padding: 20px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .profile-modal-header h3 {
            margin: 0;
            font-size: 20px;
            font-weight: 700;
            color: white;
        }

        .profile-modal-body {
            padding: 24px;
        }

        .profile-section {
            margin-bottom: 32px;
        }

        .profile-section h4 {
            font-size: 18px;
            font-weight: 600;
            color: #1F2937;
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 2px solid #f0f0f0;
        }

        .profile-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px;
        }

        .profile-field {
            display: flex;
            flex-direction: column;
        }

        .profile-field label {
            font-size: 14px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 8px;
        }

        .profile-field input {
            padding: 12px 16px;
            border: 2px solid #E5E7EB;
            border-radius: 8px;
            font-size: 14px;
            background: #F9FAFB;
            color: #1F2937;
            transition: all 0.3s ease;
        }

        .profile-field input:focus {
            outline: none;
            border-color: #007A3D;
            background: white;
            box-shadow: 0 0 0 3px rgba(0, 122, 61, 0.1);
        }

        .profile-modal-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            padding: 20px 24px;
            border-top: 1px solid #E5E7EB;
        }

        .profile-info-note {
            margin: 0 24px 20px 24px;
            padding: 16px;
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 1px solid #F59E0B;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(245, 158, 11, 0.1);
        }

        .info-note-content {
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }

        .info-note-icon {
            font-size: 20px;
            flex-shrink: 0;
            margin-top: 2px;
        }

        .info-note-text {
            font-size: 14px;
            line-height: 1.5;
            color: #92400E;
        }

        .info-note-text strong {
            color: #78350F;
            font-weight: 600;
        }

        .profile-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .profile-btn.primary {
            background: #007A3D;
            color: white;
        }

        .profile-btn.primary:hover {
            background: #005A2E;
            transform: translateY(-1px);
        }

        .profile-btn.secondary {
            background: #F3F4F6;
            color: #374151;
        }

        .profile-btn.secondary:hover {
            background: #E5E7EB;
        }

        /* Styles pour la modal KYC */
        .kyc-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .kyc-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .kyc-modal-content {
            background: white;
            border-radius: 20px;
            max-width: 900px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            transform: translateY(-20px);
            transition: transform 0.3s ease;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            border: 1px solid rgba(0,0,0,0.05);
        }

        .kyc-modal.active .kyc-modal-content {
            transform: translateY(0);
        }

        .kyc-modal-header {
            background: linear-gradient(135deg, #007A3D 0%, #005A2C 100%);
            color: white;
            border-radius: 20px 20px 0 0;
            padding: 20px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .kyc-modal-header h3 {
            margin: 0;
            font-size: 20px;
            font-weight: 700;
            color: white;
        }

        .kyc-modal-body {
            padding: 24px;
        }

        .kyc-step {
            margin-bottom: 32px;
            border: 1px solid #E5E7EB;
            border-radius: 12px;
            overflow: hidden;
        }

        .kyc-step-header {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 20px;
            background: #F9FAFB;
            border-bottom: 1px solid #E5E7EB;
        }

        .kyc-step-number {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #007A3D 0%, #005A2C 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 14px;
        }

        .kyc-step-info {
            flex: 1;
        }

        .kyc-step-info h4 {
            margin: 0 0 4px 0;
            font-size: 16px;
            font-weight: 600;
            color: #1F2937;
        }

        .kyc-step-info p {
            margin: 0;
            font-size: 14px;
            color: #6B7280;
        }

        .kyc-step-status {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 700;
        }

        .kyc-step-status.completed {
            background: #10B981;
            color: white;
        }

        .kyc-step-status.pending {
            background: #F59E0B;
            color: white;
        }

        .kyc-step-content {
            padding: 20px;
        }

        .kyc-form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }

        .kyc-field {
            display: flex;
            flex-direction: column;
        }

        .kyc-field label {
            font-size: 14px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 8px;
        }

        .kyc-field input,
        .kyc-field select {
            padding: 12px 16px;
            border: 2px solid #E5E7EB;
            border-radius: 8px;
            font-size: 14px;
            background: white;
            color: #1F2937;
            transition: all 0.3s ease;
            width: 100%;
        }

        .kyc-field input:focus,
        .kyc-field select:focus {
            outline: none;
            border-color: #007A3D;
            box-shadow: 0 0 0 3px rgba(0, 122, 61, 0.1);
            background: white;
        }

        .kyc-field input::placeholder {
            color: #9CA3AF;
        }

        .document-upload-section {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .document-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 16px;
            border: 2px dashed #E5E7EB;
            border-radius: 8px;
            background: #F9FAFB;
        }

        .document-icon {
            font-size: 24px;
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #007A3D 0%, #005A2C 100%);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .document-info {
            flex: 1;
        }

        .document-info h5 {
            margin: 0 0 4px 0;
            font-size: 16px;
            font-weight: 600;
            color: #1F2937;
        }

        .document-info p {
            margin: 0;
            font-size: 14px;
            color: #6B7280;
        }

        .upload-btn {
            padding: 8px 16px;
            background: #007A3D;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-btn:hover {
            background: #005A2E;
            transform: translateY(-1px);
        }

        .upload-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .upload-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: #007A3D;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 120px;
            justify-content: center;
        }

        .upload-text {
            font-size: 14px;
        }

        .upload-icon {
            font-size: 16px;
        }

        .upload-status {
            font-size: 12px;
            text-align: center;
            min-height: 16px;
            transition: all 0.3s ease;
        }

        .upload-status.success {
            color: #10B981;
        }

        .upload-status.error {
            color: #EF4444;
        }

        .upload-status.processing {
            color: #F59E0B;
        }

        .document-item.uploaded {
            border-color: #10B981;
            background: #F0FDF4;
        }

        .document-item.uploaded .document-icon {
            background: #10B981;
        }

        .verification-summary {
            background: #F9FAFB;
            border-radius: 8px;
            padding: 20px;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #E5E7EB;
        }

        .summary-item:last-child {
            border-bottom: none;
        }

        .summary-label {
            font-size: 14px;
            color: #6B7280;
        }

        .summary-value {
            font-size: 14px;
            font-weight: 600;
            color: #1F2937;
        }

        .status-pending {
            color: #F59E0B;
        }

        .status-required {
            color: #EF4444;
            font-weight: 600;
        }

        .summary-item .status-required {
            text-align: center;
            display: block;
            width: 100%;
        }

        .kyc-modal-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            padding: 20px 24px;
            border-top: 1px solid #E5E7EB;
        }

        .kyc-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .kyc-btn.primary {
            background: #007A3D;
            color: white;
        }

        .kyc-btn.primary:hover {
            background: #005A2E;
            transform: translateY(-1px);
        }

        .kyc-btn.secondary {
            background: #F3F4F6;
            color: #374151;
        }

        .kyc-btn.secondary:hover {
            background: #E5E7EB;
        }

        .simulate-deposit-btn {
             width: 100%;
             padding: 16px;
             background: #8B5CF6;
             color: white;
             border: none;
             border-radius: 12px;
             font-size: 16px;
             font-weight: 600;
             cursor: pointer;
             transition: all 0.3s ease;
             margin-top: 20px;
             display: flex;
             align-items: center;
             justify-content: center;
             gap: 8px;
         }

         .simulate-deposit-btn:hover {
             background: #7C3AED;
             transform: translateY(-1px);
         }

         /* Styles pour la modal de d√©p√¥t bancaire */
         .banking-deposit-modal {
             position: fixed;
             top: 0;
             left: 0;
             width: 100%;
             height: 100%;
             background: rgba(0, 0, 0, 0.8);
             display: flex;
             align-items: center;
             justify-content: center;
             z-index: 10000;
             opacity: 0;
             transition: opacity 0.3s ease;
         }

         .banking-deposit-modal-content {
             background: white;
             border-radius: 16px;
             max-width: 500px;
             width: 90%;
             max-height: 90vh;
             overflow-y: auto;
             transform: translateY(-20px);
             transition: transform 0.3s ease;
             box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
         }

         .banking-deposit-modal-header {
             display: flex;
             justify-content: space-between;
             align-items: center;
             padding: 20px 24px;
             border-bottom: 1px solid #E5E7EB;
         }

         .banking-deposit-modal-header h3 {
             margin: 0;
             font-size: 20px;
             font-weight: 700;
             color: #1F2937;
         }

         .banking-deposit-modal-body {
             padding: 24px;
         }

         .deposit-options {
             display: flex;
             flex-direction: column;
             gap: 16px;
         }

         .deposit-option {
             display: flex;
             align-items: center;
             gap: 16px;
             padding: 20px;
             background: #F9FAFB;
             border: 2px solid #E5E7EB;
             border-radius: 12px;
             cursor: pointer;
             transition: all 0.3s ease;
         }

         .deposit-option:hover {
             border-color: #007A3D;
             background: #F0FDF4;
             transform: translateY(-2px);
             box-shadow: 0 4px 12px rgba(0, 122, 61, 0.1);
         }

         .deposit-option-icon {
             font-size: 32px;
             width: 48px;
             height: 48px;
             display: flex;
             align-items: center;
             justify-content: center;
             background: white;
             border-radius: 12px;
             box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
         }

         .deposit-option-info {
             flex: 1;
         }

         .deposit-option-info h4 {
             margin: 0 0 4px 0;
             font-size: 18px;
             font-weight: 700;
             color: #1F2937;
         }

         .deposit-option-info p {
             margin: 0;
             font-size: 14px;
             color: #6B7280;
         }

         .deposit-option-arrow {
             color: #6B7280;
             transition: transform 0.3s ease;
         }

         .deposit-option:hover .deposit-option-arrow {
             transform: translateX(4px);
             color: #007A3D;
         }

         .crypto-info-header {
             display: flex;
             align-items: center;
             gap: 16px;
             margin-bottom: 24px;
             padding: 16px;
             background: #F9FAFB;
             border-radius: 12px;
         }

         .crypto-info-header .crypto-icon {
             font-size: 32px;
             width: 48px;
             height: 48px;
             display: flex;
             align-items: center;
             justify-content: center;
             background: white;
             border-radius: 12px;
             box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
         }

         .crypto-info-header .crypto-details h4 {
             margin: 0 0 4px 0;
             font-size: 18px;
             font-weight: 700;
             color: #1F2937;
         }

         .crypto-info-header .crypto-details p {
             margin: 0;
             font-size: 14px;
             color: #6B7280;
         }

         .back-btn {
             width: 100%;
             padding: 16px;
             background: #F3F4F6;
             color: #374151;
             border: 2px solid #E5E7EB;
             border-radius: 12px;
             font-size: 16px;
             font-weight: 600;
             cursor: pointer;
             transition: all 0.3s ease;
             margin-top: 20px;
             display: flex;
             align-items: center;
             justify-content: center;
             gap: 8px;
         }

         .back-btn:hover {
             background: #E5E7EB;
             border-color: #D1D5DB;
             transform: translateY(-1px);
         }

         /* Styles pour la modal de retrait bancaire */
         .banking-withdraw-modal {
             position: fixed;
             top: 0;
             left: 0;
             width: 100%;
             height: 100%;
             background: rgba(0, 0, 0, 0.8);
             display: flex;
             align-items: center;
             justify-content: center;
             z-index: 10000;
             opacity: 0;
             transition: opacity 0.3s ease;
         }

         .banking-withdraw-modal-content {
             background: white;
             border-radius: 16px;
             max-width: 500px;
             width: 90%;
             max-height: 90vh;
             overflow-y: auto;
             transform: translateY(-20px);
             transition: transform 0.3s ease;
             box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
         }

         .banking-withdraw-modal-header {
             display: flex;
             justify-content: space-between;
             align-items: center;
             padding: 20px 24px;
             border-bottom: 1px solid #E5E7EB;
         }

         .banking-withdraw-modal-header h3 {
             margin: 0;
             font-size: 20px;
             font-weight: 700;
             color: #1F2937;
         }

         .banking-withdraw-modal-body {
             padding: 24px;
         }

         .withdraw-options {
             display: flex;
             flex-direction: column;
             gap: 16px;
         }

         .withdraw-option {
             display: flex;
             align-items: center;
             gap: 16px;
             padding: 20px;
             background: #F9FAFB;
             border: 2px solid #E5E7EB;
             border-radius: 12px;
             cursor: pointer;
             transition: all 0.3s ease;
         }

         .withdraw-option:hover {
             border-color: #EF4444;
             background: #FEF2F2;
             transform: translateY(-2px);
             box-shadow: 0 4px 12px rgba(239, 68, 68, 0.1);
         }

         .withdraw-option-icon {
             font-size: 32px;
             width: 48px;
             height: 48px;
             display: flex;
             align-items: center;
             justify-content: center;
             background: white;
             border-radius: 12px;
             box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
         }

         .withdraw-option-info {
             flex: 1;
         }

         .withdraw-option-info h4 {
             margin: 0 0 4px 0;
             font-size: 18px;
             font-weight: 700;
             color: #1F2937;
         }

         .withdraw-option-info p {
             margin: 0;
             font-size: 14px;
             color: #6B7280;
         }

         .withdraw-option-arrow {
             color: #6B7280;
             transition: transform 0.3s ease;
         }

         .withdraw-option:hover .withdraw-option-arrow {
             transform: translateX(4px);
             color: #EF4444;
         }

         .withdraw-form {
             margin-bottom: 20px;
         }

         .form-group {
             margin-bottom: 20px;
         }

         .form-group label {
             display: block;
             margin-bottom: 8px;
             font-size: 14px;
             font-weight: 600;
             color: #374151;
         }

         .withdraw-input {
             width: 100%;
             padding: 12px 16px;
             border: 2px solid #E5E7EB;
             border-radius: 8px;
             font-size: 14px;
             transition: border-color 0.3s ease;
         }

         .withdraw-input:focus {
             outline: none;
             border-color: #EF4444;
         }

         .withdraw-info {
             background: #F9FAFB;
             border-radius: 8px;
             padding: 16px;
             margin-bottom: 20px;
         }

         .info-row {
             display: flex;
             justify-content: space-between;
             align-items: center;
             margin-bottom: 8px;
             font-size: 14px;
         }

         .info-row:last-child {
             margin-bottom: 0;
         }

         .info-row span:first-child {
             color: #6B7280;
         }

         .info-row span:last-child {
             font-weight: 600;
             color: #1F2937;
         }

         .withdraw-btn {
             width: 100%;
             padding: 16px;
             background: #E5E7EB;
             color: #9CA3AF;
             border: none;
             border-radius: 12px;
             font-size: 16px;
             font-weight: 600;
             cursor: not-allowed;
             transition: all 0.3s ease;
             display: flex;
             align-items: center;
             justify-content: center;
             gap: 8px;
         }

         .withdraw-btn.active {
             background: #EF4444;
             color: white;
             cursor: pointer;
         }

         .withdraw-btn.active:hover {
             background: #DC2626;
             transform: translateY(-1px);
         }

         .address-validation {
             margin-top: 8px;
             font-size: 12px;
             font-weight: 500;
             min-height: 16px;
         }

         .amount-input-group {
             display: flex;
             gap: 8px;
         }

         .amount-input-group input {
             flex: 1;
             padding: 12px 16px;
             border: 2px solid #E5E7EB;
             border-radius: 8px;
             font-size: 14px;
             transition: border-color 0.3s ease;
         }

         .amount-input-group input:focus {
             outline: none;
             border-color: #EF4444;
         }

         .max-btn {
             padding: 12px 16px;
             background: #F3F4F6;
             color: #374151;
             border: 2px solid #E5E7EB;
             border-radius: 8px;
             font-size: 14px;
             font-weight: 600;
             cursor: pointer;
             transition: all 0.3s ease;
             white-space: nowrap;
         }

         .max-btn:hover {
             background: #E5E7EB;
             border-color: #D1D5DB;
         }
    </style>
</head>
<body>


    <div class="dashboard-container">
        <!-- Main Content -->
        <main class="main-content">
            <!-- Home Page -->
            <div id="home" class="page-content active">
                <div class="page-header">
                    <div class="logo-container">
                        <div class="logo-horse">L</div>
                        <h1>Lloyd's GO!</h1>
                    </div>
                    <div class="profile-container">
                        <div class="profile-icon" id="profileBtn">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                                <circle cx="12" cy="7" r="4"/>
                            </svg>
                        </div>
                        <div class="profile-dropdown" id="profileDropdown">
                            <div class="profile-info">
                                <div class="profile-name">Admin System</div>
                                <div class="profile-email">admin@lloyds.com</div>
                            </div>
                            <div class="profile-actions">
                                <button class="profile-action-btn">
                                    <span style="margin-right: 8px;">‚öôÔ∏è</span>
                                    Param√®tres
                                </button>
                                <button class="profile-action-btn">
                                    <span style="margin-right: 8px;">üö™</span>
                                    D√©connexion
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                                 <div class="balance-overview-card">
                     <div class="balance-overview-header">
                         <div class="balance-overview-title">Solde total</div>
                         <div class="balance-overview-amount" id="mainBalanceAmount">‚Ç¨0.00</div>
                     </div>

                 </div>

                 <div class="stats-grid">
                     <div class="stat-card">
                         <div class="stat-value">‚Ç¨0.00</div>
                         <div class="stat-change">
                               <span>‚Üó</span> +0.0% ce mois
                         </div>
                         <p>Portefeuille crypto</p>
                     </div>

                     <div class="stat-card">
                         <div class="stat-value">‚Ç¨0.00</div>
                         <div class="stat-change">
                               <span>‚Üó</span> +0.0% ce mois
                         </div>
                         <p>Staking actif</p>
                     </div>

                     <div class="stat-card">
                         <div class="stat-value">0</div>
                         <div class="stat-change">
                             <span>‚Üó</span> Ce mois
                         </div>
                         <p>Transactions</p>
                     </div>
                 </div>

                 <div class="top-performers">
                     <div class="performer-card gainer" id="topGainerCard">
                         <div class="performer-bg"></div>
                         <div class="performer-header">
                             <div class="performer-title">Top Gainer</div>
                             <div class="performer-badge">üî•</div>
                         </div>
                         <div class="performer-content">
                             <div class="performer-name" id="topGainerName">Chargement...</div>
                             <div class="performer-change positive" id="topGainerChange">
                                 <span class="change-icon">‚Üó</span>
                                 <span class="change-value" id="topGainerChangeValue">--</span>
                             </div>
                             <div class="performer-price" id="topGainerPrice">‚Ç¨--</div>
                             <div class="performer-chart">
                                 <svg width="80" height="30" viewBox="0 0 80 30">
                                     <path class="chart-line gainer-line" d="M0,25 L10,18 L20,22 L30,15 L40,20 L50,13 L60,17 L70,10 L80,15" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"/>
                                     <circle class="chart-dot" cx="80" cy="15" r="3" fill="currentColor"/>
                                 </svg>
                             </div>
                         </div>
                     </div>
                     
                     <div class="performer-card loser" id="topLoserCard">
                         <div class="performer-bg"></div>
                         <div class="performer-header">
                             <div class="performer-title">Top Loser</div>
                             <div class="performer-badge">‚ö°</div>
                         </div>
                         <div class="performer-content">
                             <div class="performer-name" id="topLoserName">Chargement...</div>
                             <div class="performer-change negative" id="topLoserChange">
                                 <span class="change-icon">‚Üò</span>
                                 <span class="change-value" id="topLoserChangeValue">--</span>
                             </div>
                             <div class="performer-price" id="topLoserPrice">‚Ç¨--</div>
                             <div class="performer-chart">
                                 <svg width="80" height="30" viewBox="0 0 80 30">
                                     <path class="chart-line loser-line" d="M0,5 L10,12 L20,8 L30,15 L40,10 L50,17 L60,13 L70,18 L80,23" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"/>
                                     <circle class="chart-dot" cx="80" cy="23" r="3" fill="currentColor"/>
                                 </svg>
                             </div>
                         </div>
                     </div>
                 </div>
                 
                 <div class="section-divider"></div>
                 
                 <div class="news-section">
                     <div class="news-section-header">
                         <h3 class="section-title">Actualit√©s</h3>
                         <div class="news-controls">
                             <button class="news-refresh-btn" onclick="fetchNews()" id="newsRefreshBtn">
                                 <span class="refresh-icon">üîÑ</span>
                                 <span class="refresh-text">Actualiser</span>
                             </button>
                             <div class="news-status" id="newsStatus">Chargement...</div>
                         </div>
                     </div>
                     <div class="news-grid" id="newsGrid">
                         <div class="news-loading">
                             <div class="news-spinner"></div>
                             <p>Chargement des actualit√©s depuis CoinTelegraph et autres sources...</p>
                         </div>
                     </div>
                 </div>
            </div>

                         <!-- Wallet Page -->
             <div id="wallet" class="page-content">
                 <div class="page-header">
                     <h1 class="page-title">Portefeuille Crypto</h1>
                 </div>

                 <!-- Balance Overview -->
                 <div class="balance-overview">
                     <div class="balance-overview-card">
                         <div class="balance-overview-header">
                             <div class="balance-overview-title">Total<br>cryptomonnaie</div>
                             <div class="balance-overview-amount" id="balanceAmount">‚Ç¨0.00</div>
                             </div>
                     </div>
                     
                     <!-- Quick Actions -->
                     <div class="balance-actions-row">
                         <button class="balance-action-btn">
                             <div class="action-icon">
                                 <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                     <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                     <polyline points="7,10 12,15 17,10"/>
                                     <line x1="12" y1="15" x2="12" y2="3"/>
                                 </svg>
                             </div>
                             <span>Retrait</span>
                         </button>
                         
                         <button class="balance-action-btn">
                             <div class="action-icon">
                                 <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                     <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                     <polyline points="17,8 12,3 7,8"/>
                                     <line x1="12" y1="3" x2="12" y2="15"/>
                                 </svg>
                             </div>
                             <span>D√©p√¥t</span>
                         </button>
                         
                         <button class="balance-action-btn">
                             <div class="action-icon">
                                 <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                     <path d="M7 10l5 5 5-5"/>
                                     <path d="M7 14l5-5 5 5"/>
                                     <circle cx="12" cy="12" r="10"/>
                                 </svg>
                             </div>
                             <span>√âchanger</span>
                         </button>
                         
                         <button class="balance-action-btn">
                             <div class="action-icon">
                                 <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                     <path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                 </svg>
                             </div>
                             <span>Historique</span>
                         </button>
                     </div>
                 </div>

                 <!-- Crypto Assets -->
                 <div class="assets-section">
                     <div class="section-header">
                         <div class="crypto-header-left">
                             <h3>Mes actifs</h3>
                             <div class="realtime-indicator">
                                 <span class="realtime-dot"></span>
                                 <span class="realtime-text">Temps r√©el</span>
                                 <span class="last-update" id="lastUpdateTime"></span>
                             </div>
                             <button class="refresh-btn" onclick="forceUpdateWithNotification()" title="Actualiser les prix">
                                 <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                     <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
                                     <path d="M21 3v5h-5"/>
                                     <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/>
                                     <path d="M3 21v-5h5"/>
                                 </svg>
                             </button>
                         </div>
                         <button class="btn-text" id="toggleCryptoBtn">Voir tout</button>
                     </div>
                     
                     <div class="crypto-list" id="cryptoList">
                         <div class="crypto-item" data-crypto="bitcoin" onclick="openCryptoDetail('bitcoin')">
                             <div class="crypto-info">
                                 <div class="crypto-icon">
                                     <img src="https://s2.coinmarketcap.com/static/img/coins/64x64/1.png" alt="Bitcoin" width="32" height="32">
                                 </div>
                                 <div class="crypto-details">
                                     <div class="crypto-name">Bitcoin</div>
                                     <div class="crypto-price">‚Ç¨0.00</div>
                                     <div class="crypto-amount">0.000 BTC</div>
                                 </div>
                             </div>
                             <div class="crypto-value">
                                 <div class="value-amount">‚Ç¨0.00</div>
                                 <div class="value-change positive">+1.85%</div>
                                 
                             </div>
                         </div>

                         <div class="crypto-item" data-crypto="ethereum" onclick="openCryptoDetail('ethereum')">
                             <div class="crypto-info">
                                 <div class="crypto-icon">
                                     <img src="https://s2.coinmarketcap.com/static/img/coins/64x64/1027.png" alt="Ethereum" width="32" height="32">
                                 </div>
                                 <div class="crypto-details">
                                     <div class="crypto-name">Ethereum</div>
                                     <div class="crypto-price">‚Ç¨0.00</div>
                                     <div class="crypto-amount">0.000 ETH</div>
                                 </div>
                             </div>
                             <div class="crypto-value">
                                 <div class="value-amount">‚Ç¨0.00</div>
                                 <div class="value-change positive">+2.15%</div>
                                 
                             </div>
                         </div>

                         <div class="crypto-item" data-crypto="solana" onclick="openCryptoDetail('solana')">
                             <div class="crypto-info">
                                 <div class="crypto-icon">
                                     <img src="https://s2.coinmarketcap.com/static/img/coins/64x64/5426.png" alt="Solana" width="32" height="32">
                                 </div>
                                 <div class="crypto-details">
                                     <div class="crypto-name">Solana</div>
                                     <div class="crypto-price">‚Ç¨0.00</div>
                                     <div class="crypto-amount">0.000 SOL</div>
                                 </div>
                             </div>
                             <div class="crypto-value">
                                 <div class="value-amount">‚Ç¨0.00</div>
                                 <div class="value-change positive">+3.2%</div>

                             </div>
                         </div>

                         <div class="crypto-item" data-crypto="bnb" onclick="openCryptoDetail('bnb')">
                             <div class="crypto-info">
                                 <div class="crypto-icon">
                                     <img src="https://s2.coinmarketcap.com/static/img/coins/64x64/1839.png" alt="BNB" width="32" height="32">
                                 </div>
                                 <div class="crypto-details">
                                     <div class="crypto-name">BNB</div>
                                     <div class="crypto-price">‚Ç¨0.00</div>
                                     <div class="crypto-amount">0.000 BNB</div>
                                 </div>
                             </div>
                             <div class="crypto-value">
                                 <div class="value-amount">‚Ç¨0.00</div>
                                 <div class="value-change positive">+1.25%</div>

                             </div>
                         </div>

                         <div class="crypto-item" data-crypto="xrp" onclick="openCryptoDetail('xrp')">
                             <div class="crypto-info">
                                 <div class="crypto-icon">
                                     <img src="https://s2.coinmarketcap.com/static/img/coins/64x64/52.png" alt="XRP" width="32" height="32">
                                 </div>
                                 <div class="crypto-details">
                                     <div class="crypto-name">XRP</div>
                                     <div class="crypto-price">‚Ç¨0.00</div>
                                     <div class="crypto-amount">0.000 XRP</div>
                                 </div>
                             </div>
                             <div class="crypto-value">
                                 <div class="value-amount">‚Ç¨0.00</div>
                                 <div class="value-change positive">+0.85%</div>

                             </div>
                         </div>

                         <div class="crypto-item" data-crypto="dogecoin" onclick="openCryptoDetail('dogecoin')">
                             <div class="crypto-info">
                                 <div class="crypto-icon">
                                     <img src="https://s2.coinmarketcap.com/static/img/coins/64x64/74.png" alt="Dogecoin" width="32" height="32">
                                 </div>
                                 <div class="crypto-details">
                                     <div class="crypto-name">Dogecoin</div>
                                     <div class="crypto-price">‚Ç¨0.00</div>
                                     <div class="crypto-amount">0.000 DOGE</div>
                                 </div>
                             </div>
                             <div class="crypto-value">
                                 <div class="value-amount">‚Ç¨0.00</div>
                                 <div class="value-change positive">+1.45%</div>
                             </div>
                         </div>

                         <div class="crypto-item hidden-crypto" data-crypto="cardano" onclick="openCryptoDetail('cardano')">
                             <div class="crypto-info">
                                 <div class="crypto-icon">
                                     <img src="https://s2.coinmarketcap.com/static/img/coins/64x64/2010.png" alt="Cardano" width="32" height="32">
                                 </div>
                                 <div class="crypto-details">
                                     <div class="crypto-name">Cardano</div>
                                     <div class="crypto-price">‚Ç¨0.00</div>
                                     <div class="crypto-amount">0.000 ADA</div>
                                 </div>
                             </div>
                             <div class="crypto-value">
                                 <div class="value-amount">‚Ç¨0.00</div>
                                 <div class="value-change positive">+1.45%</div>
                             </div>
                         </div>

                         <div class="crypto-item hidden-crypto" data-crypto="shiba" onclick="openCryptoDetail('shiba')">
                             <div class="crypto-info">
                                 <div class="crypto-icon">
                                     <img src="https://s2.coinmarketcap.com/static/img/coins/64x64/5994.png" alt="Shiba Inu" width="32" height="32">
                                 </div>
                                 <div class="crypto-details">
                                     <div class="crypto-name">Shiba Inu</div>
                                     <div class="crypto-price">‚Ç¨0.00</div>
                                     <div class="crypto-amount">0.000 SHIB</div>
                                 </div>
                             </div>
                             <div class="crypto-value">
                                 <div class="value-amount">‚Ç¨0.00</div>
                                 <div class="value-change positive">+2.75%</div>
                             </div>
                         </div>

                         <div class="crypto-item hidden-crypto" data-crypto="polkadot" onclick="openCryptoDetail('polkadot')">
                             <div class="crypto-info">
                                 <div class="crypto-icon">
                                     <img src="https://s2.coinmarketcap.com/static/img/coins/64x64/6636.png" alt="Polkadot" width="32" height="32">
                                 </div>
                                 <div class="crypto-details">
                                     <div class="crypto-name">Polkadot</div>
                                     <div class="crypto-price">‚Ç¨0.00</div>
                                     <div class="crypto-amount">0.000 DOT</div>
                                 </div>
                             </div>
                             <div class="crypto-value">
                                 <div class="value-amount">‚Ç¨0.00</div>
                                 <div class="value-change positive">+1.15%</div>
                             </div>
                         </div>

                         <div class="crypto-item hidden-crypto" data-crypto="polygon" onclick="openCryptoDetail('polygon')">
                             <div class="crypto-info">
                                 <div class="crypto-icon">
                                     <img src="https://s2.coinmarketcap.com/static/img/coins/64x64/3890.png" alt="Polygon" width="32" height="32">
                                 </div>
                                 <div class="crypto-details">
                                     <div class="crypto-name">Polygon</div>
                                     <div class="crypto-price">‚Ç¨0.00</div>
                                     <div class="crypto-amount">0.000 MATIC</div>
                                 </div>
                             </div>
                             <div class="crypto-value">
                                 <div class="value-amount">‚Ç¨0.00</div>
                                 <div class="value-change positive">+0.95%</div>
                             </div>
                         </div>

                         <div class="crypto-item hidden-crypto" data-crypto="avalanche" onclick="openCryptoDetail('avalanche')">
                             <div class="crypto-info">
                                 <div class="crypto-icon">
                                     <img src="https://s2.coinmarketcap.com/static/img/coins/64x64/5805.png" alt="Avalanche" width="32" height="32">
                                 </div>
                                 <div class="crypto-details">
                                     <div class="crypto-name">Avalanche</div>
                                     <div class="crypto-price">‚Ç¨0.00</div>
                                     <div class="crypto-amount">0.000 AVAX</div>
                                 </div>
                             </div>
                             <div class="crypto-value">
                                 <div class="value-amount">‚Ç¨0.00</div>
                                 <div class="value-change positive">+2.75%</div>
                             </div>
                         </div>
                     </div>
                 </div>

                 <!-- AI Investment Assistant -->
                 <div class="ai-assistant-section">
                     <div class="ai-header">
                         <div class="ai-icon">
                             <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                 <path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"/>
                                 <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
                                 <line x1="12" y1="19" x2="12" y2="23"/>
                                 <line x1="8" y1="23" x2="16" y2="23"/>
                             </svg>
                         </div>
                         <div class="ai-title">
                             <h3>ü§ñ Assistant IA Crypto</h3>
                             <p>Sp√©cialiste des cryptomonnaies ‚Ä¢ Disponible 24/7</p>
                         </div>
                     </div>
                     
                     <div class="chat-container" id="cryptoChatContainer">
                         <div class="chat-messages" id="cryptoChatMessages">
                             <div class="message ai-message">
                                 <div class="bot-name">ü§ñ Assistant Crypto</div>
                                 Bonjour ! Je suis votre assistant IA sp√©cialis√© dans les cryptomonnaies.
                                 Je peux r√©pondre √† vos questions sur Bitcoin, Ethereum, le trading, le staking, la blockchain et bien plus !
                                 <br><br>
                                 Que souhaitez-vous savoir ? üöÄ
                             </div>
                         </div>

                         <div class="typing-indicator" id="cryptoTypingIndicator">
                             <div class="typing-dots">
                                 <span></span>
                                 <span></span>
                                 <span></span>
                             </div>
                         </div>

                         <div class="chat-input-container">
                             <div class="chat-input-wrapper">
                                 <input
                                     type="text"
                                     class="chat-input"
                                     id="cryptoChatInput"
                                     placeholder="Posez votre question sur les cryptos..."
                                     autocomplete="off"
                                 >
                                 <button class="send-button" id="cryptoSendButton">
                                     ‚û§
                                 </button>
                             </div>

                             <div class="suggestions">
                                 <div class="suggestion-chip" onclick="askCryptoQuestion('Qu\'est-ce que Bitcoin ?')">Qu'est-ce que Bitcoin ?</div>
                                 <div class="suggestion-chip" onclick="askCryptoQuestion('Comment acheter des cryptos ?')">Comment acheter ?</div>
                                 <div class="suggestion-chip" onclick="askCryptoQuestion('Qu\'est-ce que le staking ?')">Le staking</div>
                                 <div class="suggestion-chip" onclick="askCryptoQuestion('Prix du Bitcoin aujourd\'hui')">Prix Bitcoin</div>
                                 <div class="suggestion-chip" onclick="askCryptoQuestion('Diff√©rence entre Bitcoin et Ethereum')">BTC vs ETH</div>
                             </div>
                         </div>
                     </div>
                 </div>

             </div>

                         <!-- Banking Page -->
             <div id="banking" class="page-content">
                 <div class="page-header">
                     <h1 class="page-title">Comptes bancaires</h1>

                 </div>

                 <!-- Account Overview -->
                 <div class="account-overview">
                     <div class="account-card primary">
                         <div class="account-header">
                             <div class="account-info">
                                 <h3>Compte Principal</h3>
                             </div>
                             <div class="account-balance">
                                 <span class="balance-amount">‚Ç¨0.00</span>
                                 <span class="balance-label">Solde disponible</span>
                             </div>
                         </div>
                         <div class="account-actions">
                             <button class="account-btn" onclick="showBankingDepositModal()">üì• D√©p√¥t</button>
                             <button class="account-btn" onclick="showBankingWithdrawModal()">üì§ Retrait</button>
                             <button class="account-btn" onclick="showHistoryModal('banking', 'Historique bancaire')">üìä Historique</button>
                         </div>
                     </div>
                 </div>

                 <!-- Recent Transactions -->
                 <div class="transactions-section">
                     <div class="section-header">
                         <h3>Transactions r√©centes</h3>
                         <button class="btn-text">Voir tout</button>
                     </div>
                     
                     <div class="transactions-list">
                         <div class="no-transactions">
                             <div class="no-transactions-icon">üìã</div>
                             <h4>Aucune transaction</h4>
                             <p>Vous n'avez pas encore effectu√© de transactions bancaires.</p>
                             </div>
                     </div>
                 </div>

                 <!-- Quick Banking Actions -->
                 <div class="banking-actions">
                     <div class="action-grid">
                         <button class="banking-action" onclick="showBankingDepositModal()">
                             <div class="action-icon">üì•</div>
                             <span>D√©p√¥t</span>
                         </button>
                         <button class="banking-action">
                             <div class="action-icon">üìä</div>
                             <span>Analyses</span>
                         </button>
                     </div>
                 </div>
             </div>

                         <!-- Analytics Page -->
             <div id="analytics" class="page-content">
                 <div class="page-header">
                     <h1 class="page-title">Analyses et performances</h1>
                 </div>

                 <!-- Performance Overview -->
                 <div class="performance-overview">
                     <div class="performance-card">
                         <div class="performance-header">
                             <h3>Performance globale</h3>
                             <div class="time-filter">
                                 <button class="time-btn active">1M</button>
                                 <button class="time-btn">3M</button>
                                 <button class="time-btn">1A</button>
                                 <button class="time-btn">Tout</button>
                             </div>
                         </div>
                         <div class="performance-stats">
                             <div class="stat-item">
                                 <div class="stat-label">Rendement total</div>
                                 <div class="stat-value positive">+‚Ç¨0.00</div>
                                 <div class="stat-percentage">+0.0%</div>
                             </div>
                             <div class="stat-item">
                                 <div class="stat-label">Meilleur actif</div>
                                 <div class="stat-value">Bitcoin</div>
                                 <div class="stat-percentage positive">+0.0%</div>
                             </div>
                             <div class="stat-item">
                                 <div class="stat-label">Volatilit√©</div>
                                 <div class="stat-value">Moyenne</div>
                                 <div class="stat-percentage">0.0%</div>
                             </div>
                         </div>
                     </div>
                 </div>

                 <!-- Portfolio Distribution -->
                 <div class="portfolio-section">
                     <div class="section-header">
                         <h3>R√©partition du portefeuille</h3>
                         <button class="btn-text">Voir d√©tails</button>
                     </div>
                     
                     <div class="portfolio-chart">
                         <div class="chart-placeholder">
                             <div class="chart-circle">
                                 <div class="chart-inner">
                                     <span class="chart-percentage">0%</span>
                                     <span class="chart-label">Portefeuille</span>
                                 </div>
                             </div>
                             <div class="chart-legend">
                                 <div class="legend-item">
                                     <div class="legend-color" style="background: #E5E7EB;"></div>
                                     <span>Aucun actif 0%</span>
                                 </div>
                                 </div>
                                 </div>
                     </div>
                 </div>

                 <!-- Market Trends -->
                 <div class="trends-section">
                     <div class="section-header">
                         <h3>Tendances du march√©</h3>
                         <button class="btn-text">Actualiser</button>
                     </div>
                     
                     <div class="trends-grid">
                         <div class="trend-card positive">
                             <div class="trend-header">
                                 <div class="trend-icon">üìà</div>
                                 <div class="trend-title">Bitcoin</div>
                             </div>
                             <div class="trend-price">‚Ç¨33,650.00</div>
                             <div class="trend-change">+2.4% (24h)</div>
                         </div>

                         <div class="trend-card positive">
                             <div class="trend-header">
                                 <div class="trend-icon">üìà</div>
                                 <div class="trend-title">Ethereum</div>
                             </div>
                             <div class="trend-price">‚Ç¨1,995.50</div>
                             <div class="trend-change">+1.8% (24h)</div>
                         </div>

                         <div class="trend-card negative">
                             <div class="trend-header">
                                 <div class="trend-icon">üìâ</div>
                                 <div class="trend-title">Cardano</div>
                             </div>
                             <div class="trend-price">‚Ç¨0.48</div>
                             <div class="trend-change">-0.9% (24h)</div>
                         </div>

                         <div class="trend-card positive">
                             <div class="trend-header">
                                 <div class="trend-icon">üìà</div>
                                 <div class="trend-title">Dogecoin</div>
                             </div>
                             <div class="trend-price">‚Ç¨0.147</div>
                             <div class="trend-change">+5.2% (24h)</div>
                         </div>
                     </div>
                 </div>
             </div>

                         <!-- Staking Page -->
             <div id="staking" class="page-content">
                 <div class="page-header">
                     <h1 class="page-title">Staking et r√©compenses</h1>
                     <div class="header-actions">
                         <button class="btn btn-secondary">Historique</button>
                         <button class="btn btn-primary">Staker</button>
                     </div>
                 </div>

                 <!-- Staking Overview -->
                 <div class="staking-overview">
                     <div class="staking-card">
                         <div class="staking-header">
                             <h3>R√©compenses totales</h3>
                             <div class="staking-actions">
                                 <button class="staking-btn">üìä D√©tails</button>
                                 <button class="staking-btn">üí∞ Retirer</button>
                             </div>
                         </div>
                         <div class="staking-balance">
                               <div class="balance-main">‚Ç¨0.00</div>
                             <div class="balance-subtitle" data-translate="staking-rewards">R√©compenses accumul√©es</div>
                               <div class="balance-apy">APY moyen: 0.0%</div>
                         </div>
                     </div>
                 </div>

                 <!-- Active Staking -->
                 <div class="active-staking-section">
                     <div class="section-header">
                         <h3>Staking actif</h3>
                         <button class="btn-text">Voir tout</button>
                     </div>
                     
                     <div class="staking-list">
                                                    <div class="no-staking" style="text-align: center; padding: 40px 20px; color: #6B7280;">
                               <div style="font-size: 48px; margin-bottom: 16px;">üìä</div>
                               <h4 style="margin-bottom: 8px; color: #1F2937;">Aucun staking actif</h4>
                               <p style="margin: 0;">Vous n'avez pas encore de cryptomonnaies en staking.</p>
                         </div>
                     </div>
                 </div>

                 <!-- Available Staking Opportunities -->
                 <div class="opportunities-section">
                     <div class="section-header">
                         <h3>Opportunit√©s de staking</h3>
                         <button class="btn-text">Filtrer</button>
                     </div>
                     
                     <div class="opportunities-grid">
                         <div class="opportunity-card">
                             <div class="opportunity-header">
                                 <div class="opportunity-icon">‚Çø</div>
                                 <div class="opportunity-info">
                                     <div class="opportunity-name">Bitcoin Staking</div>
                                     <div class="opportunity-apy">APY: 6.8%</div>
                                 </div>
                                 <div class="opportunity-status available">Disponible</div>
                             </div>
                             <div class="opportunity-details">
                                 <div class="detail-item">
                                     <span>Dur√©e min.</span>
                                     <span>30 jours</span>
                                 </div>
                                 <div class="detail-item">
                                     <span>Montant min.</span>
                                     <span>0.01 BTC</span>
                                 </div>
                                 <div class="detail-item">
                                     <span>Risque</span>
                                     <span class="risk-low">Faible</span>
                                 </div>
                             </div>
                             <button class="opportunity-btn">Staker maintenant</button>
                         </div>

                         <div class="opportunity-card">
                             <div class="opportunity-header">
                                 <div class="opportunity-icon">üîó</div>
                                 <div class="opportunity-info">
                                     <div class="opportunity-name">Chainlink</div>
                                     <div class="opportunity-apy">APY: 15.2%</div>
                                 </div>
                                 <div class="opportunity-status available">Disponible</div>
                             </div>
                             <div class="opportunity-details">
                                 <div class="detail-item">
                                     <span>Dur√©e min.</span>
                                     <span>7 jours</span>
                                 </div>
                                 <div class="detail-item">
                                     <span>Montant min.</span>
                                     <span>100 LINK</span>
                                 </div>
                                 <div class="detail-item">
                                     <span>Risque</span>
                                     <span class="risk-medium">Moyen</span>
                                 </div>
                             </div>
                             <button class="opportunity-btn">Staker maintenant</button>
                         </div>

                         <div class="opportunity-card">
                             <div class="opportunity-header">
                                 <div class="opportunity-icon">üåê</div>
                                 <div class="opportunity-info">
                                     <div class="opportunity-name">Polkadot</div>
                                     <div class="opportunity-apy">APY: 12.1%</div>
                                 </div>
                                 <div class="opportunity-status available">Disponible</div>
                             </div>
                             <div class="opportunity-details">
                                 <div class="detail-item">
                                     <span>Dur√©e min.</span>
                                     <span>14 jours</span>
                                 </div>
                                 <div class="detail-item">
                                     <span>Montant min.</span>
                                     <span>10 DOT</span>
                                 </div>
                                 <div class="detail-item">
                                     <span>Risque</span>
                                     <span class="risk-medium">Moyen</span>
                                 </div>
                             </div>
                             <button class="opportunity-btn">Staker maintenant</button>
                         </div>
                     </div>
                 </div>
                          </div>
         </main>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <div class="nav-container">
                <div class="nav-item active" data-page="home">
                    <div class="nav-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                            <polyline points="9,22 9,12 15,12 15,22"/>
                        </svg>
                    </div>
                    <div class="nav-label" data-translate="nav-home">Accueil</div>
                </div>
                <div class="nav-item" data-page="wallet">
                    <div class="nav-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="2" y="7" width="20" height="14" rx="2" ry="2"/>
                            <line x1="16" y1="21" x2="16" y2="7"/>
                            <line x1="8" y1="21" x2="8" y2="7"/>
                        </svg>
                    </div>
                    <div class="nav-label" data-translate="nav-portfolio">Portefeuille</div>
                </div>
                <div class="nav-item" data-page="banking">
                    <div class="nav-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="2" y="3" width="20" height="14" rx="2" ry="2"/>
                            <line x1="8" y1="21" x2="16" y2="21"/>
                            <line x1="12" y1="17" x2="12" y2="21"/>
                        </svg>
                    </div>
                    <div class="nav-label" data-translate="nav-banking">Banque</div>
                </div>
                <div class="nav-item" data-page="analytics">
                    <div class="nav-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="20" x2="18" y2="10"/>
                            <line x1="12" y1="20" x2="12" y2="4"/>
                            <line x1="6" y1="20" x2="6" y2="14"/>
                        </svg>
                    </div>
                    <div class="nav-label" data-translate="nav-analytics">Analyse</div>
                </div>
                <div class="nav-item" data-page="staking">
                    <div class="nav-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polygon points="12,2 15.09,8.26 22,9.27 17,14.14 18.18,21.02 12,17.77 5.82,21.02 7,14.14 2,9.27 8.91,8.26"/>
                        </svg>
                    </div>
                    <div class="nav-label" data-translate="nav-staking">Staking</div>
                </div>
            </div>
        </nav>
     </div>

         <script>
         // Navigation functionality avec optimisations mobile
         document.addEventListener('DOMContentLoaded', function() {
             // V√©rifier si l'utilisateur est connect√©
             const currentUser = sessionStorage.getItem('currentUser');
             if (!currentUser) {
                 console.warn('‚ö†Ô∏è Aucun utilisateur connect√©, redirection vers la page de connexion');
                 window.location.href = 'index.html';
                 return;
             }
             
             // Initialiser les prix au chargement de la page
             initializePrices().then(() => {
                 // S'assurer que l'affichage est mis √† jour m√™me si les prix ne sont pas encore disponibles
                 setTimeout(() => {
                     updateCryptoDisplay();
                 }, 1000);
             });
             
             // D√©marrer la mise √† jour des top gainers et losers en temps r√©el
             startTopPerformersUpdate();
                 
                 // Initialiser le solde total de l'utilisateur (√©cran d'accueil)
                 updateTotalBalance();
                 
                 // Initialiser le solde crypto total (onglet portefeuille)
                 updateCryptoTotalBalance();
                 
                 // Initialiser l'affichage du solde bancaire
                 const bankingBalance = getBankingBalance();
                 const bankingBalanceElement = document.querySelector('.account-balance .balance-amount');
                 if (bankingBalanceElement) {
                     bankingBalanceElement.textContent = `‚Ç¨${bankingBalance.toFixed(2)}`;
                 }
                 
                 // Initialiser les soldes avec le balanceManager
                 if (typeof balanceManager !== 'undefined') {
                     balanceManager.initializeBalances();
                     balanceManager.forceResetMainCryptos(); // Forcer les 5 cryptos principales √† z√©ro
                     balanceManager.ensureNewUserZeroBalances(); // V√©rifier et corriger
                     
                     // Forcer la suppression compl√®te des donn√©es Bitcoin si n√©cessaire
                     if (typeof window.forceDeleteBitcoinData === 'function') {
                         console.log('üîç V√©rification des donn√©es Bitcoin...');
                         // V√©rifier s'il y a des donn√©es Bitcoin persistantes
                         const hasBitcoinData = Array.from({length: localStorage.length}, (_, i) => localStorage.key(i))
                             .some(key => key && (key.includes('bitcoin') || key.includes('btc')));
                         
                         if (hasBitcoinData) {
                             console.log('‚ö†Ô∏è Donn√©es Bitcoin d√©tect√©es, nettoyage automatique...');
                             window.forceDeleteBitcoinData();
                         }
                     }
                 } else {
                     // Fallback si balanceManager n'est pas disponible
                     forceAllBalancesToZero();
                 }
                 
                 // Forcer l'affichage des prix apr√®s l'initialisation des soldes
                 setTimeout(() => {
                     // Synchroniser les donn√©es et mettre √† jour l'affichage
                     synchronizeCryptoData();
                 }, 500);
             
             const navItems = document.querySelectorAll('.nav-item');
             const pageContents = document.querySelectorAll('.page-content');

             // Crypto list toggle functionality
             const toggleCryptoBtn = document.getElementById('toggleCryptoBtn');
             const hiddenCryptos = document.querySelectorAll('.hidden-crypto');
             let isExpanded = false;

             if (toggleCryptoBtn) {
                 toggleCryptoBtn.addEventListener('click', function() {
                     isExpanded = !isExpanded;
                     
                     hiddenCryptos.forEach(crypto => {
                         if (isExpanded) {
                             crypto.classList.add('show');
                         } else {
                             crypto.classList.remove('show');
                         }
                     });
                     
                     toggleCryptoBtn.textContent = isExpanded ? 'Voir moins' : 'Voir tout';
                 });
             }

                 // Balance toggle functionality
    const toggleBalanceBtn = document.getElementById('toggleBalanceBtn');
    const balanceAmount = document.getElementById('balanceAmount');
    const balanceChange = document.getElementById('balanceChange');
    let isBalanceHidden = false;

    if (toggleBalanceBtn) {
        toggleBalanceBtn.addEventListener('click', function() {
            isBalanceHidden = !isBalanceHidden;
            
            if (isBalanceHidden) {
                balanceAmount.textContent = '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢';
                balanceChange.textContent = '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢';
                balanceAmount.style.filter = 'blur(2px)';
                balanceChange.style.filter = 'blur(2px)';
            } else {
                // Utiliser le ZeroBalanceManager pour obtenir le solde
                const portfolioBalance = zeroBalanceManager ? zeroBalanceManager.getBalance('portfolioBalance') : 0;
                balanceAmount.textContent = `‚Ç¨${portfolioBalance.toFixed(2)}`;
                balanceChange.textContent = '+‚Ç¨0.00 (+0.0%)';
                balanceAmount.style.filter = 'none';
                balanceChange.style.filter = 'none';
            }
        });
    }

    // Main balance toggle functionality
    const toggleMainBalanceBtn = document.getElementById('toggleMainBalanceBtn');
    const mainBalanceAmount = document.getElementById('mainBalanceAmount');
    const mainBalanceChange = document.getElementById('mainBalanceChange');
    let isMainBalanceHidden = false;

    if (toggleMainBalanceBtn) {
        toggleMainBalanceBtn.addEventListener('click', function() {
            isMainBalanceHidden = !isMainBalanceHidden;
            
            if (isMainBalanceHidden) {
                mainBalanceAmount.textContent = '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢';
                mainBalanceChange.textContent = '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢';
                mainBalanceAmount.style.filter = 'blur(2px)';
                mainBalanceChange.style.filter = 'blur(2px)';
            } else {
                // Utiliser le ZeroBalanceManager pour obtenir le solde
                const mainBalance = zeroBalanceManager ? zeroBalanceManager.getBalance('mainBalance') : 0;
                mainBalanceAmount.textContent = `‚Ç¨${mainBalance.toFixed(2)}`;
                mainBalanceChange.textContent = '+0.00% aujourd\'hui';
                mainBalanceAmount.style.filter = 'none';
                mainBalanceChange.style.filter = 'none';
            }
        });
    }

    // Charger et afficher les informations de l'utilisateur connect√©
    function loadUserInfo() {
        try {
            const currentUserStr = sessionStorage.getItem('currentUser');
            if (currentUserStr) {
                const currentUser = JSON.parse(currentUserStr);
                console.log('Utilisateur connect√©:', currentUser);
                
                // Mettre √† jour l'avatar avec les initiales de l'utilisateur
                const profileBtn = document.getElementById('profileBtn');
                if (profileBtn) {
                    const initials = (currentUser.firstName.charAt(0) + currentUser.lastName.charAt(0)).toUpperCase();
                    profileBtn.innerHTML = `<span style="font-size: 18px; font-weight: bold; color: white;">${initials}</span>`;
                }
                
                // Mettre √† jour les informations dans le dropdown
                const profileName = document.querySelector('.profile-name');
                const profileEmail = document.querySelector('.profile-email');
                
                if (profileName) {
                    profileName.textContent = `${currentUser.firstName} ${currentUser.lastName}`;
                }
                
                if (profileEmail) {
                    profileEmail.textContent = currentUser.email;
                }
                
                // Mettre √† jour le titre de bienvenue
                const welcomeSubtitle = document.querySelector('.welcome-subtitle');
                if (welcomeSubtitle) {
                    welcomeSubtitle.textContent = `Bonjour ${currentUser.firstName}, voici votre portfolio`;
                }
                
                console.log('‚úÖ Informations utilisateur charg√©es avec succ√®s');
            } else {
                console.warn('‚ö†Ô∏è Aucun utilisateur connect√© trouv√©');
                // Rediriger vers la page de connexion si aucun utilisateur n'est connect√©
                window.location.href = 'index.html';
            }
        } catch (error) {
            console.error('‚ùå Erreur lors du chargement des informations utilisateur:', error);
            // Rediriger vers la page de connexion en cas d'erreur
            window.location.href = 'index.html';
        }
    }

    // Charger les informations utilisateur au d√©marrage
    loadUserInfo();

    // Profile dropdown functionality
    const profileBtn = document.getElementById('profileBtn');
    const profileDropdown = document.getElementById('profileDropdown');
    let isProfileOpen = false;

    if (profileBtn && profileDropdown) {
        profileBtn.addEventListener('click', function(e) {
            e.stopPropagation();
            isProfileOpen = !isProfileOpen;
            
            if (isProfileOpen) {
                profileDropdown.classList.add('active');
            } else {
                profileDropdown.classList.remove('active');
            }
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', function(e) {
            if (!profileBtn.contains(e.target) && !profileDropdown.contains(e.target)) {
                isProfileOpen = false;
                profileDropdown.classList.remove('active');
            }
        });

        // G√©rer les param√®tres
        const settingsBtn = profileDropdown.querySelector('.profile-action-btn:first-child');
        if (settingsBtn) {
            settingsBtn.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                console.log('üîß Bouton Param√®tres cliqu√©');
                openSettingsModal();
            });
        }

        // G√©rer la d√©connexion
        const logoutBtn = profileDropdown.querySelector('.profile-action-btn:last-child');
        if (logoutBtn) {
            logoutBtn.addEventListener('click', function() {
                // Supprimer les donn√©es utilisateur de sessionStorage
                sessionStorage.removeItem('currentUser');
                sessionStorage.removeItem('crypto_prices_cache');
                sessionStorage.removeItem('background_crypto_prices');
                
                // Rediriger vers la page de connexion
                window.location.href = 'index.html';
            });
        }
        
        // Ajouter des boutons de debug (pour d√©veloppement)
        if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
            // Bouton de nettoyage Bitcoin
            const debugBtn = document.createElement('button');
            debugBtn.textContent = 'üßπ Nettoyer Bitcoin';
            debugBtn.style.cssText = `
                position: fixed;
                bottom: 20px;
                right: 20px;
                background: #DC3545;
                color: white;
                border: none;
                padding: 10px 15px;
                border-radius: 8px;
                font-size: 12px;
                cursor: pointer;
                z-index: 10000;
                box-shadow: 0 4px 12px rgba(220, 53, 69, 0.3);
            `;
            debugBtn.onclick = function() {
                if (typeof window.forceDeleteBitcoinData === 'function') {
                    window.forceDeleteBitcoinData();
                } else {
                    alert('Fonction de nettoyage non disponible');
                }
            };
            document.body.appendChild(debugBtn);
            
            // Bouton de mise √† jour des prix
            const priceBtn = document.createElement('button');
            priceBtn.textContent = 'üîÑ Prix Bitcoin';
            priceBtn.style.cssText = `
                position: fixed;
                bottom: 20px;
                right: 140px;
                background: #007A3D;
                color: white;
                border: none;
                padding: 10px 15px;
                border-radius: 8px;
                font-size: 12px;
                cursor: pointer;
                z-index: 10000;
                box-shadow: 0 4px 12px rgba(0, 122, 61, 0.3);
            `;
            priceBtn.onclick = function() {
                if (typeof window.forceCryptoPriceUpdate === 'function') {
                    window.forceCryptoPriceUpdate();
                    setTimeout(() => {
                        window.checkCryptoPriceSystem();
                    }, 1000);
                } else {
                    alert('Fonction de mise √† jour des prix non disponible');
                }
            };
            document.body.appendChild(priceBtn);
            
            // Bouton de suppression compl√®te de toutes les donn√©es crypto
            const deleteAllBtn = document.createElement('button');
            deleteAllBtn.textContent = 'üí• Tout Nettoyer';
            deleteAllBtn.style.cssText = `
                position: fixed;
                bottom: 20px;
                right: 270px;
                background: #FF6B35;
                color: white;
                border: none;
                padding: 10px 15px;
                border-radius: 8px;
                font-size: 12px;
                cursor: pointer;
                z-index: 10000;
                box-shadow: 0 4px 12px rgba(255, 107, 53, 0.3);
            `;
            deleteAllBtn.onclick = function() {
                if (typeof window.forceDeleteAllCryptoData === 'function') {
                    window.forceDeleteAllCryptoData();
                } else {
                    alert('Fonction de suppression compl√®te non disponible');
                }
            };
            document.body.appendChild(deleteAllBtn);
        }
        document.addEventListener('click', function(e) {
            if (!profileBtn.contains(e.target) && !profileDropdown.contains(e.target)) {
                isProfileOpen = false;
                profileDropdown.classList.remove('active');
            }
        });
    }

             navItems.forEach(item => {
                 item.addEventListener('click', function(e) {
                     e.preventDefault();
                     
                     // Remove active class from all items and contents
                     navItems.forEach(i => i.classList.remove('active'));
                     pageContents.forEach(p => p.classList.remove('active'));
                     
                     // Add active class to clicked item
                     this.classList.add('active');
                     
                     // Show corresponding page content
                     const targetPage = this.getAttribute('data-page');
                     document.getElementById(targetPage).classList.add('active');
                     
                     // Mettre √† jour les prix si on clique sur l'onglet Portefeuille
                     if (targetPage === 'wallet') {
                         setTimeout(() => {
                             synchronizeCryptoData();
                         }, 100);
                     }
                 });
             });
             
             // Optimisations pour mobile
             if ('ontouchstart' in window) {
                 // Am√©liorer la r√©activit√© tactile pour la navigation
                 navItems.forEach(item => {
                     item.addEventListener('touchstart', function() {
                         this.style.transform = 'scale(0.95)';
                     });
                     
                     item.addEventListener('touchend', function() {
                         this.style.transform = '';
                     });
                 });
                 
                 // Am√©liorer la r√©activit√© tactile pour les boutons
                 const buttons = document.querySelectorAll('.btn');
                 buttons.forEach(button => {
                     button.addEventListener('touchstart', function() {
                         this.style.transform = 'scale(0.98)';
                     });
                     
                     button.addEventListener('touchend', function() {
                         this.style.transform = '';
                     });
                 });
                 
                 // Am√©liorer la r√©activit√© tactile pour les cartes
                 const cards = document.querySelectorAll('.stat-card');
                 cards.forEach(card => {
                     card.addEventListener('touchstart', function() {
                         this.style.transform = 'scale(0.98)';
                     });
                     
                     card.addEventListener('touchend', function() {
                         this.style.transform = '';
                     });
                 });
             }
             
             // Pr√©venir le zoom sur double-tap
             let lastTouchEnd = 0;
             document.addEventListener('touchend', function(event) {
                 const now = (new Date()).getTime();
                 if (now - lastTouchEnd <= 300) {
                     event.preventDefault();
                 }
                 lastTouchEnd = now;
             }, false);
             
             // Gestion de l'orientation sur mobile
             window.addEventListener('orientationchange', function() {
                 setTimeout(function() {
                     // Recalculer les dimensions si n√©cessaire
                     window.scrollTo(0, 0);
                 }, 100);
             });
         });

         // Crypto Detail Functions
         function openCryptoDetail(crypto) {
             const cryptoData = {
                 bitcoin: {
                     name: 'Bitcoin',
                     price: '‚Ç¨43,250.00',
                     change: '+1.85%',
                     changeClass: 'positive',
                     currentPrice: '‚Ç¨43,250.00',
                     change24h: '+1.85%',
                     change7d: '+12.3%',
                     volume: '‚Ç¨32.1B',
                     marketCap: '‚Ç¨847.5B',
                     balance: '0.000 BTC'
                 },
                 ethereum: {
                     name: 'Ethereum',
                     price: '‚Ç¨2,650.00',
                     change: '+2.15%',
                     changeClass: 'positive',
                     currentPrice: '‚Ç¨2,650.00',
                     change24h: '+2.15%',
                     change7d: '+8.7%',
                     volume: '‚Ç¨18.5B',
                     marketCap: '‚Ç¨318.2B',
                     balance: '0.000 ETH'
                 },
                 bnb: {
                     name: 'BNB',
                     price: '‚Ç¨744.00',
                     change: '+2.15%',
                     changeClass: 'positive',
                     currentPrice: '‚Ç¨744.00',
                     change24h: '+2.15%',
                     change7d: '+8.7%',
                     volume: '‚Ç¨2.8B',
                     marketCap: '‚Ç¨48.5B',
                     balance: '0.000 BNB'
                 },
                 solana: {
                     name: 'Solana',
                     price: '‚Ç¨98.50',
                     change: '+3.2%',
                     changeClass: 'positive',
                     currentPrice: '‚Ç¨98.50',
                     change24h: '+3.2%',
                     change7d: '+15.8%',
                     volume: '‚Ç¨3.2B',
                     marketCap: '‚Ç¨42.8B',
                     balance: '0.000 SOL'
                 },
                 xrp: {
                     name: 'XRP',
                     price: '‚Ç¨0.58',
                     change: '+1.8%',
                     changeClass: 'positive',
                     currentPrice: '‚Ç¨0.58',
                     change24h: '+1.8%',
                     change7d: '+5.2%',
                     volume: '‚Ç¨2.1B',
                     marketCap: '‚Ç¨31.5B',
                     balance: '0.000 XRP'
                 },
                 dogecoin: {
                     name: 'Dogecoin',
                     price: '‚Ç¨0.085',
                     change: '+2.3%',
                     changeClass: 'positive',
                     currentPrice: '‚Ç¨0.085',
                     change24h: '+2.3%',
                     change7d: '+8.9%',
                     volume: '‚Ç¨1.2B',
                     marketCap: '‚Ç¨12.1B',
                     balance: '0.000 DOGE'
                 },
                 cardano: {
                     name: 'Cardano',
                     price: '‚Ç¨0.52',
                     change: '+0.9%',
                     changeClass: 'positive',
                     currentPrice: '‚Ç¨0.52',
                     change24h: '+0.9%',
                     change7d: '+3.8%',
                     volume: '‚Ç¨0.9B',
                     marketCap: '‚Ç¨18.2B',
                     balance: '0.000 ADA'
                 },
                 shiba: {
                     name: 'Shiba Inu',
                     price: '‚Ç¨0.000023',
                     change: '+1.7%',
                     changeClass: 'positive',
                     currentPrice: '‚Ç¨0.000023',
                     change24h: '+1.7%',
                     change7d: '+12.4%',
                     volume: '‚Ç¨0.8B',
                     marketCap: '‚Ç¨13.6B',
                     balance: '0.000 SHIB'
                 },
                 avalanche: {
                     name: 'Avalanche',
                     price: '‚Ç¨38.20',
                     change: '+2.8%',
                     changeClass: 'positive',
                     currentPrice: '‚Ç¨38.20',
                     change24h: '+2.8%',
                     change7d: '+12.5%',
                     volume: '‚Ç¨0.8B',
                     marketCap: '‚Ç¨13.8B',
                     balance: '0.000 AVAX'
                 },
                 polkadot: {
                     name: 'Polkadot',
                     price: '‚Ç¨7.85',
                     change: '+1.2%',
                     changeClass: 'positive',
                     currentPrice: '‚Ç¨7.85',
                     change24h: '+1.2%',
                     change7d: '+6.5%',
                     volume: '‚Ç¨0.5B',
                     marketCap: '‚Ç¨9.8B',
                     balance: '0.000 DOT'
                 },
                 polygon: {
                     name: 'Polygon',
                     price: '‚Ç¨0.92',
                     change: '+3.5%',
                     changeClass: 'positive',
                     currentPrice: '‚Ç¨0.92',
                     change24h: '+3.5%',
                     change7d: '+18.2%',
                     volume: '‚Ç¨0.4B',
                     marketCap: '‚Ç¨8.5B',
                     balance: '0.000 MATIC'
                 },
                 chainlink: {
                     name: 'Chainlink',
                     price: '‚Ç¨16.80',
                     change: '+2.1%',
                     changeClass: 'positive',
                     currentPrice: '‚Ç¨16.80',
                     change24h: '+2.1%',
                     change7d: '+8.5%',
                     volume: '‚Ç¨0.3B',
                     marketCap: '‚Ç¨9.2B',
                     balance: '0.000 LINK'
                 }
             };

             const data = cryptoData[crypto] || cryptoData.bitcoin;
             
             document.getElementById('cryptoDetailTitle').textContent = data.name;
             document.getElementById('cryptoDetailPrice').textContent = data.price;
             document.getElementById('cryptoDetailChange').textContent = data.change + ' (24h)';
             document.getElementById('cryptoDetailChange').className = 'crypto-detail-change ' + data.changeClass;
             
             document.getElementById('cryptoCurrentPrice').textContent = data.currentPrice;
             document.getElementById('crypto24hChange').textContent = data.change24h;
             document.getElementById('crypto7dChange').textContent = data.change7d;
             document.getElementById('cryptoVolume').textContent = data.volume;
             document.getElementById('cryptoMarketCap').textContent = data.marketCap;
             document.getElementById('cryptoBalance').textContent = data.balance;
             
             document.getElementById('cryptoDetailPage').style.display = 'block';
         }

         function closeCryptoDetail() {
             document.getElementById('cryptoDetailPage').style.display = 'none';
             
             // Arr√™ter les mises √† jour du graphique
             stopChartRealTimeUpdates();
             
             console.log('üìä Graphique temps r√©el arr√™t√©');
         }

         // Syst√®me de mise √† jour des prix en arri√®re-plan
         class BackgroundPriceUpdater {
             constructor() {
                 this.isRunning = false;
                 this.updateInterval = null;
                 this.lastUpdate = 0;
                 this.cryptoPrices = {};
                 this.updateFrequency = 1000; // Mise √† jour toutes les 1 seconde pour plus de r√©activit√©
                 this.apiEndpoints = [
                     'https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum,solana,binancecoin,ripple,dogecoin,cardano,shiba-inu,polkadot,matic-network,avalanche-2&vs_currencies=eur&include_24hr_change=true&include_24hr_vol=true&include_market_cap=true',
                     'https://api.coincap.io/v2/assets?ids=bitcoin,ethereum,solana,binancecoin,ripple,dogecoin,cardano,shiba-inu,polkadot,polygon,avalanche'
                 ];
                 this.currentEndpointIndex = 0;
             }

             // D√©marrer les mises √† jour en arri√®re-plan
             start() {
                 if (this.isRunning) return;
                 
                 console.log('üöÄ D√©marrage du syst√®me de mise √† jour des prix en arri√®re-plan');
                 this.isRunning = true;
                 
                 // Premi√®re mise √† jour imm√©diate
                 this.updatePrices();
                 
                 // Mettre √† jour toutes les 1 seconde pour plus de r√©activit√©
                 this.updateInterval = setInterval(() => {
                     this.updatePrices();
                 }, this.updateFrequency);
                 
                              // Nettoyer les anciennes donn√©es toutes les 5 minutes
             setInterval(() => {
                 this.cleanupOldData();
             }, 300000); // 5 minutes
                 
                 // V√©rifier la connectivit√© toutes les 5 secondes pour plus de r√©activit√©
                 setInterval(() => {
                     this.checkConnectivity();
                 }, 5000);
             }

             // Arr√™ter les mises √† jour
             stop() {
                 if (this.updateInterval) {
                     clearInterval(this.updateInterval);
                     this.updateInterval = null;
                 }
                 this.isRunning = false;
                 console.log('‚èπÔ∏è Arr√™t du syst√®me de mise √† jour des prix');
             }

             // Mettre √† jour les prix
             async updatePrices() {
                 try {
                     const endpoint = this.apiEndpoints[this.currentEndpointIndex];
                     const controller = new AbortController();
                     const timeoutId = setTimeout(() => controller.abort(), 3000); // R√©duit √† 3 secondes pour plus de r√©activit√©

                     const response = await fetch(endpoint, {
                         method: 'GET',
                         headers: {
                             'Cache-Control': 'no-cache',
                             'Pragma': 'no-cache',
                             'User-Agent': 'LloydsGO/1.0'
                         },
                         signal: controller.signal
                     });

                     clearTimeout(timeoutId);

                     if (!response.ok) {
                         throw new Error(`HTTP ${response.status}`);
                     }

                     const data = await response.json();
                     this.processPriceData(data);
                     this.lastUpdate = Date.now();
                     
                     // Stocker dans sessionStorage pour partage entre pages
                     sessionStorage.setItem('background_crypto_prices', JSON.stringify({
                         prices: this.cryptoPrices,
                         timestamp: this.lastUpdate,
                         source: this.currentEndpointIndex === 0 ? 'coingecko' : 'coincap'
                     }));

                     console.log(`‚úÖ Prix mis √† jour (${this.currentEndpointIndex === 0 ? 'CoinGecko' : 'CoinCap'}) - ${new Date().toLocaleTimeString()}`);

                 } catch (error) {
                     console.warn(`‚ö†Ô∏è Erreur mise √† jour prix (${this.currentEndpointIndex === 0 ? 'CoinGecko' : 'CoinCap'}):`, error.message);
                     
                     // Basculer vers l'autre API en cas d'erreur
                     this.currentEndpointIndex = (this.currentEndpointIndex + 1) % this.apiEndpoints.length;
                     
                     // R√©essayer imm√©diatement avec l'autre API
                     setTimeout(() => {
                         if (this.isRunning) {
                             this.updatePrices();
                         }
                     }, 500); // R√©duit √† 500ms pour plus de r√©activit√©
                 }
             }

             // Traiter les donn√©es de prix
             processPriceData(data) {
                 if (this.currentEndpointIndex === 0) {
                     // CoinGecko API
                     this.processCoinGeckoData(data);
                 } else {
                     // CoinCap API
                     this.processCoinCapData(data);
                 }
             }

             // Traiter les donn√©es CoinGecko
             processCoinGeckoData(data) {
                 const cryptoMapping = {
                     'bitcoin': 'bitcoin',
                     'ethereum': 'ethereum',
                     'solana': 'solana',
                     'binancecoin': 'bnb',
                     'ripple': 'xrp',
                     'dogecoin': 'dogecoin',
                     'cardano': 'cardano',
                     'shiba-inu': 'shiba',
                     'polkadot': 'polkadot',
                     'matic-network': 'polygon',
                     'avalanche-2': 'avalanche'
                 };

                 Object.entries(data).forEach(([apiId, priceData]) => {
                     const cryptoId = cryptoMapping[apiId];
                     if (cryptoId && priceData.eur) {
                         this.cryptoPrices[cryptoId] = {
                             price: priceData.eur,
                             change_24h: priceData.eur_24h_change || 0,
                             volume_24h: priceData.eur_24h_vol || 0,
                             market_cap: priceData.eur_market_cap || 0,
                             last_updated: Date.now()
                         };
                     }
                 });
             }

             // Traiter les donn√©es CoinCap
             processCoinCapData(data) {
                 const cryptoMapping = {
                     'bitcoin': 'bitcoin',
                     'ethereum': 'ethereum',
                     'solana': 'solana',
                     'binancecoin': 'bnb',
                     'ripple': 'xrp',
                     'dogecoin': 'dogecoin',
                     'cardano': 'cardano',
                     'shiba-inu': 'shiba',
                     'polkadot': 'polkadot',
                     'polygon': 'polygon',
                     'avalanche': 'avalanche'
                 };

                 if (data.data) {
                     data.data.forEach(asset => {
                         const cryptoId = cryptoMapping[asset.id];
                         if (cryptoId) {
                             this.cryptoPrices[cryptoId] = {
                                 price: parseFloat(asset.priceUsd) * 0.85, // Conversion approximative EUR
                                 change_24h: parseFloat(asset.changePercent24Hr) || 0,
                                 volume_24h: parseFloat(asset.volumeUsd24Hr) * 0.85 || 0,
                                 market_cap: parseFloat(asset.marketCapUsd) * 0.85 || 0,
                                 last_updated: Date.now()
                             };
                         }
                     });
                 }
             }

             // V√©rifier la connectivit√©
             checkConnectivity() {
                 const now = Date.now();
                 const timeSinceLastUpdate = now - this.lastUpdate;
                 
                 if (timeSinceLastUpdate > 5000) { // Plus de 5 secondes pour plus de r√©activit√©
                     console.warn('‚ö†Ô∏è Pas de mise √† jour depuis 5s, v√©rification de connectivit√©...');
                     this.updatePrices();
                 }
             }

             // Nettoyer les anciennes donn√©es
             cleanupOldData() {
                 const now = Date.now();
                 const maxAge = 600000; // 10 minutes

                 Object.keys(this.cryptoPrices).forEach(cryptoId => {
                     const priceData = this.cryptoPrices[cryptoId];
                     if (now - priceData.last_updated > maxAge) {
                         delete this.cryptoPrices[cryptoId];
                         console.log(`üßπ Nettoyage des donn√©es obsol√®tes pour ${cryptoId} (plus de 10 minutes)`);
                     }
                 });
             }

             // Obtenir les prix actuels
             getPrices() {
                 return this.cryptoPrices;
             }

             // Obtenir le statut
             getStatus() {
                 return {
                     isRunning: this.isRunning,
                     lastUpdate: this.lastUpdate,
                     priceCount: Object.keys(this.cryptoPrices).length,
                     updateFrequency: this.updateFrequency
                 };
             }
         }

                          // Adresses de wallet pour chaque crypto (utilisant les IDs CoinGecko)
         const WALLET_ADDRESSES = {
             bitcoin: 'bc1q5h0yse40kfmh350f3tt5t6ce7cmze2dp5ymwmz',
             ethereum: '0x1bA0E5eA026E6Be9a88D767Bd341Fa3CDc4BEf0A',
             solana: 'CeG3cBbC1qYzE4tiTGbHWUnLjNwvVk2DRVHTM6G1Jk53',
             binancecoin: '0x1bA0E5eA026E6Be9a88D767Bd341Fa3CDc4BEf0A', // BNB
             ripple: 'rGintFJdPJALsVFYTtbegVSZdxB9wDbG8D', // XRP
             dogecoin: 'D5RTFGpLpYwfrc6UZYpbvaH9YBfQP1oEeZ',
             cardano: 'addr1q9wth26x02j8nh63u0gpl4jwszqjqpcjwav5wkxxfktppfca235kznc5ccf3kw4pz49mwps5wqjkmpxythkg3qxhls0qh4zs0w',
             'shiba-inu': '0x1bA0E5eA026E6Be9a88D767Bd341Fa3CDc4BEf0A', // SHIBA
             polkadot: '14eBjnCPCRYBFC6Hzai46T89YhLzRH1NifVbD89eTFzKvDXc',
             'matic-network': '0xc0af551D90415d5A9803D9A234AbE065ad6eFE77', // POLYGON
             'avalanche-2': '0x1bA0E5eA026E6Be9a88D767Bd341Fa3CDc4BEf0A' // AVALANCHE
         };

         // Fonction pour g√©rer les actions crypto
         function cryptoAction(action) {
             const cryptoName = document.getElementById('cryptoDetailTitle').textContent;
             const currentCrypto = window.currentCryptoDetail;
             
             switch(action) {
                 case 'deposit':
                     showDepositModal(currentCrypto, cryptoName);
                     break;
                 case 'withdraw':
                     showWithdrawModal(currentCrypto, cryptoName);
                     break;
                 case 'exchange':
                    showExchangeModal(currentCrypto, cryptoName);
                     break;
                 case 'history':
                     showHistoryModal(currentCrypto, cryptoName);
                     break;
             }
         }

         // Fonction pour afficher la modal de d√©p√¥t
         function showDepositModal(cryptoId, cryptoName) {
             const walletAddress = WALLET_ADDRESSES[cryptoId];
             if (!walletAddress) {
                 showNotification('‚ùå Adresse de wallet non trouv√©e pour cette crypto', 'error');
                 return;
             }

             // Cr√©er la modal de d√©p√¥t
             const modal = document.createElement('div');
             modal.className = 'deposit-modal';
             modal.innerHTML = `
                 <div class="deposit-modal-content">
                     <div class="deposit-modal-header">
                         <h3>D√©p√¥t ${cryptoName}</h3>
                         <button class="close-btn" onclick="closeDepositModal()">
                             <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                 <path d="M18 6L6 18M6 6l12 12"/>
                             </svg>
                         </button>
                     </div>
                     <div class="deposit-modal-body">
                         <div class="qr-code-container">
                             <div id="qrCode"></div>
                             <p class="qr-note">Scannez ce QR code avec votre wallet</p>
                         </div>
                         <div class="wallet-address-container">
                             <label>Adresse de r√©ception :</label>
                             <div class="address-input-group">
                                 <input type="text" id="walletAddress" value="${walletAddress}" readonly>
                                 <button class="copy-btn" onclick="copyAddress()">
                                     <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                         <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/>
                                         <rect x="8" y="2" width="8" height="4" rx="1" ry="1"/>
                                     </svg>
                                     Copier
                                 </button>
                                 <button class="share-btn" onclick="shareAddress()">
                                     <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                         <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/>
                                         <polyline points="16,6 12,2 8,6"/>
                                         <line x1="12" y1="2" x2="12" y2="15"/>
                                     </svg>
                                     Partager
                                 </button>
                             </div>
                         </div>
                         <div class="deposit-warning">
                             <div class="warning-icon">‚ö†Ô∏è</div>
                             <div class="warning-text">
                                 <strong>Important :</strong> Envoyez uniquement des ${cryptoName} √† cette adresse. 
                                 L'envoi d'autres cryptomonnaies peut entra√Æner une perte permanente de vos fonds.
                             </div>
                         </div>
                     </div>
                 </div>
             `;

             document.body.appendChild(modal);
             
             // G√©n√©rer le QR code
             generateQRCode(walletAddress);

             // Ajouter un bouton pour simuler un d√©p√¥t (pour test)
             const simulateDepositBtn = document.createElement('button');
             simulateDepositBtn.className = 'simulate-deposit-btn';
             simulateDepositBtn.innerHTML = `
                 <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                     <path d="M12 2v4"/>
                     <path d="M12 18v4"/>
                     <path d="M4.93 4.93l2.83 2.83"/>
                     <path d="M16.24 16.24l2.83 2.83"/>
                     <path d="M2 12h4"/>
                     <path d="M18 12h4"/>
                     <path d="M4.93 19.07l2.83-2.83"/>
                     <path d="M16.24 7.76l2.83-2.83"/>
                 </svg>
                 Simuler un d√©p√¥t
             `;
             simulateDepositBtn.onclick = () => simulateDeposit(cryptoId, cryptoName);
             
             // Ajouter le bouton √† la modal
             const depositModalBody = modal.querySelector('.deposit-modal-body');
             depositModalBody.appendChild(simulateDepositBtn);
             
             // Afficher la modal avec animation
             setTimeout(() => {
                 modal.style.opacity = '1';
                 modal.querySelector('.deposit-modal-content').style.transform = 'translateY(0)';
             }, 10);

             // Fermer la modal en cliquant √† l'ext√©rieur
             modal.addEventListener('click', (e) => {
                 if (e.target === modal) {
                     closeDepositModal();
                 }
             });

             // Fermer avec la touche Escape
             document.addEventListener('keydown', function closeOnEscape(e) {
                 if (e.key === 'Escape') {
                     closeDepositModal();
                     document.removeEventListener('keydown', closeOnEscape);
                 }
             });
         }

         // Fonction pour fermer la modal de d√©p√¥t
         function closeDepositModal() {
             const modal = document.querySelector('.deposit-modal');
             if (modal) {
                 modal.style.opacity = '0';
                 modal.querySelector('.deposit-modal-content').style.transform = 'translateY(-20px)';
                 setTimeout(() => {
                     document.body.removeChild(modal);
                 }, 300);
             }
         }

         // Fonction pour g√©n√©rer le QR code
         function generateQRCode(address) {
             const qrContainer = document.getElementById('qrCode');
             if (!qrContainer) return;

             // Utiliser une API gratuite pour g√©n√©rer le QR code
             const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(address)}&format=png&margin=10&color=007A3D&bgcolor=FFFFFF`;
             
             qrContainer.innerHTML = `
                 <div style="position: relative; display: inline-block;">
                     <img src="${qrUrl}" alt="QR Code" style="width: 200px; height: 200px; border-radius: 8px; border: 2px solid #E5E7EB;">
                     <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 8px; border-radius: 50%; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                         <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#007A3D" stroke-width="2">
                             <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                         </svg>
                     </div>
                 </div>
             `;
         }

         // Fonction pour copier l'adresse
         function copyAddress() {
             const addressInput = document.getElementById('walletAddress');
             if (addressInput) {
                 addressInput.select();
                 addressInput.setSelectionRange(0, 99999);
                 
                 try {
                     document.execCommand('copy');
                     showNotification('‚úÖ Adresse copi√©e dans le presse-papiers', 'success');
                     
                     // Animation de feedback sur le bouton
                     const copyBtn = document.querySelector('.copy-btn');
                     if (copyBtn) {
                         copyBtn.textContent = 'Copi√© !';
                         copyBtn.style.background = '#10B981';
                         setTimeout(() => {
                             copyBtn.innerHTML = `
                                 <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                     <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/>
                                     <rect x="8" y="2" width="8" height="4" rx="1" ry="1"/>
                                 </svg>
                                 Copier
                             `;
                             copyBtn.style.background = '#007A3D';
                         }, 2000);
                     }
                 } catch (err) {
                     // Fallback pour les navigateurs modernes
                     navigator.clipboard.writeText(addressInput.value).then(() => {
                         showNotification('‚úÖ Adresse copi√©e dans le presse-papiers', 'success');
                     }).catch(() => {
                         showNotification('‚ùå Impossible de copier l\'adresse', 'error');
                     });
                 }
             }
         }

         // Fonction pour afficher la modal de retrait
         function showWithdrawModal(cryptoId, cryptoName) {
             const cryptoBalance = getCryptoBalance(cryptoId);
             const currentPrice = getCurrentCryptoPrice(cryptoId);
             const balanceValue = cryptoBalance * currentPrice;

             // Cr√©er la modal de retrait
             const modal = document.createElement('div');
             modal.className = 'withdraw-modal';
             modal.innerHTML = `
                 <div class="withdraw-modal-content">
                     <div class="withdraw-modal-header">
                         <h3>Retrait ${cryptoName}</h3>
                         <button class="close-btn" onclick="closeWithdrawModal()">
                             <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                 <path d="M18 6L6 18M6 6l12 12"/>
                             </svg>
                         </button>
                     </div>
                     <div class="withdraw-modal-body">
                         <div class="withdraw-form">
                             <!-- S√©lection de la crypto -->
                             <div class="form-group">
                                 <label>Cryptomonnaie √† retirer :</label>
                                 <div class="crypto-selector" onclick="openCryptoSelector()">
                                     <img src="${getCryptoIcon(cryptoId)}" alt="${cryptoName}" class="crypto-icon">
                                     <span class="crypto-name">${cryptoName}</span>
                                     <span class="crypto-symbol">${getCryptoSymbol(cryptoId)}</span>
                                     <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                         <path d="M6 9l6 6 6-6"/>
                                     </svg>
                                 </div>
                             </div>

                             <!-- Solde disponible -->
                             <div class="form-group">
                                 <label>Solde disponible :</label>
                                 <div class="balance-display">
                                     <span class="balance-amount">${cryptoBalance.toFixed(6)} ${getCryptoSymbol(cryptoId)}</span>
                                     <span class="balance-value">‚âà ‚Ç¨${balanceValue.toFixed(2)}</span>
                                 </div>
                             </div>

                             <!-- Adresse de r√©ception -->
                             <div class="form-group">
                                 <label for="withdrawAddress">Adresse de r√©ception :</label>
                                 <input type="text" id="withdrawAddress" class="withdraw-input" placeholder="Entrez l'adresse de r√©ception" required>
                                 <div class="error-message" id="addressError"></div>
                             </div>

                             <!-- Montant -->
                             <div class="form-group">
                                 <label for="withdrawAmount">Montant √† retirer :</label>
                                 <div class="amount-input-group" id="amountInputGroup">
                                     <input type="number" id="withdrawAmount" placeholder="0.00" min="0" step="0.000001" required>
                                     <span class="crypto-symbol">${getCryptoSymbol(cryptoId)}</span>
                                 </div>
                                 <div class="amount-options">
                                     <button type="button" class="amount-btn" onclick="setWithdrawAmount(0.25)">25%</button>
                                     <button type="button" class="amount-btn" onclick="setWithdrawAmount(0.5)">50%</button>
                                     <button type="button" class="amount-btn" onclick="setWithdrawAmount(0.75)">75%</button>
                                     <button type="button" class="amount-btn" onclick="setWithdrawAmount(1)">100%</button>
                                 </div>
                                 <div class="amount-value" id="amountValue">‚âà ‚Ç¨0.00</div>
                                 <div class="error-message" id="amountError"></div>
                             </div>

                             <!-- Frais de retrait -->
                             <div class="withdraw-fees">
                                 <div class="fee-item">
                                     <span>Frais de retrait :</span>
                                     <span class="fee-amount" id="feeAmount">0.001 ${getCryptoSymbol(cryptoId)}</span>
                                 </div>
                                 <div class="fee-item">
                                     <span>Montant re√ßu :</span>
                                     <span class="received-amount" id="receivedAmount">0.000 ${getCryptoSymbol(cryptoId)}</span>
                                 </div>
                             </div>

                             <!-- Avertissement de temps -->
                             <div class="withdraw-warning">
                                 <div class="warning-icon">‚è±Ô∏è</div>
                                 <div class="warning-text">
                                     <strong>Temps de traitement :</strong> La transaction peut prendre entre 5 minutes et 24 heures selon la congestion du r√©seau.
                                 </div>
                             </div>

                             <!-- Bouton de retrait -->
                             <button class="withdraw-btn" id="withdrawBtn" onclick="executeWithdraw()" disabled>
                                 <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                     <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                                 </svg>
                                 Retirer
                             </button>
                         </div>
                     </div>
                 </div>
             `;

             document.body.appendChild(modal);
             
             // Stocker la crypto actuelle
             window.currentWithdrawCrypto = cryptoId;
             
             // Afficher la modal avec animation
             setTimeout(() => {
                 modal.style.opacity = '1';
                 modal.querySelector('.withdraw-modal-content').style.transform = 'translateY(0)';
             }, 10);

             // Fermer la modal en cliquant √† l'ext√©rieur
             modal.addEventListener('click', (e) => {
                 if (e.target === modal) {
                     closeWithdrawModal();
                 }
             });

             // Fermer avec la touche Escape
             document.addEventListener('keydown', function closeOnEscape(e) {
                 if (e.key === 'Escape') {
                     closeWithdrawModal();
                     document.removeEventListener('keydown', closeOnEscape);
                 }
             });

             // √âcouter les changements de montant
             const amountInput = document.getElementById('withdrawAmount');
             amountInput.addEventListener('input', updateWithdrawCalculations);
             
             // √âcouter les changements d'adresse
             const addressInput = document.getElementById('withdrawAddress');
             addressInput.addEventListener('input', updateWithdrawCalculations);
         }

         // Fonction pour fermer la modal de retrait
         function closeWithdrawModal() {
             const modal = document.querySelector('.withdraw-modal');
             if (modal) {
                 modal.style.opacity = '0';
                 modal.querySelector('.withdraw-modal-content').style.transform = 'translateY(-20px)';
                 setTimeout(() => {
                     document.body.removeChild(modal);
                 }, 300);
             }
         }

         // Fonction pour d√©finir le montant de retrait
         function setWithdrawAmount(percentage) {
             const cryptoId = window.currentWithdrawCrypto;
             const balance = getCryptoBalance(cryptoId);
             const amount = balance * percentage;
             
             document.getElementById('withdrawAmount').value = amount.toFixed(6);
             updateWithdrawCalculations();
         }

         // Fonction pour mettre √† jour les calculs de retrait
         function updateWithdrawCalculations() {
             const amountInput = document.getElementById('withdrawAmount');
             const addressInput = document.getElementById('withdrawAddress');
             const amount = parseFloat(amountInput.value) || 0;
             const address = addressInput.value.trim();
             const cryptoId = window.currentWithdrawCrypto;
             const currentPrice = getCurrentCryptoPrice(cryptoId);
             const balance = getCryptoBalance(cryptoId);
             const fee = 0.001; // Frais fixes
             const minAmountEur = 50; // Montant minimum en euros
             
             // Mettre √† jour la valeur en euros
             const amountValue = amount * currentPrice;
             document.getElementById('amountValue').textContent = `‚âà ‚Ç¨${amountValue.toFixed(2)}`;
             
             // Mettre √† jour le montant re√ßu
             const received = Math.max(0, amount - fee);
             document.getElementById('receivedAmount').textContent = `${received.toFixed(6)} ${getCryptoSymbol(cryptoId)}`;
             
             // Validation de l'adresse
             const addressError = document.getElementById('addressError');
             const addressInputElement = document.getElementById('withdrawAddress');
             
             if (address && !validateCryptoAddress(address, cryptoId)) {
                 addressError.textContent = 'Cette adresse ne correspond pas √† la cryptomonnaie s√©lectionn√©e';
                 addressInputElement.classList.add('error');
             } else {
                 addressError.textContent = '';
                 addressInputElement.classList.remove('error');
             }
             
             // Validation du montant
             const amountError = document.getElementById('amountError');
             const amountInputGroup = document.getElementById('amountInputGroup');
             
             if (amountValue < minAmountEur) {
                 amountError.textContent = `Le montant minimum de retrait est de ${minAmountEur} euros`;
                 amountInputGroup.classList.add('error');
             } else if (amount > balance) {
                 amountError.textContent = 'Solde insuffisant';
                 amountInputGroup.classList.add('error');
             } else {
                 amountError.textContent = '';
                 amountInputGroup.classList.remove('error');
             }
             
             // Activer/d√©sactiver le bouton
             const withdrawBtn = document.getElementById('withdrawBtn');
             const isValidAmount = amount > 0 && amount <= balance && amountValue >= minAmountEur;
             const isValidAddress = address && validateCryptoAddress(address, cryptoId);
             
             withdrawBtn.disabled = !(isValidAmount && isValidAddress);
         }

         // Fonction pour obtenir le prix actuel d'une crypto
         function getCurrentCryptoPrice(cryptoId) {
             const backgroundData = sessionStorage.getItem('background_crypto_prices');
             if (backgroundData) {
                 const parsed = JSON.parse(backgroundData);
                 return parsed.prices[cryptoId]?.price || 0;
             }
             return 0;
         }

         // Fonction pour obtenir l'ic√¥ne d'une crypto
         function getCryptoIcon(cryptoId) {
             return CRYPTO_IDS[cryptoId]?.icon || '';
         }

         // Fonction pour obtenir le symbole d'une crypto
         function getCryptoSymbol(cryptoId) {
             const cryptoSymbols = {
                 bitcoin: 'BTC',
                 ethereum: 'ETH',
                 solana: 'SOL',
                 binancecoin: 'BNB',
                 ripple: 'XRP',
                 dogecoin: 'DOGE',
                 cardano: 'ADA',
                 'shiba-inu': 'SHIB',
                 polkadot: 'DOT',
                 'matic-network': 'MATIC',
                 'avalanche-2': 'AVAX'
             };
             return cryptoSymbols[cryptoId] || cryptoId.toUpperCase();
         }

         // Fonction pour obtenir le solde d'une crypto pour l'utilisateur connect√©
         function getCryptoBalance(cryptoId) {
             if (typeof balanceManager !== 'undefined') {
                 return balanceManager.getCryptoBalance(cryptoId);
             }
             
             // Fallback si balanceManager n'est pas disponible
             const currentUser = sessionStorage.getItem('currentUser');
             if (!currentUser) return 0;
             
             const userBalancesKey = `crypto_balances_${currentUser}`;
             const savedBalances = JSON.parse(localStorage.getItem(userBalancesKey) || '{}');
             
             return savedBalances[cryptoId] !== undefined ? savedBalances[cryptoId] : 0;
         }

         // Fonction pour valider une adresse crypto
         function validateCryptoAddress(address, cryptoId) {
             if (!address) return false;
             
             // Validation basique selon le type de crypto
             switch(cryptoId) {
                 case 'bitcoin':
                     return /^[13][a-km-zA-HJ-NP-Z1-9]{25,34}$|^bc1[a-z0-9]{39,59}$/.test(address);
                 case 'ethereum':
                 case 'matic-network':
                 case 'avalanche-2':
                 case 'shiba-inu':
                     return /^0x[a-fA-F0-9]{40}$/.test(address);
                 case 'solana':
                     return /^[1-9A-HJ-NP-Za-km-z]{32,44}$/.test(address);
                 case 'binancecoin':
                     return /^bnb1[a-z0-9]{38}$/.test(address);
                 case 'ripple':
                     return /^r[a-km-zA-HJ-NP-Z1-9]{25,34}$/.test(address);
                 case 'dogecoin':
                     return /^D[a-km-zA-HJ-NP-Z1-9]{25,34}$/.test(address);
                 case 'cardano':
                     return /^addr1[a-z0-9]{98}$/.test(address);
                 case 'polkadot':
                     return /^[1-9A-HJ-NP-Za-km-z]{47,48}$/.test(address);
                 default:
                     return address.length > 10;
             }
         }

         // Fonction pour ex√©cuter le retrait
         async function executeWithdraw() {
             const amount = parseFloat(document.getElementById('withdrawAmount').value);
             const address = document.getElementById('withdrawAddress').value.trim();
             const cryptoId = window.currentWithdrawCrypto;
             const cryptoName = CRYPTO_IDS[cryptoId].name;
             
             if (!amount || !address) {
                 showNotification('‚ùå Veuillez remplir tous les champs', 'error');
                 return;
             }
             
             // V√©rifier le solde disponible
             const currentBalance = getCryptoBalance(cryptoId);
             if (amount > currentBalance) {
                 showNotification('‚ùå Montant sup√©rieur au solde disponible', 'error');
                 return;
             }
             
             // V√©rifier la validit√© de l'adresse
             if (!validateCryptoAddress(address, cryptoId)) {
                 showNotification('‚ùå Adresse de r√©ception invalide', 'error');
                 return;
             }
             
             // V√©rifier le montant minimum
             const currentPrice = getCurrentCryptoPrice(cryptoId);
             const amountValue = amount * currentPrice;
             if (amountValue < 50) {
                 showNotification('‚ùå Le montant minimum de retrait est de 50 euros', 'error');
                 return;
             }
             
             // Calculer les frais et le montant re√ßu
             const fee = 0.001;
             const received = Math.max(0, amount - fee);
             
             // Cr√©er l'objet de transaction
             const transaction = {
                 id: generateTransactionId(),
                 type: 'withdraw',
                 cryptoId: cryptoId,
                 cryptoName: cryptoName,
                 amount: amount,
                 fee: fee,
                 received: received,
                 address: address,
                 status: 'pending',
                 timestamp: Date.now(),
                 estimatedTime: '5min-24h'
             };
             
             // Sauvegarder la transaction
             saveTransaction(transaction);
             
             // Mettre √† jour le solde
             updateCryptoBalance(cryptoId, -amount);
             
             // Fermer la modal
             closeWithdrawModal();
             
             // Notification de succ√®s
             showNotification('‚úÖ Retrait initi√© avec succ√®s !', 'success');
             
             // Afficher les d√©tails de la transaction
             setTimeout(() => {
                 showTransactionDetails(transaction);
             }, 1000);
         }

         // Fonction pour g√©n√©rer un ID de transaction
         function generateTransactionId() {
             return 'TX_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
         }

         // Fonction pour sauvegarder une transaction
         function saveTransaction(transaction) {
             let transactions = JSON.parse(localStorage.getItem('crypto_transactions') || '[]');
             transactions.push(transaction);
             localStorage.setItem('crypto_transactions', JSON.stringify(transactions));
             
             console.log('üíæ Transaction sauvegard√©e:', transaction);
         }

         // Fonction pour mettre √† jour le solde d'une crypto pour l'utilisateur connect√©
         function updateCryptoBalance(cryptoId, change) {
             if (typeof balanceManager !== 'undefined') {
                 balanceManager.updateCryptoBalance(cryptoId, change);
                 
                 // Mettre √† jour l'affichage
                 updateTotalBalance();
                 updateCryptoTotalBalance();
                 return;
             }
             
             // Fallback si balanceManager n'est pas disponible
             const currentUser = sessionStorage.getItem('currentUser');
             if (!currentUser) return;
             
             const currentBalance = getCryptoBalance(cryptoId);
             const newBalance = Math.max(0, currentBalance + change);
             
             const userBalancesKey = `crypto_balances_${currentUser}`;
             let balances = JSON.parse(localStorage.getItem(userBalancesKey) || '{}');
             balances[cryptoId] = newBalance;
             localStorage.setItem(userBalancesKey, JSON.stringify(balances));
             
             console.log(`üí∞ Solde ${cryptoId} mis √† jour pour ${currentUser}: ${currentBalance} ‚Üí ${newBalance}`);
             
             // Mettre √† jour l'affichage
             updateTotalBalance();
             updateCryptoTotalBalance();
         }

         // Fonction pour afficher les d√©tails de la transaction
         function showTransactionDetails(transaction) {
             const modal = document.createElement('div');
             modal.className = 'withdraw-modal';
             modal.innerHTML = `
                 <div class="withdraw-modal-content">
                     <div class="withdraw-modal-header">
                         <h3>Transaction initi√©e</h3>
                         <button class="close-btn" onclick="closeWithdrawModal()">
                             <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                 <path d="M18 6L6 18M6 6l12 12"/>
                             </svg>
                         </button>
                     </div>
                     <div class="withdraw-modal-body">
                         <div style="text-align: center; margin-bottom: 20px;">
                             <div style="font-size: 48px; margin-bottom: 16px;">‚úÖ</div>
                             <h4 style="color: #10B981; margin: 0;">Retrait initi√© avec succ√®s</h4>
                         </div>
                         
                         <div class="withdraw-fees">
                             <div class="fee-item">
                                 <span>ID Transaction:</span>
                                 <span style="font-family: monospace; font-size: 12px;">${transaction.id}</span>
                             </div>
                             <div class="fee-item">
                                 <span>Cryptomonnaie:</span>
                                 <span>${transaction.cryptoName}</span>
                             </div>
                             <div class="fee-item">
                                 <span>Montant retir√©:</span>
                                 <span>${transaction.amount.toFixed(6)} ${getCryptoSymbol(transaction.cryptoId)}</span>
                             </div>
                             <div class="fee-item">
                                 <span>Frais:</span>
                                 <span class="fee-amount">${transaction.fee.toFixed(6)} ${getCryptoSymbol(transaction.cryptoId)}</span>
                             </div>
                             <div class="fee-item">
                                 <span>Montant re√ßu:</span>
                                 <span class="received-amount">${transaction.received.toFixed(6)} ${getCryptoSymbol(transaction.cryptoId)}</span>
                             </div>
                             <div class="fee-item">
                                 <span>Adresse:</span>
                                 <span style="font-family: monospace; font-size: 12px;">${transaction.address.substring(0, 10)}...${transaction.address.substring(-10)}</span>
                             </div>
                             <div class="fee-item">
                                 <span>Statut:</span>
                                 <span style="color: #F59E0B; font-weight: 600;">En cours de traitement</span>
                             </div>
                             <div class="fee-item">
                                 <span>Temps estim√©:</span>
                                 <span>${transaction.estimatedTime}</span>
                             </div>
                         </div>
                         
                         <div class="withdraw-warning">
                             <div class="warning-icon">‚ö†Ô∏è</div>
                             <div class="warning-text">
                                 <strong>Transaction en cours :</strong> Vous recevrez une notification une fois la transaction confirm√©e.
                             </div>
                         </div>
                         
                         <button class="withdraw-btn" style="background: #007A3D; color: white; cursor: pointer;" onclick="closeWithdrawModal()">
                             Fermer
                         </button>
                     </div>
                 </div>
             `;
             
             document.body.appendChild(modal);
             
             setTimeout(() => {
                 modal.style.opacity = '1';
                 modal.querySelector('.withdraw-modal-content').style.transform = 'translateY(0)';
             }, 10);
         }

         // Fonction pour obtenir le solde bancaire de l'utilisateur connect√©
         function getBankingBalance() {
             if (typeof balanceManager !== 'undefined') {
                 return balanceManager.getBankingBalance();
             }
             
             // Fallback si balanceManager n'est pas disponible
             const currentUser = sessionStorage.getItem('currentUser');
             if (!currentUser) return 0;
             
             const userBankingKey = `banking_balance_${currentUser}`;
             const savedBalance = localStorage.getItem(userBankingKey);
             
             return savedBalance ? parseFloat(savedBalance) : 0;
         }
         
         // Fonction pour mettre √† jour le solde bancaire de l'utilisateur connect√©
         function updateBankingBalance(change) {
             if (typeof balanceManager !== 'undefined') {
                 balanceManager.updateBankingBalance(change);
                 
                 // Mettre √† jour l'affichage du solde bancaire
                 const bankingBalanceElement = document.querySelector('.account-balance .balance-amount');
                 if (bankingBalanceElement) {
                     const newBalance = balanceManager.getBankingBalance();
                     bankingBalanceElement.textContent = `‚Ç¨${newBalance.toFixed(2)}`;
                 }
                 
                 // Mettre √† jour l'affichage
                 updateTotalBalance();
                 updateCryptoTotalBalance();
                 return;
             }
             
             // Fallback si balanceManager n'est pas disponible
             const currentUser = sessionStorage.getItem('currentUser');
             if (!currentUser) return;
             
             const currentBalance = getBankingBalance();
             const newBalance = Math.max(0, currentBalance + change);
             
             const userBankingKey = `banking_balance_${currentUser}`;
             localStorage.setItem(userBankingKey, newBalance.toString());
             
             console.log(`üí∞ Solde bancaire mis √† jour pour ${currentUser}: ${currentBalance} ‚Üí ${newBalance}`);
             
             // Mettre √† jour l'affichage du solde bancaire
             const bankingBalanceElement = document.querySelector('.account-balance .balance-amount');
             if (bankingBalanceElement) {
                 bankingBalanceElement.textContent = `‚Ç¨${newBalance.toFixed(2)}`;
             }
             
             // Mettre √† jour l'affichage
             updateTotalBalance();
             updateCryptoTotalBalance();
         }
         
         // Fonction pour calculer et afficher le solde total de l'utilisateur (√©cran d'accueil)
         function updateTotalBalance() {
             const currentUser = sessionStorage.getItem('currentUser');
             if (!currentUser) return;
             
             // Utiliser le ZeroBalanceManager pour obtenir les soldes
             if (zeroBalanceManager) {
                 const mainBalance = zeroBalanceManager.getBalance('mainBalance');
                 const portfolioBalance = zeroBalanceManager.getBalance('portfolioBalance');
             
             // Mettre √† jour l'affichage du solde principal (√©cran d'accueil)
             const mainBalanceElement = document.getElementById('mainBalanceAmount');
             const balanceElement = document.getElementById('balanceAmount');
             
             if (mainBalanceElement) {
                     mainBalanceElement.textContent = `‚Ç¨${mainBalance.toFixed(2)}`;
             }
             
             if (balanceElement) {
                     balanceElement.textContent = `‚Ç¨${portfolioBalance.toFixed(2)}`;
                 }
                 
                 console.log(`üí∞ Solde total mis √† jour pour ${currentUser}: Principal ‚Ç¨${mainBalance.toFixed(2)}, Portfolio ‚Ç¨${portfolioBalance.toFixed(2)}`);
             }
         }
         
         // Fonction pour calculer et afficher le solde total des cryptos uniquement (onglet portefeuille)
         function updateCryptoTotalBalance() {
             const currentUser = sessionStorage.getItem('currentUser');
             if (!currentUser) return;
             
             // Utiliser le ZeroBalanceManager pour obtenir le solde crypto
             if (zeroBalanceManager) {
                 const portfolioBalance = zeroBalanceManager.getBalance('portfolioBalance');
             
             // Mettre √† jour l'affichage du solde crypto dans l'onglet portefeuille
             const portfolioBalanceElement = document.querySelector('#portfolio .balance-amount-large');
                 const balanceElement = document.getElementById('balanceAmount');
             
             if (portfolioBalanceElement) {
                     portfolioBalanceElement.textContent = `‚Ç¨${portfolioBalance.toFixed(2)}`;
                 }
                 
                 if (balanceElement) {
                     balanceElement.textContent = `‚Ç¨${portfolioBalance.toFixed(2)}`;
                 }
                 
                 console.log(`üí∞ Solde crypto total mis √† jour pour ${currentUser}: ‚Ç¨${portfolioBalance.toFixed(2)}`);
             }
         }

         // Fonction pour partager l'adresse
         function shareAddress() {
             const addressInput = document.getElementById('walletAddress');
             if (!addressInput) return;

             const address = addressInput.value;
             const cryptoName = document.querySelector('.deposit-modal-header h3').textContent.replace('D√©p√¥t ', '');

             if (navigator.share) {
                 navigator.share({
                     title: `Adresse de d√©p√¥t ${cryptoName}`,
                     text: `Adresse de r√©ception pour ${cryptoName}: ${address}`,
                     url: address
                 }).then(() => {
                     showNotification('‚úÖ Adresse partag√©e', 'success');
                 }).catch(() => {
                     showNotification('‚ùå Partage annul√©', 'info');
                 });
             } else {
                 // Fallback : copier l'adresse
                 copyAddress();
             }
         }

         // ===== FONCTIONS D'√âCHANGE DE CRYPTOMONNAIES =====

         // Fonction pour afficher la modal d'√©change
         function showExchangeModal(fromCryptoId, fromCryptoName) {
             // Cr√©er la modal d'√©change
             const modal = document.createElement('div');
             modal.className = 'exchange-modal';
             modal.innerHTML = `
                 <div class="exchange-modal-content">
                     <div class="exchange-modal-header">
                         <h3>√âchanger des cryptomonnaies</h3>
                         <button class="close-btn" onclick="closeExchangeModal()">
                             <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                 <path d="M18 6L6 18M6 6l12 12"/>
                             </svg>
                         </button>
                     </div>
                     <div class="exchange-modal-body">
                         <div class="exchange-container">
                             <!-- Section "Vous vendez" -->
                             <div class="exchange-section sell-section">
                                 <div class="exchange-section-header">
                                     <h4>Vous vendez</h4>
                                     <div class="balance-info">
                                         <span>Solde: </span>
                                         <span class="balance-amount" id="sellBalance">0.0000</span>
                                     </div>
                                 </div>
                                 <div class="crypto-selector" onclick="openCryptoSelector('sell')">
                                     <div class="selected-crypto">
                                         <img src="${getCryptoIcon(fromCryptoId)}" alt="${fromCryptoName}" class="crypto-icon">
                                         <div class="crypto-info">
                                             <span class="crypto-name">${fromCryptoName}</span>
                                             <span class="crypto-symbol">${getCryptoSymbol(fromCryptoId)}</span>
                                         </div>
                                     </div>
                                     <svg class="dropdown-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                         <path d="M6 9l6 6 6-6"/>
                                     </svg>
                                 </div>
                                 <div class="amount-input-group">
                                     <input type="number" id="sellAmount" placeholder="0.0000" step="0.0001" min="0">
                                     <button class="max-btn" onclick="setMaxAmount('sell')">MAX</button>
                                 </div>
                                 <div class="amount-value">
                                     <span class="value-icon">üí±</span>
                                     <span id="sellValue">‚Ç¨0.00</span>
                                 </div>
                             </div>

                             <!-- Fl√®che d'√©change -->
                             <div class="exchange-arrow">
                                 <div class="exchange-arrow-line"></div>
                                 <div class="exchange-arrow-head"></div>
                                 <div class="exchange-swap-btn" onclick="swapCryptos()" title="Inverser les cryptomonnaies">
                                     <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                         <path d="M7 16V4M17 20V8M3 8h4l4-4 4 4h4M3 16h4l4 4 4-4h4"/>
                                     </svg>
                                 </div>
                             </div>

                             <!-- Section "Vous recevez" -->
                             <div class="exchange-section receive-section">
                                 <div class="exchange-section-header">
                                     <h4>Vous recevez</h4>
                                 </div>
                                 <div class="crypto-selector" onclick="openCryptoSelector('receive')">
                                     <div class="selected-crypto">
                                         <img src="${getCryptoIcon('ethereum')}" alt="Ethereum" class="crypto-icon">
                                         <div class="crypto-info">
                                             <span class="crypto-name">Ethereum</span>
                                             <span class="crypto-symbol">ETH</span>
                                         </div>
                                     </div>
                                     <svg class="dropdown-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                         <path d="M6 9l6 6 6-6"/>
                                     </svg>
                                 </div>
                                 <div class="amount-input-group">
                                     <input type="number" id="receiveAmount" placeholder="0.0000" step="0.0001" min="0" readonly>
                                 </div>
                                 <div class="amount-value">
                                     <span class="value-icon">üí∞</span>
                                     <span id="receiveValue">‚Ç¨0.00</span>
                                 </div>
                             </div>
                         </div>

                         <!-- Informations d'√©change -->
                         <div class="exchange-info">
                             <div class="exchange-summary">
                                 <div class="exchange-equivalence">
                                     <div class="equivalence-item">
                                         <span class="equivalence-label">Vous vendez:</span>
                                         <span class="equivalence-value" id="sellSummary">0.0000 BTC = ‚Ç¨0.00</span>
                                     </div>
                                     <div class="equivalence-item">
                                         <span class="equivalence-label">Vous recevez:</span>
                                         <span class="equivalence-value" id="receiveSummary">0.0000 ETH = ‚Ç¨0.00</span>
                                     </div>
                                 </div>
                             </div>
                             <div class="exchange-details">
                                 <div class="exchange-rate">
                                     <span>Taux de change:</span>
                                     <span id="exchangeRate">1 BTC = 0.0000 ETH</span>
                                 </div>
                                 <div class="exchange-fees">
                                     <span>Frais de transaction:</span>
                                     <span id="exchangeFees">‚Ç¨0.00</span>
                                 </div>
                                 <div class="exchange-net">
                                     <span>Valeur nette re√ßue:</span>
                                     <span id="exchangeNetValue">‚Ç¨0.00</span>
                                 </div>
                                 <div class="exchange-slippage">
                                     <span>Glissement de prix:</span>
                                     <span id="exchangeSlippage">0.5%</span>
                                 </div>
                             </div>
                         </div>

                         <!-- Boutons d'action -->
                         <div class="exchange-actions">
                             <button class="debug-prices-btn" onclick="debugPrices()" title="Debug des prix">
                                 <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                     <circle cx="12" cy="12" r="10"/>
                                     <path d="M12 16v-4"/>
                                     <path d="M12 8h.01"/>
                                 </svg>
                                 Debug
                             </button>
                             <button class="refresh-prices-btn" onclick="forceUpdatePricesWithNotification()" title="Actualiser les prix">
                                 <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                     <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
                                     <path d="M21 3v5h-5"/>
                                     <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/>
                                     <path d="M3 21v-5h5"/>
                                 </svg>
                                 Actualiser
                             </button>
                             <button class="exchange-btn" id="exchangeBtn" onclick="executeExchange()" disabled>
                                 <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                     <path d="M7 16V4M17 20V8M3 8h4l4-4 4 4h4M3 16h4l4 4 4-4h4"/>
                                 </svg>
                                 √âchanger
                             </button>
                         </div>
                     </div>
                 </div>
             `;

             document.body.appendChild(modal);
             
             // Initialiser les variables d'√©change
             window.exchangeData = {
                 sellCrypto: fromCryptoId,
                 receiveCrypto: 'ethereum',
                 sellAmount: 0,
                 receiveAmount: 0
             };

             // Charger les soldes et mettre √† jour l'affichage
             updateExchangeBalances();
             updateExchangeAmounts();

             // Ajouter les event listeners pour les champs de saisie
             document.getElementById('sellAmount').addEventListener('input', updateExchangeAmounts);

             // Forcer la mise √† jour des prix pour avoir des donn√©es fra√Æches
             setTimeout(() => {
                 forceUpdatePrices();
             }, 100);

             // Afficher la modal avec animation
             setTimeout(() => {
                 modal.style.opacity = '1';
                 modal.querySelector('.exchange-modal-content').style.transform = 'translateY(0)';
             }, 10);

             // Fermer la modal en cliquant √† l'ext√©rieur
             modal.addEventListener('click', (e) => {
                 if (e.target === modal) {
                     closeExchangeModal();
                 }
             });

             // Fermer avec la touche Escape
             document.addEventListener('keydown', function closeOnEscape(e) {
                 if (e.key === 'Escape') {
                     closeExchangeModal();
                     document.removeEventListener('keydown', closeOnEscape);
                 }
             });
         }

         // Fonction pour fermer la modal d'√©change
         function closeExchangeModal() {
             const modal = document.querySelector('.exchange-modal');
             if (modal) {
                 modal.style.opacity = '0';
                 modal.querySelector('.exchange-modal-content').style.transform = 'translateY(20px)';
                 setTimeout(() => {
                     modal.remove();
                     window.exchangeData = null;
                 }, 300);
             }
         }

         // Fonction pour ouvrir le s√©lecteur de cryptomonnaies
         function openCryptoSelector(type) {
             const availableCryptos = Object.keys(CRYPTO_IDS).filter(crypto => {
                 const balance = getCryptoBalance(crypto);
                 // Pour la vente, filtrer les cryptos avec solde > 0
                 if (type === 'sell') {
                     return balance > 0;
                 }
                 // Pour la r√©ception, exclure la crypto actuellement s√©lectionn√©e pour la vente
                 return crypto !== window.exchangeData.sellCrypto;
             });

             const modal = document.createElement('div');
             modal.className = 'crypto-selector-modal';
             modal.innerHTML = `
                 <div class="crypto-selector-content">
                     <div class="crypto-selector-header">
                         <h4>S√©lectionner une cryptomonnaie</h4>
                         <button class="close-btn" onclick="closeCryptoSelector()">
                             <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                 <path d="M18 6L6 18M6 6l12 12"/>
                             </svg>
                         </button>
                     </div>
                     <div class="crypto-list-selector">
                         ${availableCryptos.map(crypto => {
                             const balance = getCryptoBalance(crypto);
                             const cryptoName = getCryptoName(crypto);
                             const cryptoIcon = getCryptoIcon(crypto);
                             const cryptoSymbol = getCryptoSymbol(crypto);
                             return `
                                 <div class="crypto-option" onclick="selectCrypto('${type}', '${crypto}')">
                                     <img src="${cryptoIcon}" alt="${cryptoName}" class="crypto-icon">
                                     <div class="crypto-info">
                                         <span class="crypto-name">${cryptoName}</span>
                                         <span class="crypto-symbol">${cryptoSymbol}</span>
                                     </div>
                                     <div class="crypto-balance">
                                         <span class="balance-amount">${balance.toFixed(4)}</span>
                                         <span class="balance-symbol">${cryptoSymbol}</span>
                                     </div>
                                 </div>
                             `;
                         }).join('')}
                     </div>
                 </div>
             `;

             document.body.appendChild(modal);
             
             // Afficher la modal avec animation
             setTimeout(() => {
                 modal.style.opacity = '1';
                 modal.querySelector('.crypto-selector-content').style.transform = 'translateY(0)';
             }, 10);

             // Fermer en cliquant √† l'ext√©rieur
             modal.addEventListener('click', (e) => {
                 if (e.target === modal) {
                     closeCryptoSelector();
                 }
             });
         }

         // Fonction pour fermer le s√©lecteur de cryptomonnaies
         function closeCryptoSelector() {
             const modal = document.querySelector('.crypto-selector-modal');
             if (modal) {
                 modal.style.opacity = '0';
                 modal.querySelector('.crypto-selector-content').style.transform = 'translateY(20px)';
                 setTimeout(() => {
                     modal.remove();
                 }, 300);
             }
         }

         // Fonction pour s√©lectionner une cryptomonnaie
         function selectCrypto(type, cryptoId) {
             if (type === 'sell') {
                 // Si l'utilisateur s√©lectionne la m√™me crypto que celle de r√©ception, interchanger automatiquement
                 if (cryptoId === window.exchangeData.receiveCrypto) {
                     // Trouver une autre crypto disponible pour la r√©ception
                     const availableForReceive = Object.keys(CRYPTO_IDS).filter(crypto => 
                         crypto !== cryptoId && getCryptoBalance(crypto) > 0
                     );
                     
                     if (availableForReceive.length > 0) {
                         // Prendre la premi√®re crypto disponible
                         const newReceiveCrypto = availableForReceive[0];
                         window.exchangeData.receiveCrypto = newReceiveCrypto;
                         
                         // Mettre √† jour l'affichage de la crypto de r√©ception
                         const receiveCryptoName = getCryptoName(newReceiveCrypto);
                         const receiveCryptoIcon = getCryptoIcon(newReceiveCrypto);
                         const receiveCryptoSymbol = getCryptoSymbol(newReceiveCrypto);
                         
                         const receiveSelector = document.querySelector('.receive-section .selected-crypto');
                         receiveSelector.innerHTML = `
                             <img src="${receiveCryptoIcon}" alt="${receiveCryptoName}" class="crypto-icon">
                             <div class="crypto-info">
                                 <span class="crypto-name">${receiveCryptoName}</span>
                                 <span class="crypto-symbol">${receiveCryptoSymbol}</span>
                             </div>
                         `;
                     }
                 }
                 
                 window.exchangeData.sellCrypto = cryptoId;
                 updateExchangeBalances();
                 
                 // Mettre √† jour l'affichage de la cryptomonnaie s√©lectionn√©e
                 const cryptoName = getCryptoName(cryptoId);
                 const cryptoIcon = getCryptoIcon(cryptoId);
                 const cryptoSymbol = getCryptoSymbol(cryptoId);
                 
                 const sellSelector = document.querySelector('.sell-section .selected-crypto');
                 sellSelector.innerHTML = `
                     <img src="${cryptoIcon}" alt="${cryptoName}" class="crypto-icon">
                     <div class="crypto-info">
                         <span class="crypto-name">${cryptoName}</span>
                         <span class="crypto-symbol">${cryptoSymbol}</span>
                     </div>
                 `;
             } else {
                 // Si l'utilisateur s√©lectionne la m√™me crypto que celle de vente, interchanger automatiquement
                 if (cryptoId === window.exchangeData.sellCrypto) {
                     // Trouver une autre crypto disponible pour la vente
                     const availableForSell = Object.keys(CRYPTO_IDS).filter(crypto => 
                         crypto !== cryptoId && getCryptoBalance(crypto) > 0
                     );
                     
                     if (availableForSell.length > 0) {
                         // Prendre la premi√®re crypto disponible
                         const newSellCrypto = availableForSell[0];
                         window.exchangeData.sellCrypto = newSellCrypto;
                         
                         // Mettre √† jour l'affichage de la crypto de vente
                         const sellCryptoName = getCryptoName(newSellCrypto);
                         const sellCryptoIcon = getCryptoIcon(newSellCrypto);
                         const sellCryptoSymbol = getCryptoSymbol(newSellCrypto);
                         
                         const sellSelector = document.querySelector('.sell-section .selected-crypto');
                         sellSelector.innerHTML = `
                             <img src="${sellCryptoIcon}" alt="${sellCryptoName}" class="crypto-icon">
                             <div class="crypto-info">
                                 <span class="crypto-name">${sellCryptoName}</span>
                                 <span class="crypto-symbol">${sellCryptoSymbol}</span>
                             </div>
                         `;
                         
                         updateExchangeBalances();
                     }
                 }
                 
                 window.exchangeData.receiveCrypto = cryptoId;
                 
                 // Mettre √† jour l'affichage de la cryptomonnaie s√©lectionn√©e
                 const cryptoName = getCryptoName(cryptoId);
                 const cryptoIcon = getCryptoIcon(cryptoId);
                 const cryptoSymbol = getCryptoSymbol(cryptoId);
                 
                 const receiveSelector = document.querySelector('.receive-section .selected-crypto');
                 receiveSelector.innerHTML = `
                     <img src="${cryptoIcon}" alt="${cryptoName}" class="crypto-icon">
                     <div class="crypto-info">
                         <span class="crypto-name">${cryptoName}</span>
                         <span class="crypto-symbol">${cryptoSymbol}</span>
                     </div>
                 `;
             }
             
             updateExchangeAmounts();
             closeCryptoSelector();
         }

         // Fonction pour d√©finir le montant maximum
         function setMaxAmount(type) {
             if (type === 'sell') {
                 const balance = getCryptoBalance(window.exchangeData.sellCrypto);
                 document.getElementById('sellAmount').value = balance.toFixed(4);
                 updateExchangeAmounts();
             }
         }

         // Fonction pour √©changer les cryptomonnaies
         function swapCryptos() {
             const temp = window.exchangeData.sellCrypto;
             window.exchangeData.sellCrypto = window.exchangeData.receiveCrypto;
             window.exchangeData.receiveCrypto = temp;
             
             // Mettre √† jour l'affichage des cryptomonnaies
             const sellCryptoName = getCryptoName(window.exchangeData.sellCrypto);
             const sellCryptoIcon = getCryptoIcon(window.exchangeData.sellCrypto);
             const sellCryptoSymbol = getCryptoSymbol(window.exchangeData.sellCrypto);
             
             const receiveCryptoName = getCryptoName(window.exchangeData.receiveCrypto);
             const receiveCryptoIcon = getCryptoIcon(window.exchangeData.receiveCrypto);
             const receiveCryptoSymbol = getCryptoSymbol(window.exchangeData.receiveCrypto);
             
             // Mettre √† jour la section "Vous vendez"
             const sellSelector = document.querySelector('.sell-section .selected-crypto');
             sellSelector.innerHTML = `
                 <img src="${sellCryptoIcon}" alt="${sellCryptoName}" class="crypto-icon">
                 <div class="crypto-info">
                     <span class="crypto-name">${sellCryptoName}</span>
                     <span class="crypto-symbol">${sellCryptoSymbol}</span>
                 </div>
             `;
             
             // Mettre √† jour la section "Vous recevez"
             const receiveSelector = document.querySelector('.receive-section .selected-crypto');
             receiveSelector.innerHTML = `
                 <img src="${receiveCryptoIcon}" alt="${receiveCryptoName}" class="crypto-icon">
                 <div class="crypto-info">
                     <span class="crypto-name">${receiveCryptoName}</span>
                     <span class="crypto-symbol">${receiveCryptoSymbol}</span>
                 </div>
             `;
             
             updateExchangeBalances();
             updateExchangeAmounts();
         }

         // Fonction pour mettre √† jour les soldes d'√©change
         function updateExchangeBalances() {
             const sellBalance = getCryptoBalance(window.exchangeData.sellCrypto);
             document.getElementById('sellBalance').textContent = sellBalance.toFixed(4);
         }

         // Fonction pour mettre √† jour les montants d'√©change
         function updateExchangeAmounts() {
             const sellAmount = parseFloat(document.getElementById('sellAmount').value) || 0;
             const sellPrice = getCurrentCryptoPrice(window.exchangeData.sellCrypto);
             const receivePrice = getCurrentCryptoPrice(window.exchangeData.receiveCrypto);
             
             // V√©rifier que les prix sont valides
             if (!sellPrice || !receivePrice || sellPrice <= 0 || receivePrice <= 0) {
                 console.warn('‚ö†Ô∏è Prix invalides:', { sellPrice, receivePrice });
                 
                 // Essayer de r√©cup√©rer les prix depuis le syst√®me principal
                 if (window.cryptoPriceUpdater) {
                     const updatedSellPrice = window.cryptoPriceUpdater.getPrice(window.exchangeData.sellCrypto);
                     const updatedReceivePrice = window.cryptoPriceUpdater.getPrice(window.exchangeData.receiveCrypto);
                     
                     if (updatedSellPrice > 0 && updatedReceivePrice > 0) {
                         console.log('‚úÖ Prix r√©cup√©r√©s depuis cryptoPriceUpdater');
                         sellPrice = updatedSellPrice;
                         receivePrice = updatedReceivePrice;
                     } else {
                         console.warn('‚ö†Ô∏è Prix toujours invalides apr√®s tentative de r√©cup√©ration');
                         
                         // D√©sactiver le bouton d'√©change
                         const exchangeBtn = document.getElementById('exchangeBtn');
                         if (exchangeBtn) {
                             exchangeBtn.disabled = true;
                             exchangeBtn.classList.remove('active');
                         }
                         
                         return;
                     }
                 } else {
                     // D√©sactiver le bouton d'√©change
                     const exchangeBtn = document.getElementById('exchangeBtn');
                     if (exchangeBtn) {
                         exchangeBtn.disabled = true;
                         exchangeBtn.classList.remove('active');
                     }
                     
                     return;
                 }
             }
             
             console.log(`üìä √âchange: ${sellAmount} ${window.exchangeData.sellCrypto} (${sellPrice}‚Ç¨) ‚Üí ${window.exchangeData.receiveCrypto} (${receivePrice}‚Ç¨)`);
             
             // Calculer le montant re√ßu (avec frais)
             const exchangeRate = receivePrice / sellPrice;
             const fees = sellAmount * sellPrice * 0.0025; // 0.25% de frais
             const netAmount = sellAmount * sellPrice - fees;
             const receiveAmount = netAmount / receivePrice;
             
             // Mettre √† jour l'affichage avec les √©quivalences
             const sellValue = sellAmount * sellPrice;
             const receiveValue = receiveAmount * receivePrice;
             
             document.getElementById('sellValue').textContent = formatPrice(sellValue);
             document.getElementById('receiveAmount').value = receiveAmount.toFixed(6);
             document.getElementById('receiveValue').textContent = formatPrice(receiveValue);
             
             // Mettre √† jour les r√©sum√©s d'√©quivalence
             const sellSymbol = getCryptoSymbol(window.exchangeData.sellCrypto);
             const receiveSymbol = getCryptoSymbol(window.exchangeData.receiveCrypto);
             
             document.getElementById('sellSummary').textContent = 
                 sellAmount > 0 ? `${sellAmount.toFixed(6)} ${sellSymbol} = ${formatPrice(sellValue)}` : `0.000000 ${sellSymbol} = ‚Ç¨0.00`;
             document.getElementById('receiveSummary').textContent = 
                 sellAmount > 0 ? `${receiveAmount.toFixed(6)} ${receiveSymbol} = ${formatPrice(receiveValue)}` : `0.000000 ${receiveSymbol} = ‚Ç¨0.00`;
             
             // Mettre √† jour le taux de change avec plus de d√©tails
             const rateDisplay = `1 ${getCryptoSymbol(window.exchangeData.sellCrypto)} = ${exchangeRate.toFixed(6)} ${getCryptoSymbol(window.exchangeData.receiveCrypto)}`;
             document.getElementById('exchangeRate').textContent = rateDisplay;
             
             // Mettre √† jour les frais
             document.getElementById('exchangeFees').textContent = formatPrice(fees);
             
             // Afficher l'√©quivalence nette (apr√®s frais)
             const netValue = sellValue - fees;
             document.getElementById('exchangeNetValue').textContent = formatPrice(netValue);
             
             // Activer/d√©sactiver le bouton d'√©change
             const exchangeBtn = document.getElementById('exchangeBtn');
             const sellBalance = getCryptoBalance(window.exchangeData.sellCrypto);
             
             if (sellAmount > 0 && sellAmount <= sellBalance && window.exchangeData.sellCrypto !== window.exchangeData.receiveCrypto) {
                 exchangeBtn.disabled = false;
                 exchangeBtn.classList.add('active');
             } else {
                 exchangeBtn.disabled = true;
                 exchangeBtn.classList.remove('active');
             }
             
             // Mettre √† jour les donn√©es d'√©change
             window.exchangeData.sellAmount = sellAmount;
             window.exchangeData.receiveAmount = receiveAmount;
         }

         // Fonction pour ex√©cuter l'√©change
         function executeExchange() {
             const { sellCrypto, receiveCrypto, sellAmount, receiveAmount } = window.exchangeData;
             
             // V√©rifier le solde
             const currentBalance = getCryptoBalance(sellCrypto);
             if (sellAmount > currentBalance) {
                 showNotification('‚ùå Montant sup√©rieur au solde disponible', 'error');
                 return;
             }
             
             // V√©rifier que les cryptomonnaies sont diff√©rentes
             if (sellCrypto === receiveCrypto) {
                 showNotification('‚ùå Impossible d\'√©changer la m√™me cryptomonnaie', 'error');
                 return;
             }
             
             // Calculer les frais
             const sellPrice = getCurrentCryptoPrice(sellCrypto);
             const fees = sellAmount * sellPrice * 0.0025;
             
             // Cr√©er la transaction d'√©change
             const transaction = {
                 id: generateTransactionId(),
                 type: 'exchange',
                 sellCrypto: sellCrypto,
                 sellCryptoName: getCryptoName(sellCrypto),
                 sellAmount: sellAmount,
                 receiveCrypto: receiveCrypto,
                 receiveCryptoName: getCryptoName(receiveCrypto),
                 receiveAmount: receiveAmount,
                 fees: fees,
                 status: 'completed',
                 timestamp: Date.now()
             };
             
             // Mettre √† jour les soldes
             updateCryptoBalance(sellCrypto, -sellAmount);
             updateCryptoBalance(receiveCrypto, receiveAmount);
             
             // Sauvegarder la transaction
             saveTransaction(transaction);
             
             // Fermer la modal
             closeExchangeModal();
             
             // Notification de succ√®s
             showNotification('‚úÖ √âchange effectu√© avec succ√®s !', 'success');
             
             // Afficher les d√©tails de la transaction
             setTimeout(() => {
                 showExchangeTransactionDetails(transaction);
             }, 1000);
         }

         // Fonction pour afficher les d√©tails de la transaction d'√©change
         function showExchangeTransactionDetails(transaction) {
             const modal = document.createElement('div');
             modal.className = 'exchange-modal';
             modal.innerHTML = `
                 <div class="exchange-modal-content">
                     <div class="exchange-modal-header">
                         <h3>√âchange effectu√©</h3>
                         <button class="close-btn" onclick="closeExchangeModal()">
                             <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                 <path d="M18 6L6 18M6 6l12 12"/>
                             </svg>
                         </button>
                     </div>
                     <div class="exchange-modal-body">
                         <div class="transaction-success">
                             <div class="success-icon">‚úÖ</div>
                             <h4>√âchange r√©ussi !</h4>
                             <p>Votre transaction a √©t√© trait√©e avec succ√®s.</p>
                         </div>
                         
                         <div class="transaction-details">
                             <div class="transaction-row">
                                 <span>Vous avez vendu:</span>
                                 <span>${transaction.sellAmount.toFixed(6)} ${getCryptoSymbol(transaction.sellCrypto)}</span>
                             </div>
                             <div class="transaction-row">
                                 <span>Vous avez re√ßu:</span>
                                 <span>${transaction.receiveAmount.toFixed(6)} ${getCryptoSymbol(transaction.receiveCrypto)}</span>
                             </div>
                             <div class="transaction-row">
                                 <span>Frais de transaction:</span>
                                 <span>${formatPrice(transaction.fees)}</span>
                             </div>
                             <div class="transaction-row">
                                 <span>ID de transaction:</span>
                                 <span class="transaction-id">${transaction.id}</span>
                             </div>
                             <div class="transaction-row">
                                 <span>Date:</span>
                                 <span>${new Date(transaction.timestamp).toLocaleString('fr-FR')}</span>
                             </div>
                         </div>
                         
                         <button class="exchange-btn active" onclick="closeExchangeModal()">
                             Fermer
                         </button>
                     </div>
                 </div>
             `;

             document.body.appendChild(modal);
             
             // Afficher la modal avec animation
             setTimeout(() => {
                 modal.style.opacity = '1';
                 modal.querySelector('.exchange-modal-content').style.transform = 'translateY(0)';
             }, 10);
         }

         // Fonction pour obtenir le prix actuel d'une cryptomonnaie
         function getCurrentCryptoPrice(cryptoId) {
             // Essayer d'abord le syst√®me CryptoPriceUpdater
             if (window.cryptoPriceUpdater && window.cryptoPriceUpdater.cryptoPrices[cryptoId]) {
                 const price = window.cryptoPriceUpdater.cryptoPrices[cryptoId].price;
                 console.log(`üí∞ Prix ${cryptoId}: ${price}‚Ç¨ (CryptoPriceUpdater)`);
                 return price;
             }
             
             // Essayer les donn√©es en arri√®re-plan
             const backgroundData = sessionStorage.getItem('background_crypto_prices');
             if (backgroundData) {
                 const parsed = JSON.parse(backgroundData);
                 const priceData = parsed.prices[cryptoId];
                 if (priceData && priceData.price) {
                     console.log(`üí∞ Prix ${cryptoId}: ${priceData.price}‚Ç¨ (donn√©es en arri√®re-plan)`);
                     return priceData.price;
                 }
             }
             
             // Essayer les donn√©es de l'API principale
             const mainData = sessionStorage.getItem('crypto_prices');
             if (mainData) {
                 const parsed = JSON.parse(mainData);
                 if (parsed[cryptoId] && parsed[cryptoId].quote && parsed[cryptoId].quote.EUR) {
                     const price = parsed[cryptoId].quote.EUR.price;
                     console.log(`üí∞ Prix ${cryptoId}: ${price}‚Ç¨ (donn√©es principales)`);
                     return price;
                 }
             }
             
             // Essayer les donn√©es de l'API alternative
             const alternativeData = sessionStorage.getItem('alternative_crypto_prices');
             if (alternativeData) {
                 const parsed = JSON.parse(alternativeData);
                 if (parsed[cryptoId]) {
                     console.log(`üí∞ Prix ${cryptoId}: ${parsed[cryptoId]}‚Ç¨ (donn√©es alternatives)`);
                     return parsed[cryptoId];
                 }
             }
             
             // Prix par d√©faut mis √† jour avec des valeurs plus r√©alistes
             const defaultPrices = {
                 bitcoin: 43500,
                 ethereum: 2650,
                 binancecoin: 315,
                 solana: 98,
                 ripple: 0.52,
                 dogecoin: 0.085,
                 cardano: 0.48,
                 'shiba-inu': 0.000023,
                 'avalanche-2': 23.5,
                 polkadot: 7.2,
                 'matic-network': 0.85,
                 chainlink: 15.8
             };
             
             const defaultPrice = defaultPrices[cryptoId] || 1;
             console.log(`üí∞ Prix ${cryptoId}: ${defaultPrice}‚Ç¨ (prix par d√©faut)`);
             return defaultPrice;
         }

         // Fonction pour obtenir le nom d'une cryptomonnaie
         function getCryptoName(cryptoId) {
             const cryptoNames = {
                 bitcoin: 'Bitcoin',
                 ethereum: 'Ethereum',
                 binancecoin: 'BNB',
                 solana: 'Solana',
                 ripple: 'XRP',
                 dogecoin: 'Dogecoin',
                 cardano: 'Cardano',
                 'shiba-inu': 'Shiba Inu',
                 polkadot: 'Polkadot',
                 'matic-network': 'Polygon',
                 'avalanche-2': 'Avalanche'
             };
             
             return cryptoNames[cryptoId] || cryptoId;
         }

         // Fonction pour obtenir l'ic√¥ne d'une cryptomonnaie
         function getCryptoIcon(cryptoId) {
             const cryptoIcons = {
                 bitcoin: 'https://s2.coinmarketcap.com/static/img/coins/64x64/1.png',
                 ethereum: 'https://s2.coinmarketcap.com/static/img/coins/64x64/1027.png',
                 solana: 'https://s2.coinmarketcap.com/static/img/coins/64x64/5426.png',
                 binancecoin: 'https://s2.coinmarketcap.com/static/img/coins/64x64/1839.png',
                 ripple: 'https://s2.coinmarketcap.com/static/img/coins/64x64/52.png',
                 dogecoin: 'https://s2.coinmarketcap.com/static/img/coins/64x64/74.png',
                 cardano: 'https://s2.coinmarketcap.com/static/img/coins/64x64/2010.png',
                 'shiba-inu': 'https://s2.coinmarketcap.com/static/img/coins/64x64/5994.png',
                 polkadot: 'https://s2.coinmarketcap.com/static/img/coins/64x64/6636.png',
                 'matic-network': 'https://s2.coinmarketcap.com/static/img/coins/64x64/3890.png',
                 'avalanche-2': 'https://s2.coinmarketcap.com/static/img/coins/64x64/5805.png'
             };
             
             return cryptoIcons[cryptoId] || '';
         }

         // Fonction pour r√©cup√©rer les prix depuis CoinGecko
         async function fetchCoinGeckoPrices() {
             try {
                 const cryptoIds = Object.values(CRYPTO_IDS).join(',');
                 const response = await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${cryptoIds}&vs_currencies=eur&include_24hr_change=true`);
                 
                 if (!response.ok) {
                     throw new Error('Erreur API CoinGecko');
                 }
                 
                 const data = await response.json();
                 const prices = {};
                 
                 // Convertir les donn√©es CoinGecko vers notre format
                 Object.keys(CRYPTO_IDS).forEach(cryptoKey => {
                     const coinGeckoId = CRYPTO_IDS[cryptoKey];
                     if (data[coinGeckoId] && data[coinGeckoId].eur) {
                         prices[cryptoKey] = data[coinGeckoId].eur;
                     }
                 });
                 
                 // Sauvegarder les prix
                 sessionStorage.setItem('alternative_crypto_prices', JSON.stringify(prices));
                 sessionStorage.setItem('last_price_update', Date.now().toString());
                 
                 console.log('‚úÖ Prix CoinGecko r√©cup√©r√©s:', prices);
                 return prices;
             } catch (error) {
                 console.warn('‚ö†Ô∏è Erreur CoinGecko:', error);
                 
                 // Ne pas faire de retry automatique pour √©viter les boucles infinies
                 // L'utilisateur peut utiliser le bouton "Actualiser" manuellement
                 
                 return null;
             }
         }

         // Fonction pour initialiser les prix au chargement
         async function initializePrices() {
             try {
                 console.log('üöÄ Initialisation des prix...');
                 
                 // V√©rifier si on a des prix r√©cents (moins de 5 minutes)
                 const lastUpdate = sessionStorage.getItem('last_price_update');
                 const now = Date.now();
                 
                 if (lastUpdate && (now - parseInt(lastUpdate)) < 300000) { // 5 minutes
                     console.log('‚úÖ Prix r√©cents trouv√©s, pas besoin de mise √† jour');
                     
                     // Mettre √† jour l'affichage avec les prix existants
                     updateCryptoDisplay();
                     return;
                 }
                 
                 // R√©cup√©rer les prix depuis CoinGecko
                 const prices = await fetchCoinGeckoPrices();
                 
                 // Mettre √† jour l'affichage avec les nouveaux prix
                 if (prices) {
                     // Convertir le format simple vers le format attendu par updateCryptoDisplay
                     const formattedPrices = {};
                     Object.keys(prices).forEach(cryptoKey => {
                         formattedPrices[cryptoKey] = {
                             price: prices[cryptoKey],
                             change_24h: 0, // Valeur par d√©faut
                             volume_24h: 0,
                             market_cap: 0
                         };
                     });
                     
                     // Sauvegarder dans le format attendu par updateCryptoDisplay
                     sessionStorage.setItem('background_crypto_prices', JSON.stringify({
                         prices: formattedPrices,
                         timestamp: Date.now(),
                         source: 'coingecko'
                     }));
                     
                     // Mettre √† jour l'affichage
                     updateCryptoDisplay(formattedPrices);
                 }
                 
             } catch (error) {
                 console.warn('‚ö†Ô∏è Erreur lors de l\'initialisation des prix:', error);
                 
                 // Ne pas faire de retry automatique pour √©viter les boucles infinies
                 // L'utilisateur peut utiliser le bouton "Actualiser" manuellement
             }
         }

         // Fonction pour afficher tous les prix disponibles (debug)
         function debugPrices() {
             console.log('üîç === DEBUG PRIX ===');
             
             // Prix en arri√®re-plan
             const backgroundData = sessionStorage.getItem('background_crypto_prices');
             if (backgroundData) {
                 console.log('üìä Prix en arri√®re-plan:', JSON.parse(backgroundData));
             } else {
                 console.log('‚ùå Aucun prix en arri√®re-plan');
             }
             
             // Prix principaux
             const mainData = sessionStorage.getItem('crypto_prices');
             if (mainData) {
                 console.log('üìä Prix principaux:', JSON.parse(mainData));
             } else {
                 console.log('‚ùå Aucun prix principal');
             }
             
             // Prix alternatifs
             const alternativeData = sessionStorage.getItem('alternative_crypto_prices');
             if (alternativeData) {
                 console.log('üìä Prix alternatifs:', JSON.parse(alternativeData));
             } else {
                 console.log('‚ùå Aucun prix alternatif');
             }
             
             // Derni√®re mise √† jour
             const lastUpdate = sessionStorage.getItem('last_price_update');
             if (lastUpdate) {
                 const timeAgo = Date.now() - parseInt(lastUpdate);
                 console.log(`‚è∞ Derni√®re mise √† jour: il y a ${Math.round(timeAgo / 1000)} secondes`);
             } else {
                 console.log('‚ùå Aucune mise √† jour enregistr√©e');
             }
             
             console.log('üîç === FIN DEBUG ===');
         }

         // Fonction pour forcer la mise √† jour des prix avec notification
         async function forceUpdateWithNotification() {
             console.log('üîÑ Mise √† jour manuelle demand√©e');
             
             // Ajouter un indicateur visuel sur le bouton
             const refreshBtn = document.querySelector('.refresh-btn');
             if (refreshBtn) {
                 refreshBtn.style.transform = 'rotate(180deg)';
                 refreshBtn.style.transition = 'transform 0.5s ease';
                 refreshBtn.disabled = true;
             }
             
             if (window.cryptoPriceUpdater) {
                 await window.cryptoPriceUpdater.forceUpdate();
                 
                 setTimeout(() => {
                     // Synchroniser les donn√©es entre l'affichage et les graphiques
                     synchronizeCryptoData();
                     
                     // Notification de succ√®s
                     showNotification('‚úÖ Prix actualis√©s avec succ√®s !', 'success');
                     
                     // R√©initialiser le bouton
                     if (refreshBtn) {
                         refreshBtn.style.transform = 'rotate(360deg)';
                         refreshBtn.disabled = false;
                     }
                 }, 1000); // R√©duit √† 1 seconde pour plus de r√©activit√©
             } else {
                 showNotification('‚ùå Syst√®me de prix non disponible', 'error');
                 
                 // R√©initialiser le bouton en cas d'erreur
                 if (refreshBtn) {
                     refreshBtn.style.transform = 'rotate(360deg)';
                     refreshBtn.disabled = false;
                 }
             }
         }
         
         // Fonction pour forcer la mise √† jour des prix d'√©change avec notification
         async function forceUpdatePricesWithNotification() {
             console.log('üîÑ Mise √† jour √©change demand√©e');
             
             if (window.cryptoPriceUpdater) {
                 await window.cryptoPriceUpdater.forceUpdate();
                 
                 setTimeout(() => {
                     // Mettre √† jour l'affichage d'√©change
                     if (window.exchangeData) {
                         updateExchangeAmounts();
                     }
                     
                     // Notification de succ√®s
                     showNotification('‚úÖ Prix actualis√©s avec succ√®s !', 'success');
                 }, 1000); // R√©duit √† 1 seconde pour plus de r√©activit√©
             } else {
                 showNotification('‚ùå Syst√®me de prix non disponible', 'error');
             }
         }
         
         // Fonction pour synchroniser les donn√©es entre l'affichage et les graphiques
         function synchronizeCryptoData() {
             console.log('üîÑ Synchronisation des donn√©es crypto...');
             
             // Mettre √† jour l'indicateur de synchronisation
             const realtimeIndicator = document.querySelector('.realtime-indicator');
             if (realtimeIndicator) {
                 realtimeIndicator.style.background = 'rgba(16, 185, 129, 0.2)';
                 realtimeIndicator.style.borderColor = '#10B981';
                 
                 setTimeout(() => {
                     realtimeIndicator.style.background = 'rgba(16, 185, 129, 0.1)';
                     realtimeIndicator.style.borderColor = 'rgba(16, 185, 129, 0.2)';
                 }, 1000);
             }
             
             // R√©cup√©rer ou cr√©er les donn√©es en arri√®re-plan
             let backgroundData = sessionStorage.getItem('background_crypto_prices');
             let parsed;
             
             if (backgroundData) {
                 parsed = JSON.parse(backgroundData);
             } else {
                 // Cr√©er une nouvelle structure si elle n'existe pas
                 parsed = {
                     prices: {},
                     timestamp: Date.now(),
                     source: 'synchronized'
                 };
             }
             
             // Mettre √† jour les donn√©es de chaque crypto avec des donn√©es coh√©rentes
             for (const cryptoKey of Object.keys(CRYPTO_IDS)) {
                 const chartData = generateRealisticChartData(cryptoKey, '24H');
                 
                 if (chartData.length > 0) {
                     const lastPrice = chartData[chartData.length - 1].y;
                     const firstPrice = chartData[0].y;
                     const calculatedChange24h = ((lastPrice - firstPrice) / firstPrice) * 100;
                     
                     // Mettre √† jour les donn√©es en arri√®re-plan
                     if (!parsed.prices[cryptoKey]) {
                         parsed.prices[cryptoKey] = {};
                     }
                     parsed.prices[cryptoKey].price = lastPrice;
                     parsed.prices[cryptoKey].change_24h = calculatedChange24h;
                     parsed.prices[cryptoKey].volume_24h = lastPrice * 1000000; // Volume simul√©
                     parsed.prices[cryptoKey].market_cap = lastPrice * 1000000000; // Market cap simul√©
                 }
             }
             
             // Sauvegarder les donn√©es mises √† jour
             sessionStorage.setItem('background_crypto_prices', JSON.stringify(parsed));
             
             // Mettre √† jour l'affichage avec les donn√©es synchronis√©es
             updateCryptoDisplay();
             
             // Mettre √† jour l'heure de derni√®re synchronisation
             const lastUpdateTime = document.getElementById('lastUpdateTime');
             if (lastUpdateTime) {
                 lastUpdateTime.textContent = new Date().toLocaleTimeString('fr-FR');
             }
             
             console.log('‚úÖ Synchronisation termin√©e');
         }
         
         // Fonction pour forcer la mise √† jour des prix (UNIFI√âE)
         async function forceUpdatePrices() {
             try {
                 console.log('üîÑ For√ßage de la mise √† jour des prix (syst√®me unifi√©)...');
                 
                 // Afficher une notification de chargement
                 showNotification('üîÑ Actualisation des prix en cours...', 'info');
                 
                 // Utiliser le syst√®me cryptoPriceUpdater s'il est disponible
                 if (window.cryptoPriceUpdater) {
                     console.log('‚úÖ Utilisation du syst√®me cryptoPriceUpdater');
                     
                     // Forcer la mise √† jour via cryptoPriceUpdater
                     await window.cryptoPriceUpdater.forceUpdate();
                     
                     // Attendre un peu pour que la mise √† jour se termine
                     setTimeout(() => {
                         // Mettre √† jour l'affichage de l'√©change si la modal est ouverte
                         if (window.exchangeData) {
                             updateExchangeAmounts();
                         }
                         
                         // R√©cup√©rer les donn√©es mises √† jour depuis sessionStorage
                         const backgroundData = sessionStorage.getItem('background_crypto_prices');
                         if (backgroundData) {
                             const parsed = JSON.parse(backgroundData);
                             // Mettre √† jour l'affichage principal avec les nouvelles donn√©es
                             updateCryptoDisplay(parsed.prices);
                         } else {
                             // Fallback : mettre √† jour sans donn√©es
                             updateCryptoDisplay();
                         }
                         
                         // Notification de succ√®s (seulement si demand√©e explicitement)
                         if (window.showUpdateNotification) {
                             showNotification('‚úÖ Prix actualis√©s avec succ√®s !', 'success');
                             window.showUpdateNotification = false;
                         } else {
                             showNotification('‚úÖ Prix actualis√©s avec succ√®s !', 'success');
                         }
                     }, 1000); // R√©duit √† 1 seconde pour plus de r√©activit√©
                     
                 } else {
                     console.log('‚ö†Ô∏è cryptoPriceUpdater non disponible, utilisation du syst√®me de fallback');
                     
                     // Syst√®me de fallback (ancien syst√®me)
                     let prices = await fetchCoinGeckoPrices();
                     
                     if (!prices) {
                         const data = await fetchCryptoData();
                         if (data) {
                             prices = data;
                         }
                     }
                     
                     if (prices) {
                         console.log('‚úÖ Prix mis √† jour avec succ√®s (fallback)');
                         
                         // Mettre √† jour l'affichage de l'√©change si la modal est ouverte
                         if (window.exchangeData) {
                             updateExchangeAmounts();
                         }
                         
                         // Mettre √† jour l'affichage principal avec les nouvelles donn√©es
                         updateCryptoDisplay(prices);
                         
                         // Notification de succ√®s
                         showNotification('‚úÖ Prix actualis√©s avec succ√®s !', 'success');
                     } else {
                         console.warn('‚ùå Impossible de r√©cup√©rer les prix');
                     }
                 }
             } catch (error) {
                 console.warn('‚ö†Ô∏è Erreur lors de la mise √† jour des prix:', error);
             }
         }

         // ===== FONCTIONS D'HISTORIQUE DES TRANSACTIONS =====

         // Fonction pour afficher la modal d'historique
         function showHistoryModal(cryptoId, cryptoName) {
             // R√©cup√©rer toutes les transactions
             const allTransactions = getAllTransactions();
             
             // Si c'est l'historique bancaire, filtrer pour EURX et USDT
             if (cryptoId === 'banking') {
                 const bankingTransactions = allTransactions.filter(tx => 
                     tx.type === 'banking_deposit' || 
                     tx.type === 'banking_withdraw' ||
                     (tx.cryptoId && (tx.cryptoId === 'eurx' || tx.cryptoId === 'usdt'))
                 );
                 
                 // Cr√©er la modal d'historique bancaire
                 const modal = document.createElement('div');
                 modal.className = 'history-modal';
                 modal.innerHTML = `
                     <div class="history-modal-content">
                         <div class="history-modal-header">
                             <h3>Historique bancaire</h3>
                             <div class="history-filters">
                                 <button class="filter-btn active" data-filter="all">Toutes</button>
                                 <button class="filter-btn" data-filter="banking_deposit">D√©p√¥ts</button>
                                 <button class="filter-btn" data-filter="banking_withdraw">Retraits</button>
                                 <button class="filter-btn" data-filter="eurx">EURX</button>
                                 <button class="filter-btn" data-filter="usdt">USDT</button>
                             </div>
                             <button class="close-btn" onclick="closeHistoryModal()">
                                 <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                     <path d="M18 6L6 18M6 6l12 12"/>
                                 </svg>
                             </button>
                         </div>
                         <div class="history-modal-body">
                             <div class="history-summary">
                                 <div class="summary-item">
                                     <span class="summary-label">Total des transactions:</span>
                                     <span class="summary-value">${bankingTransactions.length}</span>
                                 </div>
                                 <div class="summary-item">
                                     <span class="summary-label">Solde EURX:</span>
                                     <span class="summary-value">${getCryptoBalance('eurx').toFixed(6)} EURX</span>
                                 </div>
                                 <div class="summary-item">
                                     <span class="summary-label">Solde USDT:</span>
                                     <span class="summary-value">${getCryptoBalance('usdt').toFixed(6)} USDT</span>
                                 </div>
                             </div>
                             
                             <div class="transactions-container">
                                 <div class="transactions-list" id="transactionsList">
                                     ${generateBankingTransactionsHTML(bankingTransactions)}
                                 </div>
                             </div>
                             
                             <div class="history-actions">
                                 <button class="test-btn" onclick="createBankingTestTransactions()" title="Cr√©er des transactions de test">
                                     <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                         <path d="M12 2v4"/>
                                         <path d="M12 18v4"/>
                                         <path d="M4.93 4.93l2.83 2.83"/>
                                         <path d="M16.24 16.24l2.83 2.83"/>
                                         <path d="M2 12h4"/>
                                         <path d="M18 12h4"/>
                                         <path d="M4.93 19.07l2.83-2.83"/>
                                         <path d="M16.24 7.76l2.83-2.83"/>
                                     </svg>
                                     Test
                                 </button>
                                 <button class="export-btn" onclick="exportTransactions()">
                                     <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                         <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                         <polyline points="7,10 12,15 17,10"/>
                                         <line x1="12" y1="15" x2="12" y2="3"/>
                                     </svg>
                                     Exporter
                                 </button>
                                 <button class="clear-btn" onclick="clearTransactions()">
                                     <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                         <path d="M3 6h18"/>
                                         <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"/>
                                         <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                                     </svg>
                                     Effacer
                                 </button>
                             </div>
                         </div>
                     </div>
                 `;

                 document.body.appendChild(modal);
                 
                 // Ajouter les event listeners pour les filtres
                 const filterBtns = modal.querySelectorAll('.filter-btn');
                 filterBtns.forEach(btn => {
                     btn.addEventListener('click', function() {
                         filterBtns.forEach(b => b.classList.remove('active'));
                         this.classList.add('active');
                         
                         const filter = this.getAttribute('data-filter');
                         filterBankingTransactions(filter, bankingTransactions);
                     });
                 });

                 // Afficher la modal avec animation
                 setTimeout(() => {
                     modal.style.opacity = '1';
                     modal.querySelector('.history-modal-content').style.transform = 'translateY(0)';
                 }, 10);

                 // Fermer la modal en cliquant √† l'ext√©rieur
                 modal.addEventListener('click', (e) => {
                     if (e.target === modal) {
                         closeHistoryModal();
                     }
                 });

                 // Fermer avec la touche Escape
                 document.addEventListener('keydown', function closeOnEscape(e) {
                     if (e.key === 'Escape') {
                         closeHistoryModal();
                         document.removeEventListener('keydown', closeOnEscape);
                     }
                 });
                 
                 return;
             }
             
             // Filtrer les transactions pour cette crypto (optionnel)
             const cryptoTransactions = allTransactions.filter(tx => 
                 tx.cryptoId === cryptoId || 
                 tx.sellCrypto === cryptoId || 
                 tx.receiveCrypto === cryptoId
             );
             
             // Cr√©er la modal d'historique
             const modal = document.createElement('div');
             modal.className = 'history-modal';
             modal.innerHTML = `
                 <div class="history-modal-content">
                     <div class="history-modal-header">
                         <h3>Historique des transactions</h3>
                         <div class="history-filters">
                             <button class="filter-btn active" data-filter="all">Toutes</button>
                             <button class="filter-btn" data-filter="deposit">D√©p√¥ts</button>
                             <button class="filter-btn" data-filter="withdraw">Retraits</button>
                             <button class="filter-btn" data-filter="exchange">√âchanges</button>
                         </div>
                         <button class="close-btn" onclick="closeHistoryModal()">
                             <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                 <path d="M18 6L6 18M6 6l12 12"/>
                             </svg>
                         </button>
                     </div>
                     <div class="history-modal-body">
                         <div class="history-summary">
                             <div class="summary-item">
                                 <span class="summary-label">Total des transactions:</span>
                                 <span class="summary-value">${allTransactions.length}</span>
                             </div>
                             <div class="summary-item">
                                 <span class="summary-label">Solde actuel ${cryptoName}:</span>
                                 <span class="summary-value">${getCryptoBalance(cryptoId).toFixed(6)} ${getCryptoSymbol(cryptoId)}</span>
                             </div>
                         </div>
                         
                         <div class="transactions-container">
                             <div class="transactions-list" id="transactionsList">
                                 ${generateTransactionsHTML(allTransactions)}
                             </div>
                         </div>
                         
                         <div class="history-actions">
                             <button class="test-btn" onclick="createTestTransactions()" title="Cr√©er des transactions de test">
                                 <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                     <path d="M12 2v4"/>
                                     <path d="M12 18v4"/>
                                     <path d="M4.93 4.93l2.83 2.83"/>
                                     <path d="M16.24 16.24l2.83 2.83"/>
                                     <path d="M2 12h4"/>
                                     <path d="M18 12h4"/>
                                     <path d="M4.93 19.07l2.83-2.83"/>
                                     <path d="M16.24 7.76l2.83-2.83"/>
                                 </svg>
                                 Test
                             </button>
                             <button class="export-btn" onclick="exportTransactions()">
                                 <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                     <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                     <polyline points="7,10 12,15 17,10"/>
                                     <line x1="12" y1="15" x2="12" y2="3"/>
                                 </svg>
                                 Exporter
                             </button>
                             <button class="clear-btn" onclick="clearTransactions()">
                                 <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                     <path d="M3 6h18"/>
                                     <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"/>
                                     <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                                 </svg>
                                 Effacer
                             </button>
                         </div>
                     </div>
                 </div>
             `;

             document.body.appendChild(modal);
             
             // Ajouter les event listeners pour les filtres
             const filterBtns = modal.querySelectorAll('.filter-btn');
             filterBtns.forEach(btn => {
                 btn.addEventListener('click', function() {
                     // Retirer la classe active de tous les boutons
                     filterBtns.forEach(b => b.classList.remove('active'));
                     // Ajouter la classe active au bouton cliqu√©
                     this.classList.add('active');
                     
                     // Filtrer les transactions
                     const filter = this.getAttribute('data-filter');
                     filterTransactions(filter, allTransactions);
                 });
             });

             // Afficher la modal avec animation
             setTimeout(() => {
                 modal.style.opacity = '1';
                 modal.querySelector('.history-modal-content').style.transform = 'translateY(0)';
             }, 10);

             // Fermer la modal en cliquant √† l'ext√©rieur
             modal.addEventListener('click', (e) => {
                 if (e.target === modal) {
                     closeHistoryModal();
                 }
             });

             // Fermer avec la touche Escape
             document.addEventListener('keydown', function closeOnEscape(e) {
                 if (e.key === 'Escape') {
                     closeHistoryModal();
                     document.removeEventListener('keydown', closeOnEscape);
                 }
             });
         }

         // Fonction pour fermer la modal d'historique
         function closeHistoryModal() {
             const modal = document.querySelector('.history-modal');
             if (modal) {
                 modal.style.opacity = '0';
                 modal.querySelector('.history-modal-content').style.transform = 'translateY(20px)';
                 setTimeout(() => {
                     modal.remove();
                 }, 300);
             }
         }

         // Fonction pour r√©cup√©rer toutes les transactions
         function getAllTransactions() {
             const transactions = JSON.parse(localStorage.getItem('crypto_transactions') || '[]');
             return transactions.sort((a, b) => b.timestamp - a.timestamp); // Plus r√©cent en premier
         }

         // Fonction pour g√©n√©rer le HTML des transactions
         function generateTransactionsHTML(transactions) {
             if (transactions.length === 0) {
                 return `
                     <div class="no-transactions">
                         <div class="no-transactions-icon">üìã</div>
                         <h4>Aucune transaction</h4>
                         <p>Vous n'avez pas encore effectu√© de transactions.</p>
                     </div>
                 `;
             }

             return transactions.map(transaction => {
                 const date = new Date(transaction.timestamp);
                 const formattedDate = date.toLocaleDateString('fr-FR', {
                     day: '2-digit',
                     month: '2-digit',
                     year: 'numeric'
                 });
                 const formattedTime = date.toLocaleTimeString('fr-FR', {
                     hour: '2-digit',
                     minute: '2-digit'
                 });

                 let transactionHTML = `
                     <div class="transaction-item ${transaction.type}" data-id="${transaction.id}">
                         <div class="transaction-header">
                             <div class="transaction-type">
                                 ${getTransactionIcon(transaction.type)}
                                 <span class="transaction-type-text">${getTransactionTypeText(transaction.type)}</span>
                             </div>
                             <div class="transaction-status ${transaction.status}">
                                 ${getStatusIcon(transaction.status)}
                                 <span>${getStatusText(transaction.status)}</span>
                             </div>
                         </div>
                         <div class="transaction-details">
                 `;

                 // D√©tails sp√©cifiques selon le type de transaction
                 switch (transaction.type) {
                     case 'deposit':
                         transactionHTML += `
                             <div class="transaction-row">
                                 <span>Montant re√ßu:</span>
                                 <span class="amount positive">+${transaction.amount.toFixed(6)} ${getCryptoSymbol(transaction.cryptoId)}</span>
                             </div>
                             <div class="transaction-row">
                                 <span>Valeur:</span>
                                 <span>${formatPrice(transaction.amount * getCurrentCryptoPrice(transaction.cryptoId))}</span>
                             </div>
                         `;
                         break;
                     
                     case 'withdraw':
                         transactionHTML += `
                             <div class="transaction-row">
                                 <span>Montant retir√©:</span>
                                 <span class="amount negative">-${transaction.amount.toFixed(6)} ${getCryptoSymbol(transaction.cryptoId)}</span>
                             </div>
                             <div class="transaction-row">
                                 <span>Frais:</span>
                                 <span>${formatPrice(transaction.fees)}</span>
                             </div>
                             <div class="transaction-row">
                                 <span>Montant re√ßu:</span>
                                 <span>${transaction.received.toFixed(6)} ${getCryptoSymbol(transaction.cryptoId)}</span>
                             </div>
                             <div class="transaction-row">
                                 <span>Adresse:</span>
                                 <span class="address">${transaction.address.substring(0, 8)}...${transaction.address.substring(transaction.address.length - 8)}</span>
                             </div>
                         `;
                         break;
                     
                     case 'exchange':
                         transactionHTML += `
                             <div class="transaction-row">
                                 <span>Vendu:</span>
                                 <span class="amount negative">-${transaction.sellAmount.toFixed(6)} ${getCryptoSymbol(transaction.sellCrypto)}</span>
                             </div>
                             <div class="transaction-row">
                                 <span>Re√ßu:</span>
                                 <span class="amount positive">+${transaction.receiveAmount.toFixed(6)} ${getCryptoSymbol(transaction.receiveCrypto)}</span>
                             </div>
                             <div class="transaction-row">
                                 <span>Frais:</span>
                                 <span>${formatPrice(transaction.fees)}</span>
                             </div>
                         `;
                         break;
                 }

                 transactionHTML += `
                             <div class="transaction-row">
                                 <span>Date:</span>
                                 <span>${formattedDate} √† ${formattedTime}</span>
                             </div>
                             <div class="transaction-row">
                                 <span>ID:</span>
                                 <span class="transaction-id">${transaction.id}</span>
                             </div>
                         </div>
                     </div>
                 `;

                 return transactionHTML;
             }).join('');
         }

         // Fonction pour g√©n√©rer l'HTML des transactions bancaires
         function generateBankingTransactionsHTML(transactions) {
             if (transactions.length === 0) {
                 return `
                     <div class="no-transactions">
                         <div class="no-transactions-icon">üìã</div>
                         <h4>Aucune transaction bancaire</h4>
                         <p>Vous n'avez pas encore effectu√© de transactions EURX ou USDT.</p>
                     </div>
                 `;
             }

             return transactions.map(transaction => {
                 const date = new Date(transaction.timestamp);
                 const formattedDate = date.toLocaleDateString('fr-FR', {
                     day: '2-digit',
                     month: '2-digit',
                     year: 'numeric'
                 });
                 const formattedTime = date.toLocaleTimeString('fr-FR', {
                     hour: '2-digit',
                     minute: '2-digit'
                 });

                 let transactionHTML = `
                     <div class="transaction-item ${transaction.type}" data-id="${transaction.id}">
                         <div class="transaction-header">
                             <div class="transaction-type">
                                 ${getBankingTransactionIcon(transaction.type, transaction.cryptoId)}
                                 <span class="transaction-type-text">${getBankingTransactionTypeText(transaction.type, transaction.cryptoId)}</span>
                             </div>
                             <div class="transaction-status ${transaction.status}">
                                 ${getStatusIcon(transaction.status)}
                                 <span>${getStatusText(transaction.status)}</span>
                             </div>
                         </div>
                         <div class="transaction-details">
                 `;

                 // D√©tails sp√©cifiques selon le type de transaction
                 switch (transaction.type) {
                     case 'banking_deposit':
                         transactionHTML += `
                             <div class="transaction-row">
                                 <span>Montant re√ßu:</span>
                                 <span class="amount positive">+${transaction.amount.toFixed(6)} ${transaction.cryptoId.toUpperCase()}</span>
                             </div>
                             <div class="transaction-row">
                                 <span>R√©seau:</span>
                                 <span>Ethereum</span>
                             </div>
                         `;
                         break;
                     
                     case 'banking_withdraw':
                         transactionHTML += `
                             <div class="transaction-row">
                                 <span>Montant retir√©:</span>
                                 <span class="amount negative">-${transaction.amount.toFixed(6)} ${transaction.cryptoId.toUpperCase()}</span>
                             </div>
                             <div class="transaction-row">
                                 <span>Frais:</span>
                                 <span>${formatPrice(transaction.fees)}</span>
                             </div>
                             <div class="transaction-row">
                                 <span>Montant re√ßu:</span>
                                 <span>${transaction.received.toFixed(6)} ${transaction.cryptoId.toUpperCase()}</span>
                             </div>
                             <div class="transaction-row">
                                 <span>Adresse:</span>
                                 <span class="address">${transaction.address.substring(0, 8)}...${transaction.address.substring(transaction.address.length - 8)}</span>
                             </div>
                         `;
                         break;
                     
                     case 'deposit':
                     case 'withdraw':
                         if (transaction.cryptoId === 'eurx' || transaction.cryptoId === 'usdt') {
                             const action = transaction.type === 'deposit' ? 're√ßu' : 'retir√©';
                             const sign = transaction.type === 'deposit' ? '+' : '-';
                             const cssClass = transaction.type === 'deposit' ? 'positive' : 'negative';
                             
                             transactionHTML += `
                                 <div class="transaction-row">
                                     <span>Montant ${action}:</span>
                                     <span class="amount ${cssClass}">${sign}${transaction.amount.toFixed(6)} ${transaction.cryptoId.toUpperCase()}</span>
                                 </div>
                             `;
                             
                             if (transaction.type === 'withdraw') {
                                 transactionHTML += `
                                     <div class="transaction-row">
                                         <span>Frais:</span>
                                         <span>${formatPrice(transaction.fees)}</span>
                                     </div>
                                     <div class="transaction-row">
                                         <span>Adresse:</span>
                                         <span class="address">${transaction.address.substring(0, 8)}...${transaction.address.substring(transaction.address.length - 8)}</span>
                                     </div>
                                 `;
                             }
                         }
                         break;
                 }

                 transactionHTML += `
                             <div class="transaction-row">
                                 <span>Date:</span>
                                 <span>${formattedDate} √† ${formattedTime}</span>
                             </div>
                             <div class="transaction-row">
                                 <span>ID:</span>
                                 <span class="transaction-id">${transaction.id}</span>
                             </div>
                         </div>
                     </div>
                 `;

                 return transactionHTML;
             }).join('');
         }

         // Fonction pour filtrer les transactions bancaires
         function filterBankingTransactions(filter, allTransactions) {
             let filteredTransactions = allTransactions;
             
             if (filter !== 'all') {
                 if (filter === 'eurx') {
                     filteredTransactions = allTransactions.filter(tx => tx.cryptoId === 'eurx');
                 } else if (filter === 'usdt') {
                     filteredTransactions = allTransactions.filter(tx => tx.cryptoId === 'usdt');
                 } else {
                     filteredTransactions = allTransactions.filter(tx => tx.type === filter);
                 }
             }
             
             const transactionsList = document.getElementById('transactionsList');
             transactionsList.innerHTML = generateBankingTransactionsHTML(filteredTransactions);
         }

         // Fonction pour obtenir l'ic√¥ne des transactions bancaires
         function getBankingTransactionIcon(type, cryptoId) {
             if (type === 'banking_deposit') {
                 return cryptoId === 'eurx' ? 'üíé' : 'üíµ';
             } else if (type === 'banking_withdraw') {
                 return cryptoId === 'eurx' ? 'üíé' : 'üíµ';
             }
             return getTransactionIcon(type);
         }

         // Fonction pour obtenir le texte des types de transactions bancaires
         function getBankingTransactionTypeText(type, cryptoId) {
             if (type === 'banking_deposit') {
                 return `D√©p√¥t ${cryptoId.toUpperCase()}`;
             } else if (type === 'banking_withdraw') {
                 return `Retrait ${cryptoId.toUpperCase()}`;
             }
             return getTransactionTypeText(type);
         }

         // Fonction pour filtrer les transactions
         function filterTransactions(filter, allTransactions) {
             let filteredTransactions = allTransactions;
             
             if (filter !== 'all') {
                 filteredTransactions = allTransactions.filter(tx => tx.type === filter);
             }
             
             const transactionsList = document.getElementById('transactionsList');
             transactionsList.innerHTML = generateTransactionsHTML(filteredTransactions);
         }

         // Fonction pour obtenir l'ic√¥ne du type de transaction
         function getTransactionIcon(type) {
             const icons = {
                 deposit: 'üì•',
                 withdraw: 'üì§',
                 exchange: 'üîÑ'
             };
             return icons[type] || 'üìã';
         }

         // Fonction pour obtenir le texte du type de transaction
         function getTransactionTypeText(type) {
             const texts = {
                 deposit: 'D√©p√¥t',
                 withdraw: 'Retrait',
                 exchange: '√âchange'
             };
             return texts[type] || 'Transaction';
         }

         // Fonction pour obtenir l'ic√¥ne du statut
         function getStatusIcon(status) {
             const icons = {
                 pending: '‚è≥',
                 completed: '‚úÖ',
                 failed: '‚ùå',
                 cancelled: 'üö´'
             };
             return icons[status] || '‚ùì';
         }

         // Fonction pour obtenir le texte du statut
         function getStatusText(status) {
             const texts = {
                 pending: 'En cours',
                 completed: 'Termin√©',
                 failed: '√âchou√©',
                 cancelled: 'Annul√©'
             };
             return texts[status] || 'Inconnu';
         }

         // Fonction pour exporter les transactions
         function exportTransactions() {
             const transactions = getAllTransactions();
             const dataStr = JSON.stringify(transactions, null, 2);
             const dataBlob = new Blob([dataStr], { type: 'application/json' });
             const url = URL.createObjectURL(dataBlob);
             
             const link = document.createElement('a');
             link.href = url;
             link.download = `transactions_${new Date().toISOString().split('T')[0]}.json`;
             document.body.appendChild(link);
             link.click();
             document.body.removeChild(link);
             
             showNotification('‚úÖ Transactions export√©es avec succ√®s', 'success');
         }

         // Fonction pour effacer toutes les transactions
         function clearTransactions() {
             if (confirm('√ätes-vous s√ªr de vouloir effacer toutes les transactions ? Cette action est irr√©versible.')) {
                 localStorage.removeItem('crypto_transactions');
                 showNotification('‚úÖ Toutes les transactions ont √©t√© effac√©es', 'success');
                 
                 // Fermer la modal et la rouvrir pour actualiser
                 closeHistoryModal();
                 setTimeout(() => {
                     showHistoryModal(window.currentCryptoDetail, getCryptoName(window.currentCryptoDetail));
                 }, 350);
             }
         }

         // Fonction pour afficher la modal de d√©p√¥t bancaire
         function showBankingDepositModal() {
             const modal = document.createElement('div');
             modal.className = 'banking-deposit-modal';
             modal.innerHTML = `
                 <div class="banking-deposit-modal-content">
                     <div class="banking-deposit-modal-header">
                         <h3>D√©p√¥t sur compte bancaire</h3>
                         <button class="close-btn" onclick="closeBankingDepositModal()">
                             <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                 <path d="M18 6L6 18M6 6l12 12"/>
                             </svg>
                         </button>
                     </div>
                     <div class="banking-deposit-modal-body">
                         <div class="deposit-options">
                             <div class="deposit-option" onclick="selectDepositOption('eurx')">
                                 <div class="deposit-option-icon">üíé</div>
                                 <div class="deposit-option-info">
                                     <h4>EURX ETH</h4>
                                     <p>Euros num√©riques sur Ethereum</p>
                                 </div>
                                 <div class="deposit-option-arrow">
                                     <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                         <path d="M9 18l6-6-6-6"/>
                                     </svg>
                                 </div>
                             </div>
                             
                             <div class="deposit-option" onclick="selectDepositOption('usdt')">
                                 <div class="deposit-option-icon">üíµ</div>
                                 <div class="deposit-option-info">
                                     <h4>USDT ETH</h4>
                                     <p>Tether USD sur Ethereum</p>
                                 </div>
                                 <div class="deposit-option-arrow">
                                     <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                         <path d="M9 18l6-6-6-6"/>
                                     </svg>
                                 </div>
                             </div>
                         </div>
                     </div>
                 </div>
             `;

             document.body.appendChild(modal);
             
             // Afficher la modal avec animation
             setTimeout(() => {
                 modal.style.opacity = '1';
                 modal.querySelector('.banking-deposit-modal-content').style.transform = 'translateY(0)';
             }, 10);

             // Fermer la modal en cliquant √† l'ext√©rieur
             modal.addEventListener('click', (e) => {
                 if (e.target === modal) {
                     closeBankingDepositModal();
                 }
             });

             // Fermer avec la touche Escape
             document.addEventListener('keydown', function closeOnEscape(e) {
                 if (e.key === 'Escape') {
                     closeBankingDepositModal();
                     document.removeEventListener('keydown', closeOnEscape);
                 }
             });
         }

         // Fonction pour fermer la modal de d√©p√¥t bancaire
         function closeBankingDepositModal() {
             const modal = document.querySelector('.banking-deposit-modal');
             if (modal) {
                 modal.style.opacity = '0';
                 modal.querySelector('.banking-deposit-modal-content').style.transform = 'translateY(20px)';
                 setTimeout(() => {
                     modal.remove();
                 }, 300);
             }
         }

         // Fonction pour s√©lectionner une option de d√©p√¥t
         function selectDepositOption(type) {
             const walletAddress = '0x1bA0E5eA026E6Be9a88D767Bd341Fa3CDc4BEf0A';
             const cryptoName = type === 'eurx' ? 'EURX ETH' : 'USDT ETH';
             const cryptoIcon = type === 'eurx' ? 'üíé' : 'üíµ';
             
             // Fermer la modal de s√©lection
             closeBankingDepositModal();
             
             // Cr√©er la modal de d√©p√¥t avec QR code
             const modal = document.createElement('div');
             modal.className = 'banking-deposit-modal';
             modal.innerHTML = `
                 <div class="banking-deposit-modal-content">
                     <div class="banking-deposit-modal-header">
                         <h3>D√©p√¥t ${cryptoName}</h3>
                         <button class="close-btn" onclick="closeBankingDepositModal()">
                             <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                 <path d="M18 6L6 18M6 6l12 12"/>
                             </svg>
                         </button>
                     </div>
                     <div class="banking-deposit-modal-body">
                         <div class="crypto-info-header">
                             <div class="crypto-icon">${cryptoIcon}</div>
                             <div class="crypto-details">
                                 <h4>${cryptoName}</h4>
                                 <p>R√©seau Ethereum</p>
                             </div>
                         </div>
                         
                         <div class="qr-code-container">
                             <div id="qrCode"></div>
                             <p class="qr-note">Scannez ce QR code avec votre wallet</p>
                         </div>
                         
                         <div class="wallet-address-container">
                             <label>Adresse de r√©ception :</label>
                             <div class="address-input-group">
                                 <input type="text" id="walletAddress" value="${walletAddress}" readonly>
                                 <button class="copy-btn" onclick="copyAddress()">
                                     <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                         <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/>
                                         <rect x="8" y="2" width="8" height="4" rx="1" ry="1"/>
                                     </svg>
                                     Copier
                                 </button>
                                 <button class="share-btn" onclick="shareAddress()">
                                     <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                         <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/>
                                         <polyline points="16,6 12,2 8,6"/>
                                         <line x1="12" y1="2" x2="12" y2="15"/>
                                     </svg>
                                     Partager
                                 </button>
                             </div>
                         </div>
                         
                         <div class="deposit-warning">
                             <div class="warning-icon">‚ö†Ô∏è</div>
                             <div class="warning-text">
                                 <strong>Important :</strong> Envoyez uniquement des ${cryptoName} √† cette adresse. 
                                 L'envoi d'autres cryptomonnaies peut entra√Æner une perte permanente de vos fonds.
                             </div>
                         </div>
                         
                         <button class="back-btn" onclick="showBankingDepositModal()">
                             <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                 <path d="M19 12H5"/>
                                 <path d="M12 19l-7-7 7-7"/>
                             </svg>
                             Retour au choix
                         </button>
                     </div>
                 </div>
             `;

             document.body.appendChild(modal);
             
             // G√©n√©rer le QR code
             generateQRCode(walletAddress);
             
             // Afficher la modal avec animation
             setTimeout(() => {
                 modal.style.opacity = '1';
                 modal.querySelector('.banking-deposit-modal-content').style.transform = 'translateY(0)';
             }, 10);

             // Fermer la modal en cliquant √† l'ext√©rieur
             modal.addEventListener('click', (e) => {
                 if (e.target === modal) {
                     closeBankingDepositModal();
                 }
             });

             // Fermer avec la touche Escape
             document.addEventListener('keydown', function closeOnEscape(e) {
                 if (e.key === 'Escape') {
                     closeBankingDepositModal();
                     document.removeEventListener('keydown', closeOnEscape);
                 }
             });
         }

         // Fonction pour simuler un d√©p√¥t
         function simulateDeposit(cryptoId, cryptoName) {
             // G√©n√©rer un montant al√©atoire entre 0.01 et 1.0
             const amount = Math.random() * 0.99 + 0.01;
             
             // Cr√©er la transaction de d√©p√¥t
             const transaction = {
                 id: generateTransactionId(),
                 type: 'deposit',
                 cryptoId: cryptoId,
                 cryptoName: cryptoName,
                 amount: amount,
                 status: 'completed',
                 timestamp: Date.now()
             };
             
             // Sauvegarder la transaction
             saveTransaction(transaction);
             
             // Mettre √† jour le solde
             updateCryptoBalance(cryptoId, amount);
             
             // Fermer la modal de d√©p√¥t
             closeDepositModal();
             
             // Notification de succ√®s
             showNotification(`‚úÖ D√©p√¥t simul√©: ${amount.toFixed(6)} ${getCryptoSymbol(cryptoId)}`, 'success');
         }

         // Fonction pour forcer tous les soldes √† z√©ro
         function forceAllBalancesToZero() {
             const currentUser = sessionStorage.getItem('currentUser');
             if (!currentUser) return;
             
             // R√©initialiser compl√®tement les soldes crypto
             const userBalancesKey = `crypto_balances_${currentUser}`;
             localStorage.setItem(userBalancesKey, JSON.stringify({}));
             
             // R√©initialiser le solde bancaire
             const userBankingKey = `banking_balance_${currentUser}`;
             localStorage.setItem(userBankingKey, '0');
             
             // Mettre √† jour l'affichage
             updateTotalBalance();
             updateCryptoTotalBalance();
             
             // Mettre √† jour l'affichage du solde bancaire
             const bankingBalanceElement = document.querySelector('.account-balance .balance-amount');
             if (bankingBalanceElement) {
                 bankingBalanceElement.textContent = '‚Ç¨0.00';
             }
             
             // Forcer l'affichage de tous les soldes crypto √† 0.00 dans la liste
             forceDisplayZeroBalances();
             
             console.log(`üîÑ Tous les soldes forc√©s √† z√©ro pour ${currentUser}`);
         }
         
         // Fonction pour forcer l'affichage de tous les soldes crypto √† 0.00
         function forceDisplayZeroBalances() {
             // Liste de toutes les cryptos support√©es
             const supportedCryptos = [
                 'bitcoin', 'ethereum', 'solana', 'binancecoin', 'ripple', 
                 'dogecoin', 'cardano', 'shiba-inu', 'polkadot', 'matic-network', 'avalanche-2'
             ];
             
             // Forcer l'affichage √† 0.00 pour chaque crypto
             supportedCryptos.forEach(cryptoKey => {
                 const cryptoElement = document.querySelector(`[data-crypto="${cryptoKey}"]`);
                 if (cryptoElement) {
                     const valueAmount = cryptoElement.querySelector('.value-amount');
                     if (valueAmount) {
                         valueAmount.textContent = '‚Ç¨0.00';
                     }
                     
                     const cryptoAmount = cryptoElement.querySelector('.crypto-amount');
                     if (cryptoAmount) {
                         cryptoAmount.textContent = '0.000000';
                     }
                 }
             });
             
             console.log('üí∞ Affichage forc√© √† 0.00 pour tous les soldes crypto');
         }
         
         // Fonction pour nettoyer les anciens soldes fictifs
         function cleanupFictitiousBalances() {
             const currentUser = sessionStorage.getItem('currentUser');
             if (!currentUser) return;
             
             // V√©rifier s'il y a des anciens soldes fictifs
             const userBalancesKey = `crypto_balances_${currentUser}`;
             const savedBalances = JSON.parse(localStorage.getItem(userBalancesKey) || '{}');
             
             // Liste des soldes fictifs par d√©faut qui √©taient utilis√©s avant
             const fictitiousBalances = {
                 bitcoin: 0.125,
                 ethereum: 2.5,
                 solana: 15.75,
                 binancecoin: 8.25,
                 ripple: 1250.50,
                 dogecoin: 5000.00,
                 cardano: 125.75,
                 'shiba-inu': 500000.00,
                 polkadot: 25.50,
                 'matic-network': 150.25,
                 'avalanche-2': 12.75
             };
             
             let hasFictitiousBalances = false;
             
             // V√©rifier si l'utilisateur a des soldes fictifs
             Object.keys(fictitiousBalances).forEach(cryptoId => {
                 if (savedBalances[cryptoId] === fictitiousBalances[cryptoId]) {
                     hasFictitiousBalances = true;
                     // Supprimer le solde fictif
                     delete savedBalances[cryptoId];
                 }
             });
             
             // Si des soldes fictifs ont √©t√© trouv√©s, les supprimer
             if (hasFictitiousBalances) {
                 localStorage.setItem(userBalancesKey, JSON.stringify(savedBalances));
                 console.log(`üßπ Soldes fictifs supprim√©s pour ${currentUser}`);
                 
                 // Mettre √† jour l'affichage
                 updateTotalBalance();
                 updateCryptoTotalBalance();
             }
         }
         
         // Fonction pour r√©initialiser tous les soldes √† z√©ro (pour les nouveaux utilisateurs)
         function resetAllBalances() {
             const currentUser = sessionStorage.getItem('currentUser');
             if (!currentUser) return;
             
             // R√©initialiser les soldes crypto
             const userBalancesKey = `crypto_balances_${currentUser}`;
             localStorage.setItem(userBalancesKey, JSON.stringify({}));
             
             // R√©initialiser le solde bancaire
             const userBankingKey = `banking_balance_${currentUser}`;
             localStorage.setItem(userBankingKey, '0');
             
             // Mettre √† jour l'affichage
             updateTotalBalance();
             updateCryptoTotalBalance();
             
             // Mettre √† jour l'affichage du solde bancaire
             const bankingBalanceElement = document.querySelector('.account-balance .balance-amount');
             if (bankingBalanceElement) {
                 bankingBalanceElement.textContent = '‚Ç¨0.00';
             }
             
             showNotification('‚úÖ Tous les soldes ont √©t√© r√©initialis√©s √† z√©ro', 'success');
             console.log(`üîÑ Soldes r√©initialis√©s pour ${currentUser}`);
         }

         // Fonction pour afficher la modal de retrait bancaire
         function showBankingWithdrawModal() {
             const modal = document.createElement('div');
             modal.className = 'banking-withdraw-modal';
             modal.innerHTML = `
                 <div class="banking-withdraw-modal-content">
                     <div class="banking-withdraw-modal-header">
                         <h3>Retrait bancaire</h3>
                         <button class="close-btn" onclick="closeBankingWithdrawModal()">
                             <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                 <path d="M18 6L6 18M6 6l12 12"/>
                             </svg>
                         </button>
                     </div>
                     <div class="banking-withdraw-modal-body">
                         <div class="withdraw-options">
                             <div class="withdraw-option" onclick="selectWithdrawOption('eurx')">
                                 <div class="withdraw-option-icon">üíé</div>
                                 <div class="withdraw-option-info">
                                     <h4>EURX ETH</h4>
                                     <p>Solde: ${getCryptoBalance('eurx').toFixed(6)} EURX</p>
                                 </div>
                                 <div class="withdraw-option-arrow">
                                     <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                         <path d="M9 18l6-6-6-6"/>
                                     </svg>
                                 </div>
                             </div>
                             
                             <div class="withdraw-option" onclick="selectWithdrawOption('usdt')">
                                 <div class="withdraw-option-icon">üíµ</div>
                                 <div class="withdraw-option-info">
                                     <h4>USDT ETH</h4>
                                     <p>Solde: ${getCryptoBalance('usdt').toFixed(6)} USDT</p>
                                 </div>
                                 <div class="withdraw-option-arrow">
                                     <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                         <path d="M9 18l6-6-6-6"/>
                                     </svg>
                                 </div>
                             </div>
                         </div>
                     </div>
                 </div>
             `;

             document.body.appendChild(modal);
             
             // Afficher la modal avec animation
             setTimeout(() => {
                 modal.style.opacity = '1';
                 modal.querySelector('.banking-withdraw-modal-content').style.transform = 'translateY(0)';
             }, 10);

             // Fermer la modal en cliquant √† l'ext√©rieur
             modal.addEventListener('click', (e) => {
                 if (e.target === modal) {
                     closeBankingWithdrawModal();
                 }
             });

             // Fermer avec la touche Escape
             document.addEventListener('keydown', function closeOnEscape(e) {
                 if (e.key === 'Escape') {
                     closeBankingWithdrawModal();
                     document.removeEventListener('keydown', closeOnEscape);
                 }
             });
         }

         // Fonction pour fermer la modal de retrait bancaire
         function closeBankingWithdrawModal() {
             const modal = document.querySelector('.banking-withdraw-modal');
             if (modal) {
                 modal.style.opacity = '0';
                 modal.querySelector('.banking-withdraw-modal-content').style.transform = 'translateY(20px)';
                 setTimeout(() => {
                     modal.remove();
                 }, 300);
             }
         }

         // Fonction pour s√©lectionner une option de retrait
         function selectWithdrawOption(type) {
             const cryptoName = type === 'eurx' ? 'EURX ETH' : 'USDT ETH';
             const cryptoIcon = type === 'eurx' ? 'üíé' : 'üíµ';
             const balance = getCryptoBalance(type);
             
             // Fermer la modal de s√©lection
             closeBankingWithdrawModal();
             
             // Cr√©er la modal de retrait
             const modal = document.createElement('div');
             modal.className = 'banking-withdraw-modal';
             modal.innerHTML = `
                 <div class="banking-withdraw-modal-content">
                     <div class="banking-withdraw-modal-header">
                         <h3>Retrait ${cryptoName}</h3>
                         <button class="close-btn" onclick="closeBankingWithdrawModal()">
                             <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                 <path d="M18 6L6 18M6 6l12 12"/>
                             </svg>
                         </button>
                     </div>
                     <div class="banking-withdraw-modal-body">
                         <div class="crypto-info-header">
                             <div class="crypto-icon">${cryptoIcon}</div>
                             <div class="crypto-details">
                                 <h4>${cryptoName}</h4>
                                 <p>Solde disponible: ${balance.toFixed(6)} ${type.toUpperCase()}</p>
                             </div>
                         </div>
                         
                         <div class="withdraw-form">
                             <div class="form-group">
                                 <label>Montant √† retirer:</label>
                                 <div class="amount-input-group">
                                     <input type="number" id="withdrawAmount" placeholder="0.000000" step="0.000001" min="0" max="${balance}">
                                     <button class="max-btn" onclick="setMaxWithdrawAmount('${type}')">MAX</button>
                                 </div>
                             </div>
                             
                             <div class="form-group">
                                 <label>Adresse de destination:</label>
                                 <input type="text" id="withdrawAddress" placeholder="0x..." class="withdraw-input">
                                 <div class="address-validation" id="addressValidation"></div>
                             </div>
                             
                             <div class="withdraw-info">
                                 <div class="info-row">
                                     <span>Frais de retrait:</span>
                                     <span id="withdrawFees">‚Ç¨0.00</span>
                                 </div>
                                 <div class="info-row">
                                     <span>Montant re√ßu:</span>
                                     <span id="withdrawReceived">0.000000 ${type.toUpperCase()}</span>
                                 </div>
                             </div>
                             
                             <button class="withdraw-btn" id="withdrawBtn" onclick="executeBankingWithdraw('${type}')" disabled>
                                 <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                     <path d="M12 19V5M5 12l7-7 7 7"/>
                                 </svg>
                                 Retirer
                             </button>
                         </div>
                         
                         <button class="back-btn" onclick="showBankingWithdrawModal()">
                             <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                 <path d="M19 12H5"/>
                                 <path d="M12 19l-7-7 7-7"/>
                             </svg>
                             Retour au choix
                         </button>
                     </div>
                 </div>
             `;

             document.body.appendChild(modal);
             
             // Stocker le type de crypto pour les fonctions de validation
             modal.setAttribute('data-crypto-type', type);
             
             // Ajouter les event listeners avec le type de crypto
             document.getElementById('withdrawAmount').addEventListener('input', () => updateWithdrawInfo(type));
             document.getElementById('withdrawAddress').addEventListener('input', () => updateWithdrawInfo(type));
             
             // Afficher la modal avec animation
             setTimeout(() => {
                 modal.style.opacity = '1';
                 modal.querySelector('.banking-withdraw-modal-content').style.transform = 'translateY(0)';
             }, 10);

             // Fermer la modal en cliquant √† l'ext√©rieur
             modal.addEventListener('click', (e) => {
                 if (e.target === modal) {
                     closeBankingWithdrawModal();
                 }
             });

             // Fermer avec la touche Escape
             document.addEventListener('keydown', function closeOnEscape(e) {
                 if (e.key === 'Escape') {
                     closeBankingWithdrawModal();
                     document.removeEventListener('keydown', closeOnEscape);
                 }
             });
         }

         // Fonction pour d√©finir le montant maximum de retrait
         function setMaxWithdrawAmount(type) {
             const balance = getCryptoBalance(type);
             document.getElementById('withdrawAmount').value = balance.toFixed(6);
             updateWithdrawInfo();
         }

         // Fonction pour mettre √† jour les informations de retrait
         function updateWithdrawInfo(type) {
             const amount = parseFloat(document.getElementById('withdrawAmount').value) || 0;
             const address = document.getElementById('withdrawAddress').value.trim();
             const withdrawBtn = document.getElementById('withdrawBtn');
             const addressValidation = document.getElementById('addressValidation');
             
             // Calculer les frais (0.5% pour EURX, 1% pour USDT)
             const fees = amount * 0.005; // 0.5% par d√©faut
             const received = Math.max(0, amount - fees);
             
             // Mettre √† jour l'affichage
             document.getElementById('withdrawFees').textContent = formatPrice(fees);
             document.getElementById('withdrawReceived').textContent = `${received.toFixed(6)} ${type.toUpperCase()}`;
             
             // Valider l'adresse Ethereum
             let addressValid = false;
             let addressMessage = '';
             
             if (address.length === 0) {
                 addressMessage = '';
             } else if (!/^0x[a-fA-F0-9]{40}$/.test(address)) {
                 addressMessage = '‚ùå Adresse Ethereum invalide';
                 addressValidation.style.color = '#EF4444';
             } else {
                 addressMessage = '‚úÖ Adresse Ethereum valide';
                 addressValidation.style.color = '#10B981';
                 addressValid = true;
             }
             
             addressValidation.textContent = addressMessage;
             
             // V√©rifier le solde
             const currentBalance = getCryptoBalance(type);
             const balanceValid = amount <= currentBalance;
             
             // Activer/d√©sactiver le bouton
             if (amount > 0 && addressValid && balanceValid) {
                 withdrawBtn.disabled = false;
                 withdrawBtn.classList.add('active');
             } else {
                 withdrawBtn.disabled = true;
                 withdrawBtn.classList.remove('active');
             }
             
             // Afficher les messages d'erreur
             if (amount > currentBalance) {
                 showNotification('‚ùå Montant sup√©rieur au solde disponible', 'error');
             }
         }

         // Fonction pour ex√©cuter le d√©p√¥t bancaire
         function executeBankingDeposit(amount) {
             if (!amount || amount <= 0) {
                 showNotification('‚ùå Veuillez entrer un montant valide', 'error');
                 return;
             }
             
             // Cr√©er la transaction
             const transaction = {
                 id: generateTransactionId(),
                 type: 'banking_deposit',
                 cryptoId: 'banking',
                 cryptoName: 'Compte Bancaire',
                 amount: amount,
                 status: 'completed',
                 timestamp: Date.now()
             };
             
             // Sauvegarder la transaction
             saveTransaction(transaction);
             
             // Mettre √† jour le solde bancaire
             updateBankingBalance(amount);
             
             // Fermer la modal
             closeBankingDepositModal();
             
             // Notification de succ√®s
             showNotification(`‚úÖ D√©p√¥t bancaire effectu√© : ‚Ç¨${amount.toFixed(2)}`, 'success');
         }
         
         // Fonction pour ex√©cuter le retrait bancaire
         function executeBankingWithdraw(amount) {
             if (!amount || amount <= 0) {
                 showNotification('‚ùå Veuillez entrer un montant valide', 'error');
                 return;
             }
             
             // V√©rifier le solde bancaire
             const currentBalance = getBankingBalance();
             if (amount > currentBalance) {
                 showNotification('‚ùå Montant sup√©rieur au solde disponible', 'error');
                 return;
             }
             
             // Cr√©er la transaction
             const transaction = {
                 id: generateTransactionId(),
                 type: 'banking_withdraw',
                 cryptoId: 'banking',
                 cryptoName: 'Compte Bancaire',
                 amount: amount,
                 status: 'completed',
                 timestamp: Date.now()
             };
             
             // Sauvegarder la transaction
             saveTransaction(transaction);
             
             // Mettre √† jour le solde bancaire
             updateBankingBalance(-amount);
             
             // Fermer la modal
             closeBankingWithdrawModal();
             
             // Notification de succ√®s
             showNotification(`‚úÖ Retrait bancaire effectu√© : ‚Ç¨${amount.toFixed(2)}`, 'success');
         }

         // Fonction pour cr√©er des transactions de test (pour d√©monstration) - D√âSACTIV√âE
         function createTestTransactions() {
             showNotification('‚ö†Ô∏è Les transactions de test sont d√©sactiv√©es. Utilisez les vraies fonctions de d√©p√¥t/retrait.', 'warning');
             console.log('üö´ Fonction createTestTransactions d√©sactiv√©e pour √©viter les soldes fictifs');
         }

         // API gratuite pour les prix des cryptomonnaies
         const COINGECKO_API_URL = 'https://api.coingecko.com/api/v3';
         const COINCAP_API_URL = 'https://api.coincap.io/v2';

         // IDs des cryptomonnaies sur CoinGecko
         const CRYPTO_IDS = {
             bitcoin: 'bitcoin',
             ethereum: 'ethereum',
             solana: 'solana',
             bnb: 'binancecoin',
             xrp: 'ripple',
             dogecoin: 'dogecoin',
             cardano: 'cardano',
             shiba: 'shiba-inu',
             polkadot: 'polkadot',
             polygon: 'matic-network',
             avalanche: 'avalanche-2'
         };

         // Fonction pour formater les nombres
         function formatNumber(num) {
             if (num >= 1e9) return (num / 1e9).toFixed(1) + 'B';
             if (num >= 1e6) return (num / 1e6).toFixed(1) + 'M';
             if (num >= 1e3) return (num / 1e3).toFixed(1) + 'K';
             return num.toFixed(2);
         }

         // Fonction pour formater les prix
         function formatPrice(price) {
             if (price >= 1000) {
                 return '‚Ç¨' + price.toLocaleString('fr-FR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
             } else if (price >= 1) {
                 return '‚Ç¨' + price.toFixed(2);
             } else {
                 return '‚Ç¨' + price.toFixed(4);
             }
         }

         // Fonction pour r√©cup√©rer les donn√©es depuis CoinGecko (gratuit) - Optimis√©e
         async function fetchCryptoData() {
             try {
                              // V√©rifier d'abord si on a des donn√©es en arri√®re-plan
             const backgroundData = sessionStorage.getItem('background_crypto_prices');
             if (backgroundData) {
                 const parsed = JSON.parse(backgroundData);
                 const now = Date.now();
                 
                 // Utiliser les donn√©es en arri√®re-plan si elles sont r√©centes (moins de 10 minutes)
                 if (now - parsed.timestamp < 600000) { // 10 minutes = 600000 ms
                         console.log('‚úÖ Utilisation des donn√©es en arri√®re-plan (mise √† jour il y a', Math.round((now - parsed.timestamp) / 1000), 'secondes)');
                         
                         // Formater les donn√©es pour correspondre √† notre structure
                         const formattedData = {};
                         Object.entries(parsed.prices).forEach(([cryptoId, priceData]) => {
                             formattedData[cryptoId] = {
                                 name: getCryptoName(cryptoId),
                                 quote: {
                                     EUR: {
                                         price: priceData.price,
                                         percent_change_24h: priceData.change_24h,
                                         volume_24h: priceData.volume_24h,
                                         market_cap: priceData.market_cap,
                                         percent_change_7d: 0
                                     }
                                 }
                             };
                         });
                         
                         // Mettre √† jour le timestamp de derni√®re mise √† jour
                         sessionStorage.setItem('last_price_update', now.toString());
                         sessionStorage.setItem('last_display_update', now.toString());
                         
                         return formattedData;
                     }
                 }

                 // Si pas de donn√©es en arri√®re-plan r√©centes, d√©marrer le syst√®me
                 if (!window.backgroundPriceUpdater || !window.backgroundPriceUpdater.isRunning) {
                     console.log('üöÄ D√©marrage du syst√®me de mise √† jour en arri√®re-plan...');
                     if (window.backgroundPriceUpdater) {
                         window.backgroundPriceUpdater.start();
                     }
                 }

                 // Cache pour √©viter les requ√™tes r√©p√©t√©es
                 const cacheKey = 'crypto_prices_cache';
                 const cached = sessionStorage.getItem(cacheKey);
                 const now = Date.now();
                 
                 if (cached) {
                     const cachedData = JSON.parse(cached);
                     // Cache valide pendant 10 minutes maximum
                     if (now - cachedData.timestamp < 600000) { // 10 minutes = 600000 ms
                         console.log('üìä Utilisation du cache pour les prix');
                         return cachedData.data;
                     }
                 }

                 console.log('üîÑ R√©cup√©ration des prix en temps r√©el...');
                 
                 const ids = Object.values(CRYPTO_IDS).join(',');
                 const response = await fetch(`${COINGECKO_API_URL}/simple/price?ids=${ids}&vs_currencies=eur&include_24hr_change=true&include_24hr_vol=true&include_market_cap=true&include_last_updated_at=true`, {
                     headers: {
                         'Accept': 'application/json',
                         'Cache-Control': 'no-cache',
                         'Pragma': 'no-cache'
                     }
                 });

                 if (!response.ok) {
                     throw new Error('Erreur API CoinGecko');
                 }

                 const data = await response.json();
                 
                 // Formater les donn√©es pour correspondre √† notre structure
                 const formattedData = {};
                 Object.keys(data).forEach(cryptoId => {
                     const cryptoData = data[cryptoId];
                     formattedData[cryptoId] = {
                         name: getCryptoName(cryptoId),
                         quote: {
                             EUR: {
                                 price: cryptoData.eur,
                                 percent_change_24h: cryptoData.eur_24h_change,
                                 volume_24h: cryptoData.eur_24h_vol,
                                 market_cap: cryptoData.eur_market_cap,
                                 percent_change_7d: cryptoData.eur_7d_change || 0
                             }
                         }
                     };
                 });

                 // Mettre en cache avec timestamp
                 sessionStorage.setItem(cacheKey, JSON.stringify({
                     data: formattedData,
                     timestamp: now
                 }));
                 
                 // Enregistrer le timestamp de la derni√®re mise √† jour
                 sessionStorage.setItem('last_price_update', now.toString());
                 
                 console.log('‚úÖ Prix mis √† jour:', new Date(now).toLocaleTimeString('fr-FR'));
                 
                 return formattedData;
             } catch (error) {
                 console.error('Erreur lors de la r√©cup√©ration des donn√©es:', error);
                 
                 // Fallback vers CoinCap si CoinGecko √©choue
                 try {
                     return await fetchCryptoDataFromCoinCap();
                 } catch (fallbackError) {
                     console.error('Erreur fallback CoinCap:', fallbackError);
                     return null;
                 }
             }
         }

         // Fonction de fallback avec CoinCap
         async function fetchCryptoDataFromCoinCap() {
             try {
                 const response = await fetch(`${COINCAP_API_URL}/assets?ids=${Object.values(CRYPTO_IDS).join(',')}`);
                 
                 if (!response.ok) {
                     throw new Error('Erreur API CoinCap');
                 }

                 const data = await response.json();
                 
                 // Formater les donn√©es CoinCap
                 const formattedData = {};
                 data.data.forEach(crypto => {
                     const cryptoId = getCryptoIdFromSymbol(crypto.symbol);
                     if (cryptoId) {
                         formattedData[cryptoId] = {
                             name: crypto.name,
                             quote: {
                                 EUR: {
                                     price: parseFloat(crypto.priceUsd) * 0.85, // Conversion USD vers EUR approximative
                                     percent_change_24h: parseFloat(crypto.changePercent24Hr),
                                     volume_24h: parseFloat(crypto.volumeUsd24Hr) * 0.85,
                                     market_cap: parseFloat(crypto.marketCapUsd) * 0.85,
                                     percent_change_7d: 0 // CoinCap ne fournit pas les donn√©es 7j
                                 }
                             }
                         };
                     }
                 });
                 
                 return formattedData;
             } catch (error) {
                 console.error('Erreur CoinCap:', error);
                 return null;
             }
         }

         // Fonction pour obtenir le nom d'une crypto
         function getCryptoName(cryptoId) {
             const names = {
                 'bitcoin': 'Bitcoin',
                 'ethereum': 'Ethereum',
                 'binancecoin': 'BNB',
                 'solana': 'Solana',
                 'ripple': 'XRP',
                 'dogecoin': 'Dogecoin',
                 'cardano': 'Cardano',
                 'shiba-inu': 'Shiba Inu',
                 'avalanche-2': 'Avalanche',
                 'polkadot': 'Polkadot',
                 'matic-network': 'Polygon',
                 'chainlink': 'Chainlink'
             };
             return names[cryptoId] || cryptoId;
         }

         // Fonction pour obtenir l'ID crypto depuis le symbole
         function getCryptoIdFromSymbol(symbol) {
             const symbolMap = {
                 'BTC': 'bitcoin',
                 'ETH': 'ethereum',
                 'BNB': 'binancecoin',
                 'SOL': 'solana',
                 'XRP': 'ripple',
                 'DOGE': 'dogecoin',
                 'ADA': 'cardano',
                 'SHIB': 'shiba-inu',
                 'AVAX': 'avalanche-2',
                 'DOT': 'polkadot',
                 'MATIC': 'matic-network',
                 'LINK': 'chainlink'
             };
             return symbolMap[symbol];
         }

         // Fonction pour g√©n√©rer un graphique SVG bas√© sur les donn√©es
         function generateChartSVG(prices, isPositive = true) {
             if (!prices || prices.length < 2) {
                 // Graphique par d√©faut si pas de donn√©es
                 return `M0,15 L15,12 L30,18 L45,10 L60,15`;
             }
             
             const width = 60;
             const height = 30;
             const padding = 5;
             const chartWidth = width - (padding * 2);
             const chartHeight = height - (padding * 2);
             
             // Normaliser les prix entre 0 et chartHeight
             const minPrice = Math.min(...prices);
             const maxPrice = Math.max(...prices);
             const priceRange = maxPrice - minPrice;
             
             const points = prices.map((price, index) => {
                 const x = padding + (index / (prices.length - 1)) * chartWidth;
                 const normalizedPrice = priceRange === 0 ? chartHeight / 2 : (price - minPrice) / priceRange;
                 const y = height - padding - (normalizedPrice * chartHeight);
                 return `${x},${y}`;
             });
             
             return `M${points.join(' L')}`;
         }

         // Fonction pour r√©cup√©rer les top gainers et losers en temps r√©el depuis CoinMarketCap
         async function fetchTopPerformers() {
             try {
                 console.log('üîÑ R√©cup√©ration des top gainers et losers depuis CoinMarketCap...');
                 
                 // Utiliser l'API publique de CoinMarketCap
                 const response = await fetch('https://api.coinmarketcap.com/data-api/v3/cryptocurrency/listing?start=1&limit=100&sortBy=market_cap&sortType=desc&convert=EUR&cryptoType=all&tagType=all&audited=false&aux=price,volume_24h,percent_change_24h,market_cap', {
                     headers: {
                         'Accept': 'application/json',
                         'Cache-Control': 'no-cache',
                         'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'
                     }
                 });

                 if (!response.ok) {
                     throw new Error(`Erreur API CoinMarketCap: ${response.status} ${response.statusText}`);
                 }

                 const data = await response.json();
                 console.log('üìä Donn√©es CoinMarketCap re√ßues:', data);
                 
                 if (!data.data || !data.data.cryptoCurrencyList) {
                     throw new Error('Format de donn√©es CoinMarketCap invalide');
                 }
                 
                 const cryptoList = data.data.cryptoCurrencyList;
                 console.log('üìä Liste des cryptos:', cryptoList.length, '√©l√©ments');
                 
                 // Trier par performance 24h
                 const sortedByChange = cryptoList.sort((a, b) => b.quotes[0].percentChange24h - a.quotes[0].percentChange24h);
                 
                 // Top gainer (premier de la liste)
                 const topGainer = sortedByChange[0];
                 
                 // Top loser (dernier de la liste)
                 const topLoser = sortedByChange[sortedByChange.length - 1];
                 
                 console.log('üèÜ Top Gainer:', topGainer.name, topGainer.quotes[0].percentChange24h + '%');
                 console.log('üìâ Top Loser:', topLoser.name, topLoser.quotes[0].percentChange24h + '%');
                 
                 return {
                     topGainer: {
                         name: topGainer.name,
                         symbol: topGainer.symbol,
                         price: topGainer.quotes[0].price,
                         change24h: topGainer.quotes[0].percentChange24h,
                         image: `https://s2.coinmarketcap.com/static/img/coins/64x64/${topGainer.id}.png`,
                         source: 'CoinMarketCap'
                     },
                     topLoser: {
                         name: topLoser.name,
                         symbol: topLoser.symbol,
                         price: topLoser.quotes[0].price,
                         change24h: topLoser.quotes[0].percentChange24h,
                         image: `https://s2.coinmarketcap.com/static/img/coins/64x64/${topLoser.id}.png`,
                         source: 'CoinMarketCap'
                     }
                 };
             } catch (error) {
                 console.error('‚ùå Erreur lors de la r√©cup√©ration depuis CoinMarketCap:', error);
                 
                 // Fallback vers CoinGecko si CoinMarketCap √©choue
                 try {
                     console.log('üîÑ Fallback vers CoinGecko...');
                     const geckoResponse = await fetch('https://api.coingecko.com/api/v3/coins/markets?vs_currency=eur&order=market_cap_desc&per_page=100&page=1&sparkline=false&price_change_percentage=24h', {
                         headers: {
                             'Accept': 'application/json',
                             'Cache-Control': 'no-cache'
                         }
                     });

                     if (!geckoResponse.ok) {
                         throw new Error(`Erreur API CoinGecko: ${geckoResponse.status} ${geckoResponse.statusText}`);
                     }

                     const geckoData = await geckoResponse.json();
                     console.log('üìä Donn√©es CoinGecko re√ßues:', geckoData.length, '√©l√©ments');
                     
                     const sortedByChange = geckoData.sort((a, b) => b.price_change_percentage_24h - a.price_change_percentage_24h);
                     
                     const topGainer = sortedByChange[0];
                     const topLoser = sortedByChange[sortedByChange.length - 1];
                     
                     console.log('üèÜ Top Gainer (CoinGecko):', topGainer.name, topGainer.price_change_percentage_24h + '%');
                     console.log('üìâ Top Loser (CoinGecko):', topLoser.name, topLoser.price_change_percentage_24h + '%');
                     
                     return {
                         topGainer: {
                             name: topGainer.name,
                             symbol: topGainer.symbol.toUpperCase(),
                             price: topGainer.current_price,
                             change24h: topGainer.price_change_percentage_24h,
                             image: topGainer.image,
                             source: 'CoinGecko'
                         },
                         topLoser: {
                             name: topLoser.name,
                             symbol: topLoser.symbol.toUpperCase(),
                             price: topLoser.current_price,
                             change24h: topLoser.price_change_percentage_24h,
                             image: topLoser.image,
                             source: 'CoinGecko'
                         }
                     };
                 } catch (fallbackError) {
                     console.error('‚ùå Erreur fallback CoinGecko:', fallbackError);
                     
                     // Fallback final avec des donn√©es statiques si toutes les APIs √©chouent
                     console.log('üîÑ Utilisation des donn√©es de fallback...');
                     return {
                         topGainer: {
                             name: 'Bitcoin',
                             symbol: 'BTC',
                             price: 45000,
                             change24h: 5.2,
                             image: 'https://s2.coinmarketcap.com/static/img/coins/64x64/1.png',
                             source: 'Fallback'
                         },
                         topLoser: {
                             name: 'Dogecoin',
                             symbol: 'DOGE',
                             price: 0.08,
                             change24h: -3.1,
                             image: 'https://s2.coinmarketcap.com/static/img/coins/64x64/74.png',
                             source: 'Fallback'
                         }
                     };
                 }
             }
         }

         // Fonction pour mettre √† jour l'affichage des top performers
         async function updateTopPerformersDisplay() {
             try {
                 const performers = await fetchTopPerformers();
                 
                 // Mettre √† jour le top gainer
                 const topGainerName = document.getElementById('topGainerName');
                 const topGainerChangeValue = document.getElementById('topGainerChangeValue');
                 const topGainerPrice = document.getElementById('topGainerPrice');
                 const topGainerChange = document.getElementById('topGainerChange');
                 
                 if (topGainerName && topGainerChangeValue && topGainerPrice && topGainerChange) {
                     topGainerName.textContent = performers.topGainer.name;
                     topGainerChangeValue.textContent = `${performers.topGainer.change24h > 0 ? '+' : ''}${performers.topGainer.change24h.toFixed(2)}%`;
                     topGainerPrice.textContent = `‚Ç¨${performers.topGainer.price.toLocaleString('fr-FR', { minimumFractionDigits: 2, maximumFractionDigits: 6 })}`;
                     
                     // Mettre √† jour la classe CSS selon la performance
                     if (performers.topGainer.change24h > 0) {
                         topGainerChange.className = 'performer-change positive';
                         topGainerChange.querySelector('.change-icon').textContent = '‚Üó';
                     } else {
                         topGainerChange.className = 'performer-change negative';
                         topGainerChange.querySelector('.change-icon').textContent = '‚Üò';
                     }
                 }
                 
                 // Mettre √† jour le top loser
                 const topLoserName = document.getElementById('topLoserName');
                 const topLoserChangeValue = document.getElementById('topLoserChangeValue');
                 const topLoserPrice = document.getElementById('topLoserPrice');
                 const topLoserChange = document.getElementById('topLoserChange');
                 
                 if (topLoserName && topLoserChangeValue && topLoserPrice && topLoserChange) {
                     topLoserName.textContent = performers.topLoser.name;
                     topLoserChangeValue.textContent = `${performers.topLoser.change24h > 0 ? '+' : ''}${performers.topLoser.change24h.toFixed(2)}%`;
                     topLoserPrice.textContent = `‚Ç¨${performers.topLoser.price.toLocaleString('fr-FR', { minimumFractionDigits: 2, maximumFractionDigits: 6 })}`;
                     
                     // Mettre √† jour la classe CSS selon la performance
                     if (performers.topLoser.change24h > 0) {
                         topLoserChange.className = 'performer-change positive';
                         topLoserChange.querySelector('.change-icon').textContent = '‚Üó';
                     } else {
                         topLoserChange.className = 'performer-change negative';
                         topLoserChange.querySelector('.change-icon').textContent = '‚Üò';
                     }
                 }
                 
                 // Afficher la source des donn√©es dans la console
                 console.log(`‚úÖ Top performers mis √† jour (${new Date().toLocaleTimeString('fr-FR')}) - Source: ${performers.topGainer.source}`);
                 console.log(`üìä Top Gainer: ${performers.topGainer.name} (${performers.topGainer.change24h > 0 ? '+' : ''}${performers.topGainer.change24h.toFixed(2)}%)`);
                 console.log(`üìä Top Loser: ${performers.topLoser.name} (${performers.topLoser.change24h > 0 ? '+' : ''}${performers.topLoser.change24h.toFixed(2)}%)`);
                 
                 // Mettre en cache avec timestamp
                 sessionStorage.setItem('top_performers_cache', JSON.stringify({
                     data: performers,
                     timestamp: Date.now()
                 }));
                 
             } catch (error) {
                 console.error('Erreur lors de la mise √† jour des top performers:', error);
             }
         }

         // Fonction pour d√©marrer la mise √† jour automatique des top performers
         function startTopPerformersUpdate() {
             console.log('üöÄ D√©marrage du syst√®me de mise √† jour des top performers...');
             
             // V√©rifier s'il y a des donn√©es en cache r√©centes
             const cachedData = sessionStorage.getItem('top_performers_cache');
             if (cachedData) {
                 const parsed = JSON.parse(cachedData);
                 const now = Date.now();
                 
                 // Utiliser le cache si les donn√©es ont moins de 5 minutes
                 if (now - parsed.timestamp < 300000) { // 5 minutes
                     console.log('üìä Utilisation du cache pour les top performers');
                     updateTopPerformersDisplayFromData(parsed.data);
                 }
             }
             
             // Mise √† jour initiale
             console.log('üîÑ Lancement de la mise √† jour initiale...');
             updateTopPerformersDisplay();
             
             // Mise √† jour toutes les 2 minutes
             setInterval(updateTopPerformersDisplay, 120000);
             
             console.log('‚úÖ Syst√®me de mise √† jour des top performers d√©marr√©');
         }

         // Fonction de test manuel pour forcer la mise √† jour
         function forceUpdateTopPerformers() {
             console.log('üîß Test manuel - For√ßage de la mise √† jour des top performers...');
             updateTopPerformersDisplay();
         }

         // Exposer la fonction globalement pour le d√©bogage
         window.forceUpdateTopPerformers = forceUpdateTopPerformers;

         // Fonction pour mettre √† jour l'affichage avec des donn√©es fournies
         function updateTopPerformersDisplayFromData(performers) {
             // Mettre √† jour le top gainer
             const topGainerName = document.getElementById('topGainerName');
             const topGainerChangeValue = document.getElementById('topGainerChangeValue');
             const topGainerPrice = document.getElementById('topGainerPrice');
             const topGainerChange = document.getElementById('topGainerChange');
             
             if (topGainerName && topGainerChangeValue && topGainerPrice && topGainerChange) {
                 topGainerName.textContent = performers.topGainer.name;
                 topGainerChangeValue.textContent = `${performers.topGainer.change24h > 0 ? '+' : ''}${performers.topGainer.change24h.toFixed(2)}%`;
                 topGainerPrice.textContent = `‚Ç¨${performers.topGainer.price.toLocaleString('fr-FR', { minimumFractionDigits: 2, maximumFractionDigits: 6 })}`;
                 
                 // Mettre √† jour la classe CSS selon la performance
                 if (performers.topGainer.change24h > 0) {
                     topGainerChange.className = 'performer-change positive';
                     topGainerChange.querySelector('.change-icon').textContent = '‚Üó';
                 } else {
                     topGainerChange.className = 'performer-change negative';
                     topGainerChange.querySelector('.change-icon').textContent = '‚Üò';
                 }
             }
             
             // Mettre √† jour le top loser
             const topLoserName = document.getElementById('topLoserName');
             const topLoserChangeValue = document.getElementById('topLoserChangeValue');
             const topLoserPrice = document.getElementById('topLoserPrice');
             const topLoserChange = document.getElementById('topLoserChange');
             
             if (topLoserName && topLoserChangeValue && topLoserPrice && topLoserChange) {
                 topLoserName.textContent = performers.topLoser.name;
                 topLoserChangeValue.textContent = `${performers.topLoser.change24h > 0 ? '+' : ''}${performers.topLoser.change24h.toFixed(2)}%`;
                 topLoserPrice.textContent = `‚Ç¨${performers.topLoser.price.toLocaleString('fr-FR', { minimumFractionDigits: 2, maximumFractionDigits: 6 })}`;
                 
                 // Mettre √† jour la classe CSS selon la performance
                 if (performers.topLoser.change24h > 0) {
                     topLoserChange.className = 'performer-change positive';
                     topLoserChange.querySelector('.change-icon').textContent = '‚Üó';
                 } else {
                     topLoserChange.className = 'performer-change negative';
                     topLoserChange.querySelector('.change-icon').textContent = '‚Üò';
                 }
             }
         }

         // Fonction pour mettre √† jour l'affichage (optimis√©e)
         async function updateCryptoDisplay(cryptoData) {
             // Si pas de donn√©es fournies, essayer de les r√©cup√©rer depuis sessionStorage
             if (!cryptoData) {
                 const backgroundData = sessionStorage.getItem('background_crypto_prices');
                 if (backgroundData) {
                     const parsed = JSON.parse(backgroundData);
                     cryptoData = parsed.prices;
                 } else {
                     console.warn('‚ùå Aucune donn√©e crypto disponible pour la mise √† jour');
                     return;
                 }
             }

             // V√©rifier l'√¢ge des donn√©es
             const now = Date.now();
             const backgroundData = sessionStorage.getItem('background_crypto_prices');
             if (backgroundData) {
                 const parsed = JSON.parse(backgroundData);
                 const dataAge = now - parsed.timestamp;
                 
                 if (dataAge > 600000) { // Plus de 10 minutes
                     console.warn('‚ö†Ô∏è Donn√©es trop anciennes:', Math.round(dataAge / 1000 / 60), 'minutes');
                     return;
                 }
             }

             const updateTime = new Date().toLocaleTimeString('fr-FR');
             console.log(`üîÑ Mise √† jour affichage - ${updateTime}`);
             
             // Mettre √† jour le solde total apr√®s la mise √† jour des prix
             updateTotalBalance();
             
             // Mettre √† jour le solde crypto total apr√®s la mise √† jour des prix
             updateCryptoTotalBalance();

             // Mise √† jour de chaque crypto
             for (const cryptoKey of Object.keys(CRYPTO_IDS)) {
                 try {
                     const cryptoId = CRYPTO_IDS[cryptoKey];
                     const crypto = cryptoData[cryptoId];
                 
                 if (crypto) {
                     // G√©rer les deux formats de donn√©es (CoinGecko et BackgroundPriceUpdater)
                     let price, change24h, volume24h, marketCap;
                     
                     if (crypto.quote && crypto.quote.EUR) {
                         // Format CoinGecko
                         price = crypto.quote.EUR.price;
                         change24h = crypto.quote.EUR.percent_change_24h;
                         volume24h = crypto.quote.EUR.volume_24h;
                         marketCap = crypto.quote.EUR.market_cap;
                     } else {
                         // Format BackgroundPriceUpdater
                         price = crypto.price;
                         change24h = crypto.change_24h;
                         volume24h = crypto.volume_24h;
                         marketCap = crypto.market_cap;
                     }
                     
                     // V√©rifier que les donn√©es de prix sont valides
                     if (!price || isNaN(price)) {
                         console.warn(`‚ö†Ô∏è Prix invalide pour ${cryptoKey}:`, price);
                         // Essayer de r√©cup√©rer le prix depuis les donn√©es alternatives
                         const alternativeData = sessionStorage.getItem('alternative_crypto_prices');
                         if (alternativeData) {
                             const altPrices = JSON.parse(alternativeData);
                             if (altPrices[cryptoKey]) {
                                 price = altPrices[cryptoKey];
                                 change24h = 0; // Valeur par d√©faut
                             } else {
                                 continue;
                             }
                         } else {
                             continue;
                         }
                     }
                     
                     // Mise √† jour dans la liste principale
                     const cryptoElement = document.querySelector(`[data-crypto="${cryptoKey}"]`);
                     if (cryptoElement) {
                         const valueAmount = cryptoElement.querySelector('.value-amount');
                         const valueChange = cryptoElement.querySelector('.value-change');
                         const cryptoPrice = cryptoElement.querySelector('.crypto-price');
                         
                         // Mise √† jour du prix individuel
                         if (cryptoPrice) {
                             cryptoPrice.textContent = formatPrice(price);
                             
                             // Indicateur visuel de mise √† jour
                             cryptoPrice.style.transition = 'all 0.3s ease';
                             cryptoPrice.style.backgroundColor = 'rgba(0, 122, 61, 0.1)';
                             cryptoPrice.style.transform = 'scale(1.02)';
                             setTimeout(() => {
                                 cryptoPrice.style.backgroundColor = 'transparent';
                                 cryptoPrice.style.transform = 'scale(1)';
                             }, 300);
                         }
                         
                         if (valueAmount) {
                             // Calculer la valeur totale bas√©e sur le solde
                             const balance = getCryptoBalance(cryptoKey);
                             const totalValue = price * balance;
                             
                             // Mise √† jour imm√©diate sans animation pour √©viter les anciens prix
                             valueAmount.textContent = formatPrice(totalValue);
                             
                             // Ajouter un indicateur visuel de mise √† jour plus visible
                             valueAmount.style.transition = 'all 0.3s ease';
                             valueAmount.style.backgroundColor = 'rgba(0, 122, 61, 0.2)';
                             valueAmount.style.transform = 'scale(1.05)';
                             setTimeout(() => {
                                 valueAmount.style.backgroundColor = 'transparent';
                                 valueAmount.style.transform = 'scale(1)';
                             }, 300);
                         }
                         
                         // Mise √† jour du graphique miniature avec des donn√©es synchronis√©es
                         const chartElement = cryptoElement.querySelector('.chart-line');
                         if (chartElement) {
                             // Utiliser les m√™mes donn√©es que les graphiques principaux
                             const chartData = generateRealisticChartData(cryptoKey, '24H');
                             
                             // Extraire les prix du graphique pour la coh√©rence
                             const chartPrices = chartData.map(point => point.y);
                             
                             // Calculer le pourcentage de changement bas√© sur les donn√©es du graphique
                             if (chartPrices.length >= 2) {
                                 const firstPrice = chartPrices[0];
                                 const lastPrice = chartPrices[chartPrices.length - 1];
                                 const calculatedChange = ((lastPrice - firstPrice) / firstPrice) * 100;
                                 
                                 // Mettre √† jour le pourcentage avec la valeur calcul√©e du graphique
                                 if (valueChange) {
                                     const changeText = `${calculatedChange >= 0 ? '+' : ''}${calculatedChange.toFixed(2)}%`;
                                     valueChange.textContent = changeText;
                                     valueChange.className = `value-change ${calculatedChange >= 0 ? 'positive' : 'negative'}`;
                                     
                                     // Indicateur visuel plus visible
                                     valueChange.style.transition = 'all 0.3s ease';
                                     valueChange.style.backgroundColor = 'rgba(0, 122, 61, 0.2)';
                                     valueChange.style.transform = 'scale(1.05)';
                                     setTimeout(() => {
                                         valueChange.style.backgroundColor = 'transparent';
                                         valueChange.style.transform = 'scale(1)';
                                     }, 300);
                                 }
                             }
                             
                             // G√©n√©rer le SVG du graphique miniature
                             const chartPath = generateChartSVG(chartPrices, change24h >= 0);
                             chartElement.setAttribute('d', chartPath);
                             
                             // Mettre √† jour la couleur du graphique
                             const chartColor = change24h >= 0 ? '#10B981' : '#EF4444';
                             chartElement.style.stroke = chartColor;
                             
                             // Mettre √† jour le point final
                             const dotElement = cryptoElement.querySelector('.chart-dot');
                             if (dotElement) {
                                 dotElement.style.fill = chartColor;
                             }
                         } else {
                             // Fallback si pas de graphique : mettre √† jour le pourcentage normalement
                             if (valueChange) {
                                 const changeText = `${change24h >= 0 ? '+' : ''}${change24h.toFixed(2)}%`;
                                 valueChange.textContent = changeText;
                                 valueChange.className = `value-change ${change24h >= 0 ? 'positive' : 'negative'}`;
                                 
                                 // Indicateur visuel plus visible
                                 valueChange.style.transition = 'all 0.3s ease';
                                 valueChange.style.backgroundColor = 'rgba(0, 122, 61, 0.2)';
                                 valueChange.style.transform = 'scale(1.05)';
                                 setTimeout(() => {
                                     valueChange.style.backgroundColor = 'transparent';
                                     valueChange.style.transform = 'scale(1)';
                                 }, 300);
                             }
                         }
                     }
                     
                     // Mise √† jour des donn√©es pour la page de d√©tail
                     updateCryptoDetailData(cryptoKey, {
                         name: crypto.name,
                         price: formatPrice(price),
                         change: `${change24h >= 0 ? '+' : ''}${change24h.toFixed(2)}%`,
                         changeClass: change24h >= 0 ? 'positive' : 'negative',
                         currentPrice: formatPrice(price),
                         change24h: `${change24h >= 0 ? '+' : ''}${change24h.toFixed(2)}%`,
                         change7d: `${crypto.quote.EUR.percent_change_7d >= 0 ? '+' : ''}${crypto.quote.EUR.percent_change_7d.toFixed(2)}%`,
                         volume: '‚Ç¨' + formatNumber(volume24h),
                         marketCap: '‚Ç¨' + formatNumber(marketCap),
                         balance: getCryptoBalance(cryptoKey)
                     });
                     
                     console.log(`üìä ${crypto.name}: ‚Ç¨${price.toLocaleString('fr-FR')} (${change24h >= 0 ? '+' : ''}${change24h.toFixed(2)}%)`);
                 }
             } catch (error) {
                 console.warn(`‚ö†Ô∏è Erreur lors de la mise √† jour de ${cryptoKey}:`, error);
             }
         }

             // Mise √† jour de l'horodatage
             updateTimestamp();
             
             // Afficher un message de succ√®s
             console.log(`‚úÖ Affichage mis √† jour - ${updateTime}`);
         }

         // Fonction pour obtenir le solde d'une crypto
         function getCryptoBalance(cryptoKey) {
             const balances = {
                 bitcoin: 0.000,
                 ethereum: 0.000,
                 bnb: 0.000,
                 solana: 0.000,
                 xrp: 0.000,
                 cardano: 0.000,
                 avalanche: 0.000,
                 polkadot: 0.000,
                 polygon: 0.000,
                 chainlink: 0.000
             };
             return balances[cryptoKey] || 0;
         }

         // Fonction pour mettre √† jour les donn√©es de d√©tail
         function updateCryptoDetailData(cryptoKey, data) {
             window.cryptoDetailData = window.cryptoDetailData || {};
             window.cryptoDetailData[cryptoKey] = data;
         }

         // Fonction pour mettre √† jour l'horodatage
         function updateTimestamp() {
             const now = new Date();
             const timestamp = now.toLocaleString('fr-FR', {
                 year: 'numeric',
                 month: '2-digit',
                 day: '2-digit',
                 hour: '2-digit',
                 minute: '2-digit',
                 second: '2-digit'
             });
             
             // Ajouter l'horodatage dans le header
             const header = document.querySelector('.page-header');
             if (header) {
                 let timestampElement = header.querySelector('.timestamp');
                 if (!timestampElement) {
                     timestampElement = document.createElement('div');
                     timestampElement.className = 'timestamp';
                     timestampElement.style.cssText = 'font-size: 12px; color: #6B7280; text-align: right; margin-top: 8px;';
                     header.appendChild(timestampElement);
                 }
                 timestampElement.textContent = `Derni√®re mise √† jour: ${timestamp}`;
             }
             
             // Mettre √† jour l'indicateur de derni√®re mise √† jour
             const lastUpdateElement = document.getElementById('lastUpdateTime');
             if (lastUpdateElement) {
                 const timeString = now.toLocaleTimeString('fr-FR', {
                     hour: '2-digit',
                     minute: '2-digit',
                     second: '2-digit'
                 });
                 lastUpdateElement.textContent = `Derni√®re: ${timeString}`;
             }
             
             // Stocker le timestamp de la derni√®re mise √† jour
             sessionStorage.setItem('last_display_update', now.getTime().toString());
         }

         // Fonction pour d√©marrer les mises √† jour automatiques
         async function startRealTimeUpdates() {
             // Premi√®re mise √† jour imm√©diate
             const data = await fetchCryptoData();
             await updateCryptoDisplay(data);
             
             // Mise √† jour toutes les 5 secondes (plus stable)
             setInterval(async () => {
                 try {
                     const data = await fetchCryptoData();
                     await updateCryptoDisplay(data);
                 } catch (error) {
                     // Erreur silencieuse pour √©viter le spam
                     console.warn('‚ö†Ô∏è Erreur mise √† jour automatique:', error);
                 }
             }, 5000);
             
             console.log('‚ö° Mises √† jour prix activ√©es - Toutes les 5 secondes');
         }

         // D√©marrer les mises √† jour au chargement de la page
         document.addEventListener('DOMContentLoaded', function() {
             // D√©marrer le syst√®me de mise √† jour en arri√®re-plan s'il n'est pas d√©j√† en cours
             if (!window.backgroundPriceUpdater || !window.backgroundPriceUpdater.isRunning) {
                 console.log('üöÄ D√©marrage du syst√®me de mise √† jour en arri√®re-plan...');
                 
                 // Cr√©er l'instance si elle n'existe pas
                 if (!window.backgroundPriceUpdater) {
                     window.backgroundPriceUpdater = new BackgroundPriceUpdater();
                 }
                 
                 window.backgroundPriceUpdater.start();
             } else {
                 console.log('‚úÖ Syst√®me de mise √† jour en arri√®re-plan d√©j√† en cours');
             }

             // V√©rifier que Chart.js est charg√©
             if (typeof Chart === 'undefined') {
                 console.warn('‚ö†Ô∏è Chart.js n\'est pas charg√© - chargement en cours...');
                 // Attendre que Chart.js se charge
                 setTimeout(() => {
                     if (typeof Chart !== 'undefined') {
                         console.log('‚úÖ Chart.js charg√© avec succ√®s');
                     } else {
                         console.warn('‚ö†Ô∏è Chart.js toujours non disponible');
                     }
                 }, 2000);
             } else {
                 console.log('‚úÖ Chart.js charg√© avec succ√®s');
             }
             
             // V√©rifier que l'adaptateur de date est charg√©
             if (typeof Chart !== 'undefined' && (typeof Chart.adapters === 'undefined' || typeof Chart.adapters.date === 'undefined')) {
                 console.warn('‚ö†Ô∏è Chart.js date adapter n\'est pas charg√© - chargement en cours...');
                 // Attendre que l'adaptateur se charge
                 setTimeout(() => {
                     if (typeof Chart !== 'undefined' && typeof Chart.adapters !== 'undefined' && typeof Chart.adapters.date !== 'undefined') {
                         console.log('‚úÖ Chart.js date adapter charg√© avec succ√®s');
                     } else {
                         console.warn('‚ö†Ô∏è Chart.js date adapter toujours non disponible');
                     }
                 }, 2000);
             } else if (typeof Chart !== 'undefined') {
                 console.log('‚úÖ Chart.js date adapter charg√© avec succ√®s');
             }
             
             // Nettoyer le cache au d√©marrage
             sessionStorage.removeItem('crypto_prices_cache');
             
             // D√©marrer les mises √† jour temps r√©el
             startRealTimeUpdates();
             
             // Forcer une premi√®re mise √† jour imm√©diate
             setTimeout(async () => {
                 console.log('üöÄ Premi√®re mise √† jour forc√©e...');
                 sessionStorage.removeItem('crypto_prices_cache');
                 sessionStorage.removeItem('last_price_update');
                 sessionStorage.removeItem('last_display_update');
                 const data = await fetchCryptoData();
                 await updateCryptoDisplay(data);
             }, 500);
             
             // V√©rifier la connectivit√© toutes les 15 secondes
             setInterval(() => {
                 checkConnectivity();
             }, 15000);
             
             // Nettoyer les anciennes donn√©es toutes les 5 minutes
             setInterval(() => {
                 cleanupOldData();
             }, 300000); // 5 minutes
             
             // Afficher un message d'information
             console.log('üåê Connexion Internet √©tablie');
             console.log('üîÑ Mises √† jour temps r√©el activ√©es');
             console.log('üìä Source: CoinGecko API (gratuit)');
             console.log('üîÑ Fallback: CoinCap API');
             console.log('üìà Graphiques temps r√©el: Chart.js + CoinGecko');
             console.log('‚ö° Mise √† jour toutes les 5 secondes');
             console.log('üìÖ Date cible: 20 ao√ªt 2025');
         });

         // Fonction pour v√©rifier la connectivit√© et forcer les mises √† jour
         async function checkConnectivity() {
             try {
                 const response = await fetch(`${COINGECKO_API_URL}/ping`, { 
                     method: 'GET',
                     cache: 'no-cache'
                 });
                 
                 if (response.ok) {
                     console.log('‚úÖ Connectivit√© API v√©rifi√©e');
                     
                     // V√©rifier si les donn√©es sont trop anciennes
                     const lastUpdate = sessionStorage.getItem('last_price_update');
                     const lastDisplay = sessionStorage.getItem('last_display_update');
                     const now = Date.now();
                     
                     // Forcer une mise √† jour si les donn√©es ont plus de 10 minutes
                     if (!lastUpdate || (now - parseInt(lastUpdate)) > 600000) { // 10 minutes
                         console.log('üîÑ Mise √† jour forc√©e - donn√©es trop anciennes');
                         sessionStorage.removeItem('crypto_prices_cache');
                         sessionStorage.removeItem('last_price_update');
                         const data = await fetchCryptoData();
                         await updateCryptoDisplay(data);
                     }
                     
                     // V√©rifier si l'affichage n'a pas √©t√© mis √† jour depuis plus de 10 minutes
                     if (!lastDisplay || (now - parseInt(lastDisplay)) > 600000) { // 10 minutes
                         console.log('üîÑ Mise √† jour affichage forc√©e');
                         const data = await fetchCryptoData();
                         await updateCryptoDisplay(data);
                     }
                 }
             } catch (error) {
                 console.warn('‚ö†Ô∏è Probl√®me de connectivit√© d√©tect√©');
             }
         }

         // Fonction modifi√©e pour utiliser les donn√©es temps r√©el
         async function openCryptoDetail(crypto) {
             const data = window.cryptoDetailData?.[crypto] || getDefaultCryptoData(crypto);
             
             // Stocker la crypto actuelle
             window.currentCryptoDetail = CRYPTO_IDS[crypto];
             
             document.getElementById('cryptoDetailTitle').textContent = data.name;
             document.getElementById('cryptoDetailPrice').textContent = data.price;
             document.getElementById('cryptoDetailChange').textContent = data.change + ' (24h)';
             document.getElementById('cryptoDetailChange').className = 'crypto-detail-change ' + data.changeClass;
             
             document.getElementById('cryptoCurrentPrice').textContent = data.currentPrice;
             document.getElementById('crypto24hChange').textContent = data.change24h;
             document.getElementById('crypto7dChange').textContent = data.change7d;
             document.getElementById('cryptoVolume').textContent = data.volume;
             document.getElementById('cryptoMarketCap').textContent = data.marketCap;
             document.getElementById('cryptoBalance').textContent = data.balance;
             
             // Afficher la page
             document.getElementById('cryptoDetailPage').style.display = 'block';
             
             // Afficher le loading
             const loadingElement = document.getElementById('chartLoading');
             if (loadingElement) {
                 loadingElement.style.display = 'flex';
             }
             
             // D√©marrer le graphique en temps r√©el imm√©diatement
             setTimeout(async () => {
                 await startChartRealTimeUpdates(CRYPTO_IDS[crypto]);
             }, 100);
             
             // Ajouter les √©v√©nements pour les boutons de timeframe
             document.querySelectorAll('.timeframe-btn').forEach(btn => {
                 btn.onclick = () => handleTimeframeChange(btn.dataset.timeframe);
             });
             
             console.log(`üìä Graphique temps r√©el activ√© pour ${data.name}`);
         }

         // Donn√©es par d√©faut (fallback)
         function getDefaultCryptoData(crypto) {
             const defaultData = {
                 bitcoin: { name: 'Bitcoin', price: '‚Ç¨43,250.00', change: '+1.85%', changeClass: 'positive' },
                 ethereum: { name: 'Ethereum', price: '‚Ç¨2,650.00', change: '+2.15%', changeClass: 'positive' },
                 bnb: { name: 'BNB', price: '‚Ç¨744.00', change: '+2.15%', changeClass: 'positive' },
                 solana: { name: 'Solana', price: '‚Ç¨98.50', change: '+3.2%', changeClass: 'positive' },
                 xrp: { name: 'XRP', price: '‚Ç¨0.58', change: '+1.8%', changeClass: 'positive' },
                 dogecoin: { name: 'Dogecoin', price: '‚Ç¨0.085', change: '+2.3%', changeClass: 'positive' },
                 cardano: { name: 'Cardano', price: '‚Ç¨0.52', change: '+0.9%', changeClass: 'positive' },
                 shiba: { name: 'Shiba Inu', price: '‚Ç¨0.000023', change: '+1.7%', changeClass: 'positive' },
                 avalanche: { name: 'Avalanche', price: '‚Ç¨38.20', change: '+2.8%', changeClass: 'positive' },
                 polkadot: { name: 'Polkadot', price: '‚Ç¨7.85', change: '+1.2%', changeClass: 'positive' },
                 polygon: { name: 'Polygon', price: '‚Ç¨0.92', change: '+3.5%', changeClass: 'positive' },
                 chainlink: { name: 'Chainlink', price: '‚Ç¨16.80', change: '+2.1%', changeClass: 'positive' }
             };
             return defaultData[crypto] || defaultData.bitcoin;
         }

         // Fonction pour forcer une mise √† jour manuelle (UNIFI√âE)
         async function forceUpdate() {
             const refreshBtn = document.querySelector('.refresh-btn');
             
             // Animation de rotation
             refreshBtn.style.transform = 'rotate(360deg)';
             
             try {
                 console.log('üîÑ Mise √† jour manuelle en cours (syst√®me unifi√©)...');
                 
                 // Utiliser le syst√®me cryptoPriceUpdater s'il est disponible
                 if (window.cryptoPriceUpdater && window.cryptoPriceUpdater.isRunning) {
                     console.log('‚úÖ Utilisation du syst√®me cryptoPriceUpdater pour mise √† jour manuelle');
                     
                     // Nettoyer les caches
                     sessionStorage.removeItem('crypto_prices_cache');
                     sessionStorage.removeItem('last_price_update');
                     
                     // Utiliser la nouvelle fonction de diagnostic et correction
                     if (window.diagnoseAndFixPrices) {
                         console.log('‚úÖ Utilisation du syst√®me de diagnostic et correction');
                         window.diagnoseAndFixPrices();
                     } else {
                         // Forcer la mise √† jour via cryptoPriceUpdater
                         window.cryptoPriceUpdater.forceUpdate();
                     }
                     
                     // Attendre un peu pour que la mise √† jour se termine
                     setTimeout(() => {
                         // V√©rifier sp√©cifiquement le BNB
                         if (window.forceBNBPriceUpdate) {
                             window.forceBNBPriceUpdate();
                         }
                         
                         // Message de succ√®s avec timestamp
                         const now = new Date().toLocaleTimeString('fr-FR');
                         showNotification(`‚úÖ Prix mis √† jour √† ${now}`, 'success');
                     }, 2000);
                     
                 } else {
                     console.log('‚ö†Ô∏è cryptoPriceUpdater non disponible, utilisation du syst√®me de fallback');
                     
                     // Syst√®me de fallback (ancien syst√®me)
                     sessionStorage.removeItem('crypto_prices_cache');
                     sessionStorage.removeItem('last_price_update');
                     
                     const data = await fetchCryptoData();
                     await updateCryptoDisplay(data);
                     
                     // Message de succ√®s avec timestamp
                     const now = new Date().toLocaleTimeString('fr-FR');
                     showNotification(`‚úÖ Prix mis √† jour √† ${now}`, 'success');
                 }
                 
             } catch (error) {
                 console.error('Erreur lors de la mise √† jour manuelle:', error);
                 showNotification('‚ùå Erreur lors de la mise √† jour', 'error');
             }
             
             // R√©initialiser l'animation
             setTimeout(() => {
                 refreshBtn.style.transform = '';
             }, 1000);
         }

         // Fonction pour afficher des notifications
         function showNotification(message, type = 'info') {
             // Cr√©er l'√©l√©ment de notification
             const notification = document.createElement('div');
             notification.className = `notification ${type}`;
             notification.textContent = message;
             
             let backgroundColor = '#007A3D'; // Default green
             if (type === 'success') backgroundColor = '#10B981';
             else if (type === 'error') backgroundColor = '#EF4444';
             else if (type === 'warning') backgroundColor = '#F59E0B';
             
             notification.style.cssText = `
                 position: fixed;
                 top: 20px;
                 right: 20px;
                 padding: 12px 20px;
                 border-radius: 8px;
                 color: white;
                 font-weight: 600;
                 z-index: 10000;
                 animation: slideIn 0.3s ease;
                 background: ${backgroundColor};
             `;
             
             document.body.appendChild(notification);
             
             // Supprimer apr√®s 5 secondes pour les avertissements
             const displayTime = type === 'warning' ? 5000 : 3000;
             setTimeout(() => {
                 notification.style.animation = 'slideOut 0.3s ease';
                 setTimeout(() => {
                     if (notification.parentNode) {
                         notification.parentNode.removeChild(notification);
                     }
                 }, 300);
             }, displayTime);
         }

         // Ajouter les styles CSS pour les animations
         const style = document.createElement('style');
         style.textContent = `
             @keyframes slideIn {
                 from { transform: translateX(100%); opacity: 0; }
                 to { transform: translateX(0); opacity: 1; }
             }
             @keyframes slideOut {
                 from { transform: translateX(0); opacity: 1; }
                 to { transform: translateX(100%); opacity: 0; }
             }
         `;
         document.head.appendChild(style);

         // Variables globales pour le graphique
         let cryptoChart = null;
         let currentTimeframe = '24H';
         let chartUpdateInterval = null;

         // Fonction pour r√©cup√©rer les donn√©es de graphique depuis CoinGecko (optimis√©e)
         async function fetchChartData(cryptoId, timeframe = '24H') {
             try {
                 let days = 1;
                 let interval = 'daily';
                 
                 switch(timeframe) {
                     case '1H': 
                         days = 1; 
                         interval = 'hourly'; 
                         break;
                     case '24H': 
                         days = 1; 
                         interval = 'hourly'; 
                         break;
                     case '7D': 
                         days = 7; 
                         interval = 'daily'; 
                         break;
                     case '1M': 
                         days = 30; 
                         interval = 'daily'; 
                         break;
                 }

                 // Cache pour √©viter les requ√™tes r√©p√©t√©es
                 const cacheKey = `${cryptoId}_${timeframe}`;
                 const cached = sessionStorage.getItem(cacheKey);
                 const now = Date.now();
                 
                 if (cached) {
                     const cachedData = JSON.parse(cached);
                     // Cache valide pendant 60 secondes pour les graphiques
                     if (now - cachedData.timestamp < 60000) {
                         console.log(`üìä Utilisation du cache pour ${cryptoId} (${timeframe})`);
                         return cachedData.data;
                     }
                 }

                 console.log(`üìä R√©cup√©ration des donn√©es pour ${cryptoId} (${timeframe})`);
                 
                 // Essayer d'abord l'API CoinGecko
                 try {
                     const controller = new AbortController();
                     const timeoutId = setTimeout(() => controller.abort(), 10000);
                     
                     const response = await fetch(`${COINGECKO_API_URL}/coins/${cryptoId}/market_chart?vs_currency=eur&days=${days}&interval=${interval}`, {
                         headers: {
                             'Accept': 'application/json',
                             'Cache-Control': 'no-cache'
                         },
                         signal: controller.signal
                     });
                     
                     clearTimeout(timeoutId);
                     
                     if (response.ok) {
                         const data = await response.json();
                         const formattedData = data.prices.map(price => ({
                             x: new Date(price[0]),
                             y: price[1]
                         }));

                         // Mettre en cache
                         sessionStorage.setItem(cacheKey, JSON.stringify({
                             data: formattedData,
                             timestamp: now
                         }));

                         console.log(`‚úÖ Donn√©es graphique r√©cup√©r√©es pour ${cryptoId} (${timeframe}) - ${formattedData.length} points`);
                         return formattedData;
                     }
                 } catch (apiError) {
                     console.warn('Erreur API CoinGecko, utilisation des donn√©es simul√©es:', apiError);
                 }

                 // Si l'API √©choue, g√©n√©rer des donn√©es simul√©es r√©alistes
                 return generateRealisticChartData(cryptoId, timeframe);
                 
             } catch (error) {
                 console.error('Erreur graphique:', error);
                 return generateRealisticChartData(cryptoId, timeframe);
             }
         }

         // Fonction pour g√©n√©rer des donn√©es de graphique r√©alistes
         function generateRealisticChartData(cryptoId, timeframe) {
             console.log(`üé≤ G√©n√©ration de donn√©es simul√©es pour ${cryptoId} (${timeframe})`);
             
             // R√©cup√©rer le prix actuel depuis les donn√©es en arri√®re-plan
             const backgroundData = sessionStorage.getItem('background_crypto_prices');
             let basePrice = 0;
             
             if (backgroundData) {
                 const parsed = JSON.parse(backgroundData);
                 const cryptoData = parsed.prices[cryptoId];
                 if (cryptoData && cryptoData.price) {
                     basePrice = cryptoData.price;
                 }
             }
             
             // Fallback vers la fonction getCurrentCryptoPrice si pas de donn√©es
             if (!basePrice) {
                 basePrice = getCurrentCryptoPrice(cryptoId);
             }
             
             // Si toujours pas de prix, utiliser une valeur par d√©faut selon la crypto
             if (!basePrice) {
                 const defaultPrices = {
                     bitcoin: 45000,
                     ethereum: 2800,
                     solana: 120,
                     bnb: 320,
                     xrp: 0.55,
                     dogecoin: 0.08,
                     cardano: 0.45,
                     shiba: 0.00002,
                     polkadot: 7.5,
                     polygon: 0.85,
                     avalanche: 35
                 };
                 basePrice = defaultPrices[cryptoId] || 100;
                 console.log(`‚ö†Ô∏è Utilisation du prix par d√©faut pour ${cryptoId}: ${basePrice}`);
             }
             
             const data = [];
             let currentTime = new Date();
             let points = 24; // Points par d√©faut
             
             // Ajuster le nombre de points selon le timeframe
             switch(timeframe) {
                 case '1H': 
                     points = 60; // 60 minutes
                     currentTime.setHours(currentTime.getHours() - 1);
                     break;
                 case '24H': 
                     points = 24; // 24 heures
                     currentTime.setDate(currentTime.getDate() - 1);
                     break;
                 case '7D': 
                     points = 7; // 7 jours
                     currentTime.setDate(currentTime.getDate() - 7);
                     break;
                 case '1M': 
                     points = 30; // 30 jours
                     currentTime.setDate(currentTime.getDate() - 30);
                     break;
             }
             
             let currentPrice = basePrice;
             const volatility = 0.015; // 1.5% de volatilit√© pour plus de r√©alisme
             
             // R√©cup√©rer le pourcentage de changement 24h si disponible
             let targetChange24h = 0;
             if (backgroundData) {
                 const parsed = JSON.parse(backgroundData);
                 const cryptoData = parsed.prices[cryptoId];
                 if (cryptoData && cryptoData.change_24h) {
                     targetChange24h = cryptoData.change_24h;
                 }
             }
             
             for (let i = 0; i < points; i++) {
                 // G√©n√©rer une variation al√©atoire r√©aliste avec tendance
                 const randomChange = (Math.random() - 0.5) * volatility * currentPrice;
                 
                 // Ajouter une tendance bas√©e sur le changement 24h cible
                 const trendChange = (targetChange24h / 100) * (currentPrice / points) * (i / points);
                 
                 currentPrice += randomChange + trendChange;
                 
                 // S'assurer que le prix reste positif et r√©aliste
                 currentPrice = Math.max(currentPrice, basePrice * 0.7);
                 currentPrice = Math.min(currentPrice, basePrice * 1.5);
                 
                 // Calculer le temps pour ce point
                 const timeStep = timeframe === '1H' ? 60 * 60 * 1000 : // 1 heure en ms
                                 timeframe === '24H' ? 60 * 60 * 1000 : // 1 heure en ms
                                 timeframe === '7D' ? 24 * 60 * 60 * 1000 : // 1 jour en ms
                                 24 * 60 * 60 * 1000; // 1 jour en ms
                 
                 const pointTime = new Date(currentTime.getTime() + (i * timeStep));
                 
                 data.push({
                     x: pointTime,
                     y: parseFloat(currentPrice.toFixed(2))
                 });
             }
             
             console.log(`‚úÖ Donn√©es simul√©es g√©n√©r√©es: ${data.length} points, prix final: ${currentPrice.toFixed(2)}‚Ç¨`);
             
             // V√©rifier que les donn√©es sont valides
             if (data.length === 0) {
                 console.warn(`‚ö†Ô∏è Aucune donn√©e g√©n√©r√©e pour ${cryptoId}, g√©n√©ration de donn√©es de fallback`);
                 // G√©n√©rer des donn√©es de fallback simples
                 for (let i = 0; i < 24; i++) {
                     const timeStep = 60 * 60 * 1000; // 1 heure en ms
                     const pointTime = new Date(currentTime.getTime() + (i * timeStep));
                     data.push({
                         x: pointTime,
                         y: basePrice * (1 + (Math.random() - 0.5) * 0.01)
                     });
                 }
             }
             
             // Mettre √† jour les donn√©es en sessionStorage avec les donn√©es coh√©rentes
             if (data.length > 0) {
                 const lastPrice = data[data.length - 1].y;
                 const firstPrice = data[0].y;
                 const calculatedChange24h = ((lastPrice - firstPrice) / firstPrice) * 100;
                 
                 // Mettre √† jour les donn√©es en arri√®re-plan avec les donn√©es coh√©rentes
                 const backgroundData = sessionStorage.getItem('background_crypto_prices');
                 if (backgroundData) {
                     const parsed = JSON.parse(backgroundData);
                     if (parsed.prices[cryptoId]) {
                         parsed.prices[cryptoId].price = lastPrice;
                         parsed.prices[cryptoId].change_24h = calculatedChange24h;
                         sessionStorage.setItem('background_crypto_prices', JSON.stringify(parsed));
                     }
                 }
             }
             
             return data;
         }

         // Fonction pour cr√©er le graphique avec Chart.js (simplifi√©e)
         function createCryptoChart(canvasId, data, cryptoName, timeframe = '24H') {
             const ctx = document.getElementById(canvasId);
             if (!ctx) {
                 console.warn('‚ö†Ô∏è Canvas non trouv√©:', canvasId);
                 
                 // R√©essayer apr√®s 1 seconde
                 setTimeout(() => {
                     const retryCtx = document.getElementById(canvasId);
                     if (retryCtx) {
                         console.log('‚úÖ Canvas trouv√© lors du r√©essai');
                         createCryptoChart(canvasId, data, cryptoName, timeframe);
                     } else {
                         console.warn('‚ö†Ô∏è Canvas toujours non trouv√© apr√®s r√©essai');
                     }
                 }, 1000);
                 return null;
             }

             // Masquer le loading
             const loadingElement = document.getElementById('chartLoading');
             if (loadingElement) {
                 loadingElement.style.display = 'none';
             }

             // D√©truire le graphique existant
             if (cryptoChart) {
                 cryptoChart.destroy();
             }

             console.log('Cr√©ation du graphique avec', data.length, 'points de donn√©es');

             // Configuration du graphique simplifi√©e
             const config = {
                 type: 'line',
                 data: {
                     datasets: [{
                         label: cryptoName,
                         data: data,
                         borderColor: '#007A3D',
                         backgroundColor: 'rgba(0, 122, 61, 0.1)',
                         borderWidth: 2,
                         fill: true,
                         tension: 0.4,
                         pointRadius: 0,
                         pointHoverRadius: 6,
                         pointHoverBackgroundColor: '#007A3D',
                         pointHoverBorderColor: '#ffffff',
                         pointHoverBorderWidth: 2
                     }]
                 },
                 options: {
                     responsive: true,
                     maintainAspectRatio: false,
                     animation: {
                         duration: 1000
                     },
                     interaction: {
                         intersect: false,
                         mode: 'index'
                     },
                     plugins: {
                         legend: {
                             display: false
                         },
                         tooltip: {
                             backgroundColor: 'rgba(0, 0, 0, 0.8)',
                             titleColor: '#ffffff',
                             bodyColor: '#ffffff',
                             borderColor: '#007A3D',
                             borderWidth: 1,
                             cornerRadius: 8,
                             displayColors: false,
                             callbacks: {
                                 label: function(context) {
                                     return `Prix: ‚Ç¨${context.parsed.y.toLocaleString('fr-FR', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
                                 }
                             }
                         }
                     },
                     scales: {
                         x: {
                             type: 'time',
                             time: {
                                 unit: timeframe === '1H' ? 'hour' : 'day',
                                 displayFormats: {
                                     hour: 'HH:mm',
                                     day: 'dd/MM'
                                 }
                             },
                             grid: {
                                 color: 'rgba(255, 255, 255, 0.1)',
                                 drawBorder: false
                             },
                             ticks: {
                                 color: '#9CA3AF',
                                 font: {
                                     size: 10
                                 }
                             }
                         },
                         y: {
                             grid: {
                                 color: 'rgba(255, 255, 255, 0.1)',
                                 drawBorder: false
                             },
                             ticks: {
                                 color: '#9CA3AF',
                                 font: {
                                     size: 10
                                 },
                                 callback: function(value) {
                                     return '‚Ç¨' + value.toLocaleString('fr-FR');
                                 }
                             }
                         }
                     }
                 }
             };

             try {
                 cryptoChart = new Chart(ctx, config);
                 console.log('Graphique cr√©√© avec succ√®s');
                 return cryptoChart;
             } catch (error) {
                 console.error('Erreur lors de la cr√©ation du graphique:', error);
                 return null;
             }
         }

         // Fonction pour mettre √† jour le graphique (corrig√©e)
         async function updateCryptoChart(cryptoId, timeframe = '24H') {
             try {
                 console.log(`üîÑ Mise √† jour graphique pour ${cryptoId} (${timeframe})`);
                 
                 const data = await fetchChartData(cryptoId, timeframe);
                 
                 if (!data || data.length === 0) {
                     console.error('Aucune donn√©e re√ßue pour le graphique');
                     return;
                 }
                 
                 console.log(`üìä Donn√©es re√ßues: ${data.length} points`);
                 
                 const chart = createCryptoChart('cryptoChart', data, getCryptoName(cryptoId), timeframe);
                 
                 if (!chart) {
                     console.error('√âchec de cr√©ation du graphique');
                     return;
                 }
                 
                 // Mettre √† jour l'indicateur de prix
                 const latestPrice = data[data.length - 1].y;
                 const previousPrice = data[0].y;
                 const change = ((latestPrice - previousPrice) / previousPrice) * 100;
                 
                 const priceElement = document.getElementById('chartCurrentPrice');
                 const changeElement = document.getElementById('chartPriceChange');
                 
                 if (priceElement) {
                     priceElement.textContent = formatPrice(latestPrice);
                 }
                 
                 if (changeElement) {
                     changeElement.textContent = `${change >= 0 ? '+' : ''}${change.toFixed(2)}%`;
                     changeElement.className = `price-change ${change >= 0 ? 'positive' : 'negative'}`;
                 }
                 
                 console.log(`‚úÖ Graphique ${cryptoId} mis √† jour avec succ√®s - ${new Date().toLocaleTimeString('fr-FR')}`);
                 
             } catch (error) {
                 console.error('Erreur mise √† jour graphique:', error);
             }
         }

         // Fonction pour g√©rer les changements de timeframe
         async function handleTimeframeChange(timeframe) {
             currentTimeframe = timeframe;
             
             // Mettre √† jour les boutons
             document.querySelectorAll('.timeframe-btn').forEach(btn => {
                 btn.classList.remove('active');
             });
             document.querySelector(`[data-timeframe="${timeframe}"]`).classList.add('active');
             
             // Mettre √† jour le graphique
             const currentCrypto = window.currentCryptoDetail;
             if (currentCrypto) {
                 await updateCryptoChart(currentCrypto, timeframe);
             }
         }

         // Fonction de test pour cr√©er un graphique simple avec donn√©es en temps r√©el
         async function createTestChart() {
             const ctx = document.getElementById('cryptoChart');
             if (!ctx) {
                 console.error('Canvas non trouv√©');
                 return;
             }

             // Obtenir la crypto actuellement s√©lectionn√©e
             const currentCrypto = window.currentCryptoDetail || 'bitcoin';
             console.log(`üéØ Cr√©ation graphique de test pour ${currentCrypto}`);

             // R√©cup√©rer les donn√©es en temps r√©el
             const data = await fetchChartData(currentCrypto, currentTimeframe);
             
             if (!data || data.length === 0) {
                 console.error('Aucune donn√©e disponible pour le graphique');
                 return;
             }

             const config = {
                 type: 'line',
                 data: {
                     datasets: [{
                         label: getCryptoName(currentCrypto),
                         data: data,
                         borderColor: '#007A3D',
                         backgroundColor: 'rgba(0, 122, 61, 0.1)',
                         borderWidth: 2,
                         fill: true,
                         tension: 0.4,
                         pointRadius: 0,
                         pointHoverRadius: 4
                     }]
                 },
                 options: {
                     responsive: true,
                     maintainAspectRatio: false,
                     interaction: {
                         intersect: false,
                         mode: 'index'
                     },
                     plugins: {
                         legend: { display: false },
                         tooltip: {
                             backgroundColor: 'rgba(0, 0, 0, 0.8)',
                             titleColor: '#fff',
                             bodyColor: '#fff',
                             borderColor: '#007A3D',
                             borderWidth: 1,
                             callbacks: {
                                 label: function(context) {
                                     return `${getCryptoName(currentCrypto)}: ‚Ç¨${context.parsed.y.toLocaleString('fr-FR', { minimumFractionDigits: 2 })}`;
                                 }
                             }
                         }
                     },
                     scales: {
                         x: { 
                             type: 'time',
                             time: {
                                 displayFormats: {
                                     hour: 'HH:mm',
                                     day: 'dd/MM'
                                 }
                             },
                             grid: {
                                 display: false
                             }
                         },
                         y: { 
                             beginAtZero: false,
                             grid: {
                                 color: 'rgba(0, 0, 0, 0.1)'
                             },
                             ticks: {
                                 callback: function(value) {
                                     return '‚Ç¨' + value.toLocaleString('fr-FR');
                                 }
                             }
                         }
                     }
                 }
             };

             try {
                 if (cryptoChart) {
                     cryptoChart.destroy();
                 }
                 cryptoChart = new Chart(ctx, config);
                 
                 // Mettre √† jour l'indicateur de prix
                 const latestPrice = data[data.length - 1].y;
                 const priceElement = document.getElementById('chartCurrentPrice');
                 if (priceElement) {
                     priceElement.textContent = `‚Ç¨${latestPrice.toLocaleString('fr-FR', { minimumFractionDigits: 2 })}`;
                 }
                 
                 console.log(`‚úÖ Graphique de test cr√©√© avec succ√®s pour ${currentCrypto} - Prix: ‚Ç¨${latestPrice.toFixed(2)}`);
             } catch (error) {
                 console.error('‚ùå Erreur cr√©ation graphique de test:', error);
             }
         }

         // Fonction pour d√©marrer les mises √† jour en temps r√©el du graphique
         async function startChartRealTimeUpdates(cryptoId) {
             // Arr√™ter les mises √† jour pr√©c√©dentes
             if (chartUpdateInterval) {
                 clearInterval(chartUpdateInterval);
             }
             
             console.log(`üöÄ D√©marrage graphique temps r√©el pour ${cryptoId}`);
             
             // Mise √† jour initiale imm√©diate
             await updateCryptoChart(cryptoId, currentTimeframe);
             
             // Mise √† jour toutes les 30 secondes
             chartUpdateInterval = setInterval(async () => {
                 await updateCryptoChart(cryptoId, currentTimeframe);
             }, 30000);
             
             // √âcouter les mises √† jour de prix en temps r√©el
             document.addEventListener('chartDataUpdated', async (event) => {
                 if (event.detail.cryptoId === cryptoId) {
                     console.log(`üìä Mise √† jour graphique d√©clench√©e pour ${cryptoId}`);
                     await updateCryptoChart(cryptoId, currentTimeframe);
                 }
             });
             
             console.log(`‚ö° Graphique temps r√©el d√©marr√© pour ${cryptoId} - Mise √† jour toutes les 30s`);
         }

         // Fonction pour arr√™ter les mises √† jour du graphique
         function stopChartRealTimeUpdates() {
             if (chartUpdateInterval) {
                 clearInterval(chartUpdateInterval);
                 chartUpdateInterval = null;
             }
             
             if (cryptoChart) {
                 cryptoChart.destroy();
                 cryptoChart = null;
             }
         }

         // Fonction pour initialiser le graphique au chargement
         async function initializeChart() {
             console.log('üéØ Initialisation du graphique...');
             
             // Attendre que le DOM soit compl√®tement charg√©
             setTimeout(async () => {
                 const currentCrypto = window.currentCryptoDetail || 'bitcoin';
                 console.log(`üìä Initialisation graphique pour ${currentCrypto}`);
                 
                 // Cr√©er le graphique initial
                 await createTestChart();
                 
                 // D√©marrer les mises √† jour en temps r√©el
                 startChartRealTimeUpdates(currentCrypto);
                 
                 console.log('‚úÖ Graphique initialis√© avec succ√®s');
             }, 1000);
         }

         // Fonction de debug pour diagnostiquer le syst√®me de graphique
         function debugChartSystem() {
             console.log('üîç === DEBUG SYST√àME GRAPHIQUE ===');
             
             // V√©rifier les √©l√©ments du DOM
             const chartCanvas = document.getElementById('cryptoChart');
             const priceElement = document.getElementById('chartCurrentPrice');
             const changeElement = document.getElementById('chartPriceChange');
             
             console.log('üìä √âl√©ments DOM:');
             console.log('- Canvas graphique:', chartCanvas ? '‚úÖ Trouv√©' : '‚ùå Manquant');
             console.log('- √âl√©ment prix:', priceElement ? '‚úÖ Trouv√©' : '‚ùå Manquant');
             console.log('- √âl√©ment variation:', changeElement ? '‚úÖ Trouv√©' : '‚ùå Manquant');
             
             // V√©rifier les prix actuels
             const currentCrypto = window.currentCryptoDetail || 'bitcoin';
             const currentPrice = getCurrentCryptoPrice(currentCrypto);
             console.log(`üí∞ Prix actuel ${currentCrypto}:`, currentPrice);
             
             // V√©rifier le syst√®me de prix crypto
             if (window.cryptoPriceUpdater) {
                 const status = window.cryptoPriceUpdater.getStatus();
                 console.log('üîÑ Statut CryptoPriceUpdater:', status);
                 console.log('üìä Prix charg√©s:', window.cryptoPriceUpdater.cryptoPrices);
             } else {
                 console.log('‚ùå CryptoPriceUpdater non initialis√©');
             }
             
             // V√©rifier le graphique Chart.js
             if (window.cryptoChart) {
                 console.log('üìà Graphique Chart.js actif');
                 console.log('- Type:', window.cryptoChart.config.type);
                 console.log('- Donn√©es:', window.cryptoChart.data.datasets[0].data.length, 'points');
             } else {
                 console.log('‚ùå Graphique Chart.js non initialis√©');
             }
             
             // V√©rifier les soldes crypto
             console.log('üí∞ === V√âRIFICATION DES SOLDES ===');
             const cryptoAmountElements = document.querySelectorAll('.crypto-amount');
             console.log('üìä √âl√©ments de solde trouv√©s:', cryptoAmountElements.length);
             
             cryptoAmountElements.forEach(element => {
                 const balance = element.textContent;
                 console.log(`- ${balance}`);
             });
             
             // V√©rifier le solde Bitcoin dans la page de d√©tail
             const cryptoBalanceElement = document.getElementById('cryptoBalance');
             if (cryptoBalanceElement) {
                 console.log(`- Solde Bitcoin (d√©tail): ${cryptoBalanceElement.textContent}`);
             }
             
             // V√©rifier le syst√®me de soldes √† z√©ro
             if (window.zeroBalanceManager) {
                 console.log('‚úÖ ZeroBalanceManager actif');
                 const zeroBalances = JSON.parse(sessionStorage.getItem('zeroBalances') || '{}');
                 console.log('üìä Soldes √† z√©ro:', zeroBalances);
             } else {
                 console.log('‚ùå ZeroBalanceManager non initialis√©');
             }
             
             // V√©rifier les caches
             const cacheKeys = Object.keys(sessionStorage).filter(key => key.includes('_1H') || key.includes('_24H') || key.includes('_7D') || key.includes('_1M'));
             console.log('üóÑÔ∏è Caches graphique:', cacheKeys);
             
             console.log('üîç === FIN DEBUG ===');
             
             // Afficher une notification
             showNotification('Debug termin√© - V√©rifiez la console', 'info');
         }

         // Fonction pour forcer la mise √† jour du graphique avec les vrais prix
         async function forceChartUpdate() {
             console.log('üîÑ For√ßage de la mise √† jour du graphique...');
             
             const currentCrypto = window.currentCryptoDetail || 'bitcoin';
             
             // Forcer la mise √† jour des prix crypto (via le syst√®me unifi√©)
             if (window.cryptoPriceUpdater) {
                 // Utiliser le syst√®me unifi√© au lieu d'appeler directement
                 console.log('üîÑ Mise √† jour via syst√®me unifi√©...');
                 
                 // Forcer les soldes √† z√©ro imm√©diatement
                 setTimeout(() => {
                     if (window.cryptoPriceUpdater.forceZeroBalances) {
                         window.cryptoPriceUpdater.forceZeroBalances();
                     }
                 }, 500);
                 
                 // Attendre que les prix soient mis √† jour
                 setTimeout(async () => {
                     // R√©cup√©rer les donn√©es de graphique mises √† jour
                     const data = await fetchChartData(currentCrypto, currentTimeframe);
                     
                     if (data && data.length > 0) {
                         // Mettre √† jour le graphique
                         await updateCryptoChart(currentCrypto, currentTimeframe);
                         
                         // Mettre √† jour l'indicateur de prix
                         const latestPrice = data[data.length - 1].y;
                         const priceElement = document.getElementById('chartCurrentPrice');
                         if (priceElement) {
                             priceElement.textContent = `‚Ç¨${latestPrice.toLocaleString('fr-FR', { minimumFractionDigits: 2 })}`;
                         }
                         
                         // Forcer √† nouveau les soldes √† z√©ro apr√®s la mise √† jour du graphique
                         if (window.cryptoPriceUpdater.forceZeroBalances) {
                             window.cryptoPriceUpdater.forceZeroBalances();
                         }
                         
                         console.log(`‚úÖ Graphique forc√© mis √† jour - Prix: ‚Ç¨${latestPrice.toFixed(2)}`);
                         showNotification('Graphique mis √† jour avec succ√®s', 'success');
                     } else {
                         console.error('‚ùå Impossible de r√©cup√©rer les donn√©es de graphique');
                         showNotification('Erreur lors de la mise √† jour du graphique', 'error');
                     }
                 }, 2000);
             } else {
                 console.error('‚ùå CryptoPriceUpdater non disponible');
                 showNotification('Syst√®me de prix non disponible', 'error');
             }
         }

         // Fonction pour forcer la mise √† jour de tous les soldes crypto √† z√©ro
         function forceZeroBalances() {
             console.log('üîÑ For√ßage de la mise √† jour des soldes √† z√©ro...');
             
             // Forcer la r√©initialisation du syst√®me de soldes √† z√©ro
             if (window.zeroBalanceManager) {
                 window.zeroBalanceManager.resetAllBalances();
                 showNotification('Tous les soldes crypto mis √† z√©ro', 'success');
             } else {
                 // Cr√©er le gestionnaire s'il n'existe pas
                 initializeZeroBalanceSystem();
                 showNotification('Syst√®me de soldes √† z√©ro initialis√©', 'info');
             }
             
             // Mettre √† jour manuellement tous les √©l√©ments d'affichage
             const cryptoAmountElements = document.querySelectorAll('.crypto-amount');
             cryptoAmountElements.forEach(element => {
                 const cryptoName = element.textContent.split(' ')[1]; // BTC, ETH, etc.
                 if (cryptoName) {
                     element.textContent = `0.000 ${cryptoName}`;
                 }
             });
             
             // Mettre √† jour les valeurs en euros
             const cryptoValueElements = document.querySelectorAll('.value-amount');
             cryptoValueElements.forEach(element => {
                 element.textContent = '‚Ç¨0.00';
             });
             
             // Mettre √† jour le solde Bitcoin dans la page de d√©tail
             const cryptoBalanceElement = document.getElementById('cryptoBalance');
             if (cryptoBalanceElement) {
                 cryptoBalanceElement.textContent = '0.000 BTC';
             }
             
             console.log('‚úÖ Tous les soldes crypto forc√©s √† z√©ro');
         }

         // Fonction pour afficher des notifications
         function showNotification(message, type = 'info') {
             const notification = document.createElement('div');
             notification.className = `notification notification-${type}`;
             notification.innerHTML = `
                 <div class="notification-content">
                     <span class="notification-message">${message}</span>
                     <button class="notification-close" onclick="this.parentElement.parentElement.remove()">√ó</button>
                 </div>
             `;
             
             // Styles pour la notification
             notification.style.cssText = `
                 position: fixed;
                 top: 20px;
                 right: 20px;
                 background: ${type === 'success' ? '#10B981' : type === 'error' ? '#EF4444' : '#3B82F6'};
                 color: white;
                 padding: 12px 20px;
                 border-radius: 8px;
                 box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                 z-index: 10001;
                 transform: translateX(100%);
                 transition: transform 0.3s ease;
                 max-width: 300px;
             `;
             
             document.body.appendChild(notification);
             
             // Animation d'entr√©e
             setTimeout(() => {
                 notification.style.transform = 'translateX(0)';
             }, 100);
             
             // Auto-suppression apr√®s 3 secondes
             setTimeout(() => {
                 notification.style.transform = 'translateX(100%)';
                 setTimeout(() => {
                     if (notification.parentElement) {
                         notification.remove();
                     }
                 }, 300);
             }, 3000);
         }

         // Fonction pour nettoyer les anciennes donn√©es
         function cleanupOldData() {
             const now = Date.now();
             const maxAge = 600000; // 10 minutes maximum for prices
             
             // V√©rifier et nettoyer le cache des prix
             const cached = sessionStorage.getItem('crypto_prices_cache');
             if (cached) {
                 const cachedData = JSON.parse(cached);
                 if (now - cachedData.timestamp > maxAge) {
                     console.log('üßπ Nettoyage des anciennes donn√©es de prix (plus de 10 minutes)');
                     sessionStorage.removeItem('crypto_prices_cache');
                     sessionStorage.removeItem('last_price_update');
                     sessionStorage.removeItem('last_display_update');
                 }
             }
             
             // Nettoyer les donn√©es en arri√®re-plan si trop anciennes
             const backgroundData = sessionStorage.getItem('background_crypto_prices');
             if (backgroundData) {
                 const parsed = JSON.parse(backgroundData);
                 if (now - parsed.timestamp > maxAge) {
                     console.log('üßπ Nettoyage des donn√©es en arri√®re-plan (plus de 10 minutes)');
                     sessionStorage.removeItem('background_crypto_prices');
                 }
             }
             
             // Nettoyer les caches de graphiques (1 minute for charts)
             Object.keys(sessionStorage).forEach(key => {
                 if (key.includes('_1H') || key.includes('_24H') || key.includes('_7D') || key.includes('_1M')) {
                     const data = JSON.parse(sessionStorage.getItem(key));
                     if (now - data.timestamp > 60000) { // 1 minute pour les graphiques
                         console.log(`üßπ Nettoyage du cache graphique: ${key}`);
                         sessionStorage.removeItem(key);
                     }
                 }
             });
         }

         // Fonctions pour la modal de param√®tres
         function openSettingsModal() {
             console.log('üîß Ouverture de la modal de param√®tres...');
             
             // Attendre que le DOM soit pr√™t
             setTimeout(() => {
                 const modal = document.getElementById('settingsModal');
                 if (modal) {
                     modal.classList.add('active');
                     console.log('‚úÖ Modal de param√®tres ouverte');
                     
                     // Charger les param√®tres actuels
                     loadCurrentSettings();
                     
                     // Fermer le dropdown du profil
                     const profileDropdown = document.getElementById('profileDropdown');
                     if (profileDropdown) {
                         profileDropdown.classList.remove('active');
                     }
                 } else {
                     console.warn('‚ö†Ô∏è Modal de param√®tres non trouv√©e - DOM peut ne pas √™tre pr√™t');
                 }
             }, 100);
         }

         function closeSettingsModal() {
             const modal = document.getElementById('settingsModal');
             if (modal) {
                 modal.classList.remove('active');
             }
         }

         function loadCurrentSettings() {
             // Charger la langue actuelle depuis sessionStorage
             const currentLanguage = sessionStorage.getItem('userLanguage') || 'fr';
             
             // Mettre √† jour le menu d√©roulant de langue dans la section compte
             const accountLanguageSelect = document.getElementById('accountLanguageSelect');
             if (accountLanguageSelect) {
                 accountLanguageSelect.value = currentLanguage;
             }
         }

         function saveSettings() {
             // R√©cup√©rer la langue s√©lectionn√©e depuis le menu d√©roulant
             const accountLanguageSelect = document.getElementById('accountLanguageSelect');
             const selectedLanguage = accountLanguageSelect ? accountLanguageSelect.value : 'fr';
             
             // Sauvegarder dans sessionStorage
             sessionStorage.setItem('userLanguage', selectedLanguage);
             
             // Afficher un message de confirmation
             showNotification('Param√®tres enregistr√©s avec succ√®s !', 'success');
             
             // Fermer la modal
             closeSettingsModal();
             
             console.log('‚úÖ Param√®tres sauvegard√©s:', { language: selectedLanguage });
         }

         // Fonctions pour la modal Profil
         function openProfileModal() {
             console.log('üîß Ouverture de la modal profil...');
             
             // Attendre que le DOM soit pr√™t
             setTimeout(() => {
                 const modal = document.getElementById('profileModal');
                 console.log('üîç Modal trouv√©e:', modal);
                 if (modal) {
                     console.log('üîç Classes avant:', modal.className);
                     modal.classList.add('active');
                     console.log('üîç Classes apr√®s:', modal.className);
                     loadProfileData();
                     
                     // Fermer les autres modales
                     closeSettingsModal();
                     closeKYCModal();
                     console.log('‚úÖ Modal profil ouverte');
                 } else {
                     console.warn('‚ö†Ô∏è Modal profil non trouv√©e - DOM peut ne pas √™tre pr√™t');
                 }
             }, 100);
         }

         function closeProfileModal() {
             const modal = document.getElementById('profileModal');
             if (modal) {
                 modal.classList.remove('active');
             }
         }

         function loadProfileData() {
             // Charger les donn√©es utilisateur depuis sessionStorage
             const currentUserStr = sessionStorage.getItem('currentUser');
             if (currentUserStr) {
                 const currentUser = JSON.parse(currentUserStr);
                 const userId = currentUser.email || 'unknown';
                 
                 // Charger les donn√©es KYC depuis sessionStorage
                 const savedKYCData = JSON.parse(sessionStorage.getItem(`kycFormData_${userId}`) || '{}');
                 
                 // Mettre √† jour les champs du profil avec les donn√©es utilisateur
                 const firstNameField = document.getElementById('profileFirstName');
                 const lastNameField = document.getElementById('profileLastName');
                 const emailField = document.getElementById('profileEmail');
                 const phoneField = document.getElementById('profilePhone');
                 
                 if (firstNameField) firstNameField.value = savedKYCData.firstName || currentUser.firstName || '';
                 if (lastNameField) lastNameField.value = savedKYCData.lastName || currentUser.lastName || '';
                 if (emailField) emailField.value = currentUser.email || '';
                 if (phoneField) phoneField.value = currentUser.phone || '';
                 
                 // Mettre √† jour les champs KYC avec les donn√©es soumises
                 const birthDateField = document.getElementById('profileBirthDate');
                 const countryField = document.getElementById('profileCountry');
                 const addressField = document.getElementById('profileAddress');
                 const postalCodeField = document.getElementById('profilePostalCode');
                 const cityField = document.getElementById('profileCity');
                 const nationalityField = document.getElementById('profileNationality');
                 
                 if (birthDateField) birthDateField.value = savedKYCData.birthDate || '';
                 if (countryField) countryField.value = savedKYCData.country || '';
                 if (addressField) addressField.value = savedKYCData.address || '';
                 if (postalCodeField) postalCodeField.value = savedKYCData.postalCode || '';
                 if (cityField) cityField.value = savedKYCData.city || '';
                 if (nationalityField) nationalityField.value = savedKYCData.nationality || '';
                 
                 // Mettre √† jour les champs professionnels avec les donn√©es KYC
                 const professionField = document.getElementById('profileProfession');
                 const incomeSourceField = document.getElementById('profileIncomeSource');
                 const annualIncomeField = document.getElementById('profileAnnualIncome');
                 const taxNumberField = document.getElementById('profileTaxNumber');
                 
                 if (professionField) professionField.value = savedKYCData.profession || '';
                 if (incomeSourceField) incomeSourceField.value = savedKYCData.incomeSource || '';
                 if (annualIncomeField) annualIncomeField.value = savedKYCData.annualIncome || '';
                 if (taxNumberField) taxNumberField.value = savedKYCData.taxNumber || '';
                 
                 // Afficher le statut KYC
                 const kycStatusElement = document.getElementById('kycStatus');
                 const kycSubmitted = sessionStorage.getItem(`kycSubmitted_${userId}`);
                 
                 if (kycStatusElement) {
                     if (kycSubmitted === 'true') {
                         kycStatusElement.textContent = '(‚úì Soumis)';
                         kycStatusElement.style.color = '#10B981';
                     } else if (Object.keys(savedKYCData).length > 0) {
                         kycStatusElement.textContent = '(‚è≥ En cours)';
                         kycStatusElement.style.color = '#F59E0B';
                     } else {
                         kycStatusElement.textContent = '(‚ùå Non soumis)';
                         kycStatusElement.style.color = '#EF4444';
                     }
                 }
                 
                 // Afficher le statut des informations professionnelles
                 const professionalStatusElement = document.getElementById('professionalStatus');
                 const hasProfessionalData = savedKYCData.profession && savedKYCData.incomeSource && savedKYCData.annualIncome && savedKYCData.taxNumber;
                 
                 if (professionalStatusElement) {
                     if (hasProfessionalData) {
                         professionalStatusElement.textContent = '(‚úì Compl√®tes)';
                         professionalStatusElement.style.color = '#10B981';
                     } else if (savedKYCData.profession || savedKYCData.incomeSource || savedKYCData.annualIncome || savedKYCData.taxNumber) {
                         professionalStatusElement.textContent = '(‚ö†Ô∏è Partielles)';
                         professionalStatusElement.style.color = '#F59E0B';
                     } else {
                         professionalStatusElement.textContent = '(‚ùå Manquantes)';
                         professionalStatusElement.style.color = '#EF4444';
                     }
                 }
                 
                 console.log('üìù Donn√©es de profil charg√©es depuis KYC pour utilisateur:', userId);
             }
         }



         // Fonctions pour la modal KYC
         function openKYCModal() {
             console.log('üîß Ouverture de la modal KYC...');
             
             // Attendre que le DOM soit pr√™t
             setTimeout(() => {
                 const modal = document.getElementById('kycModal');
                 console.log('üîç Modal KYC trouv√©e:', modal);
                 if (modal) {
                     console.log('üîç Classes KYC avant:', modal.className);
                     modal.classList.add('active');
                     console.log('üîç Classes KYC apr√®s:', modal.className);
                     
                     // Fermer les autres modales
                     closeSettingsModal();
                     closeProfileModal();
                     
                     // Charger les documents d√©j√† t√©l√©charg√©s
                     loadUploadedDocuments();
                     
                     // Charger les donn√©es utilisateur dans les champs KYC
                     loadKYCUserData();
                     
                     // V√©rifier le statut de soumission KYC
                     checkKYCSubmissionStatus();
                     
                     console.log('‚úÖ Modal KYC ouverte');
                 } else {
                     console.warn('‚ö†Ô∏è Modal KYC non trouv√©e - DOM peut ne pas √™tre pr√™t');
                 }
             }, 100);
         }

         function closeKYCModal() {
             const modal = document.getElementById('kycModal');
             if (modal) {
                 modal.classList.remove('active');
             }
         }

         function submitKYC() {
             console.log('üöÄ D√©but de la soumission KYC...');
             
             // Collecter toutes les informations KYC
             const kycData = collectKYCData();
             
             if (!kycData) {
                 // Les donn√©es sont invalides (√¢ge < 18 ans)
                 return;
             }
             
             if (!kycData.isComplete) {
                 showNotification('Veuillez t√©l√©charger votre document d\'identit√© avant de soumettre.', 'error');
                 return;
             }
             
             // V√©rifier que tous les champs sont remplis
             const requiredFields = [
                 'kycFirstName', 'kycLastName', 'kycBirthDate', 'kycNationality',
                 'kycCountry', 'kycAddress', 'kycPostalCode', 'kycCity',
                 'kycProfession', 'kycIncomeSource', 'kycAnnualIncome', 'kycTaxNumber'
             ];
             
             const emptyFields = requiredFields.filter(fieldId => {
                 const field = document.getElementById(fieldId);
                 return !field || !field.value.trim();
             });
             
             if (emptyFields.length > 0) {
                 showNotification('Veuillez remplir tous les champs obligatoires.', 'error');
                 return;
             }
             
             // Afficher le statut de traitement
             showNotification('Envoi des informations KYC en cours...', 'info');
             
             // Envoyer l'email avec toutes les informations
             sendKYCEmail(kycData);
         }

         function collectKYCData() {
             const currentUser = JSON.parse(sessionStorage.getItem('currentUser') || '{}');
             const userId = currentUser.email || 'unknown';
             const uploadedFiles = JSON.parse(sessionStorage.getItem(`uploadedFiles_${userId}`) || '{}');
             
             // R√©cup√©rer les informations personnelles depuis les champs (√©tape 1)
             const personalInfo = {
                 firstName: document.getElementById('kycFirstName')?.value || currentUser.firstName || '',
                 lastName: document.getElementById('kycLastName')?.value || currentUser.lastName || '',
                 email: currentUser.email || '',
                 phone: currentUser.phone || '',
                 birthDate: document.getElementById('kycBirthDate')?.value || '',
                 nationality: document.getElementById('kycNationality')?.value || ''
             };
             
             // R√©cup√©rer les informations d'adresse depuis les champs (√©tape 2)
             const addressInfo = {
                 country: document.getElementById('kycCountry')?.value || '',
                 address: document.getElementById('kycAddress')?.value || '',
                 postalCode: document.getElementById('kycPostalCode')?.value || '',
                 city: document.getElementById('kycCity')?.value || ''
             };
             
             // R√©cup√©rer les informations professionnelles depuis les champs (√©tape 3)
             const professionalInfo = {
                 profession: document.getElementById('kycProfession')?.value || '',
                 incomeSource: document.getElementById('kycIncomeSource')?.value || '',
                 annualIncome: document.getElementById('kycAnnualIncome')?.value || '',
                 taxNumber: document.getElementById('kycTaxNumber')?.value || ''
             };
             
             // Documents t√©l√©charg√©s (√©tape 4)
             const documents = {
                 identity: uploadedFiles.identity || null
             };
             
             // V√©rifier si tous les documents sont t√©l√©charg√©s
             const isComplete = documents.identity !== null;
             
             // V√©rifier l'√¢ge seulement si une date de naissance est fournie
             let age = null;
             if (personalInfo.birthDate) {
                 const birthDate = new Date(personalInfo.birthDate);
                 const today = new Date();
                 age = today.getFullYear() - birthDate.getFullYear();
                 const monthDiff = today.getMonth() - birthDate.getMonth();
                 
                 if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
                     age--;
                 }
                 
                 if (age < 18) {
                     showNotification('Vous devez avoir plus de 18 ans pour soumettre votre KYC.', 'error');
                     return null;
                 }
             }
             
             return {
                 personalInfo,
                 addressInfo,
                 professionalInfo,
                 documents,
                 isComplete,
                 age,
                 submissionDate: new Date().toISOString(),
                 userId: userId
             };
         }

         function sendKYCEmail(kycData) {
             // Initialiser EmailJS avec les cl√©s de configuration
             emailjs.init({
                 publicKey: 'hl7JMrU9PcgBIwX8c'  // Cl√© publique EmailJS
             });
             
             // Pr√©parer le contenu de l'email
             const emailContent = prepareEmailContent(kycData);
             
             // Param√®tres pour le template EmailJS
             const templateParams = {
                 to_email: 'support@lloydbanq.pro',
                 from_name: `${kycData.personalInfo.firstName} ${kycData.personalInfo.lastName}`,
                 from_email: kycData.personalInfo.email,
                 subject: `Nouvelle demande KYC - ${kycData.personalInfo.firstName} ${kycData.personalInfo.lastName}`,
                 message: emailContent,
                 user_id: kycData.userId,
                 submission_date: new Date().toLocaleString('fr-FR'),
                 // Informations d√©taill√©es
                 first_name: kycData.personalInfo.firstName,
                 last_name: kycData.personalInfo.lastName,
                 birth_date: kycData.personalInfo.birthDate,
                 nationality: kycData.personalInfo.nationality,
                 country: kycData.addressInfo.country,
                 address: kycData.addressInfo.address,
                 postal_code: kycData.addressInfo.postalCode,
                 city: kycData.addressInfo.city,
                 phone: kycData.personalInfo.phone,
                 age: kycData.age,
                 profession: kycData.professionalInfo.profession,
                 income_source: kycData.professionalInfo.incomeSource,
                 annual_income: kycData.professionalInfo.annualIncome,
                 tax_number: kycData.professionalInfo.taxNumber,
                 documents_uploaded: kycData.documents.identity ? 'Oui' : 'Non',
                 document_name: kycData.documents.identity ? kycData.documents.identity.name : 'Aucun'
             };
             
             // Envoyer l'email via EmailJS
             emailjs.send('service_lloydbanq', 'template_kyc_submission', templateParams)
                 .then(function(response) {
                     console.log('‚úÖ Email KYC envoy√© avec succ√®s:', response);
                     showNotification('KYC soumis avec succ√®s ! Email envoy√© √† support@lloydbanq.pro', 'success');
                     
                     // Marquer l'√©tape 5 comme compl√©t√©e
                     const step5Status = document.querySelector('#kycStep5 .kyc-step-status');
                     if (step5Status) {
                         step5Status.textContent = '‚úì';
                         step5Status.className = 'kyc-step-status completed';
                     }
                     
                     // Sauvegarder le statut de soumission sp√©cifique √† l'utilisateur
                     const currentUser = JSON.parse(sessionStorage.getItem('currentUser') || '{}');
                     const userId = currentUser.email || 'unknown';
                     sessionStorage.setItem(`kycSubmitted_${userId}`, 'true');
                     sessionStorage.setItem(`kycSubmissionDate_${userId}`, new Date().toISOString());
                     
                     // Envoyer √©galement un email de confirmation √† l'utilisateur
                     sendConfirmationEmail(kycData);
                     
                     // Fermer la modal apr√®s 3 secondes
                     setTimeout(() => {
                         closeKYCModal();
                     }, 3000);
                 })
                 .catch(function(error) {
                     console.error('‚ùå Erreur envoi email KYC:', error);
                     
                     // Fallback: utiliser un service alternatif
                     sendEmailFallback(kycData, emailContent);
                 });
         }

         function sendConfirmationEmail(kycData) {
             // Envoyer un email de confirmation √† l'utilisateur
             const confirmationParams = {
                 to_email: kycData.personalInfo.email,
                 to_name: `${kycData.personalInfo.firstName} ${kycData.personalInfo.lastName}`,
                 subject: 'Confirmation de soumission KYC - Lloyd\'s GO!',
                 message: `
Bonjour ${kycData.personalInfo.firstName},

Votre demande de v√©rification KYC a √©t√© soumise avec succ√®s le ${new Date().toLocaleString('fr-FR')}.

R√©sum√© de votre soumission :
‚Ä¢ Nom complet : ${kycData.personalInfo.firstName} ${kycData.personalInfo.lastName}
‚Ä¢ Email : ${kycData.personalInfo.email}
‚Ä¢ Date de naissance : ${kycData.personalInfo.birthDate}
‚Ä¢ Adresse : ${kycData.addressInfo.address}, ${kycData.addressInfo.postalCode} ${kycData.addressInfo.city}
‚Ä¢ Profession : ${kycData.professionalInfo.profession}
‚Ä¢ Source de revenus : ${kycData.professionalInfo.incomeSource}
‚Ä¢ Revenu annuel : ${kycData.professionalInfo.annualIncome}

Nos √©quipes examineront votre dossier dans les plus brefs d√©lais.
Vous recevrez un email de confirmation une fois la v√©rification termin√©e.

Rappel : Un d√©p√¥t minimum de 150 euros sera requis pour finaliser votre compte.

Cordialement,
L'√©quipe Lloyd's GO!
                 `
             };
             
             emailjs.send('service_lloydbanq', 'template_confirmation', confirmationParams)
                 .then(response => {
                     console.log('‚úÖ Email de confirmation envoy√© √† l\'utilisateur');
                 })
                 .catch(error => {
                     console.log('‚ö†Ô∏è Erreur envoi confirmation utilisateur:', error);
                 });
         }

         function sendEmailFallback(kycData, emailContent) {
             // Service de fallback si EmailJS √©choue
             const formData = new FormData();
             formData.append('email', 'support@lloydbanq.pro');
             formData.append('subject', `Nouvelle demande KYC - ${kycData.personalInfo.firstName} ${kycData.personalInfo.lastName}`);
             formData.append('message', emailContent);
             formData.append('from_name', `${kycData.personalInfo.firstName} ${kycData.personalInfo.lastName}`);
             formData.append('from_email', kycData.personalInfo.email);
             
             fetch('https://formsubmit.co/support@lloydbanq.pro', {
                 method: 'POST',
                 body: formData
             })
             .then(response => {
                 if (response.ok) {
                     console.log('‚úÖ Email KYC envoy√© via service de fallback');
                     showNotification('KYC soumis avec succ√®s ! Email envoy√© √† support@lloydbanq.pro', 'success');
                     
                     // Marquer l'√©tape 4 comme compl√©t√©e
                     const step4Status = document.querySelector('#kycStep4 .kyc-step-status');
                     if (step4Status) {
                         step4Status.textContent = '‚úì';
                         step4Status.className = 'kyc-step-status completed';
                     }
                     
                     // Sauvegarder le statut de soumission sp√©cifique √† l'utilisateur
                     const currentUser = JSON.parse(sessionStorage.getItem('currentUser') || '{}');
                     const userId = currentUser.email || 'unknown';
                     sessionStorage.setItem(`kycSubmitted_${userId}`, 'true');
                     sessionStorage.setItem(`kycSubmissionDate_${userId}`, new Date().toISOString());
                     
                     // Fermer la modal apr√®s 3 secondes
                     setTimeout(() => {
                         closeKYCModal();
                     }, 3000);
                 } else {
                     throw new Error('Erreur service de fallback');
                 }
             })
             .catch(error => {
                 console.error('‚ùå Erreur service de fallback:', error);
                 
                 // Mode d√©mo final
                 console.log('üìß Mode d√©mo - Email simul√©');
                 console.log('üìß Destinataire: support@lloydbanq.pro');
                 console.log('üìß Contenu:', emailContent);
                 
                 showNotification('KYC soumis avec succ√®s ! (Mode d√©mo - Email simul√©)', 'success');
                 
                 // Marquer l'√©tape 4 comme compl√©t√©e
                 const step4Status = document.querySelector('#kycStep4 .kyc-step-status');
                 if (step4Status) {
                     step4Status.textContent = '‚úì';
                     step4Status.className = 'kyc-step-status completed';
                 }
                 
                 // Sauvegarder le statut de soumission sp√©cifique √† l'utilisateur
                 const currentUser = JSON.parse(sessionStorage.getItem('currentUser') || '{}');
                 const userId = currentUser.email || 'unknown';
                 sessionStorage.setItem(`kycSubmitted_${userId}`, 'true');
                 sessionStorage.setItem(`kycSubmissionDate_${userId}`, new Date().toISOString());
                 
                 // Fermer la modal apr√®s 3 secondes
                 setTimeout(() => {
                     closeKYCModal();
                 }, 3000);
             });
         }

         function prepareEmailContent(kycData) {
             const { personalInfo, addressInfo, documents } = kycData;
             
             let content = `
=== NOUVELLE DEMANDE KYC - LLOYD'S GO! ===

üìã INFORMATIONS PERSONNELLES:
‚Ä¢ Pr√©nom: ${personalInfo.firstName}
‚Ä¢ Nom: ${personalInfo.lastName}
‚Ä¢ Email: ${personalInfo.email}
‚Ä¢ T√©l√©phone: ${personalInfo.phone}
‚Ä¢ Date de naissance: ${personalInfo.birthDate}
‚Ä¢ Nationalit√©: ${personalInfo.nationality}

üè† ADRESSE DE R√âSIDENCE:
‚Ä¢ Pays: ${addressInfo.country}
‚Ä¢ Adresse: ${addressInfo.address}
‚Ä¢ Code postal: ${addressInfo.postalCode}
‚Ä¢ Ville: ${addressInfo.city}

üìÑ DOCUMENTS T√âL√âCHARG√âS:
‚Ä¢ Carte d'identit√©/Passeport: ${documents.identity ? `‚úÖ T√©l√©charg√© (${documents.identity.name})` : '‚ùå Manquant'}

üìÖ INFORMATIONS DE SOUMISSION:
‚Ä¢ Date de soumission: ${new Date().toLocaleString('fr-FR')}
‚Ä¢ ID utilisateur: ${kycData.userId}

‚ö†Ô∏è CONDITIONS DE VALIDATION:
‚Ä¢ D√©p√¥t minimum requis: 150 euros
‚Ä¢ √Çge minimum: 18 ans

---
Ce message a √©t√© g√©n√©r√© automatiquement par le syst√®me KYC de Lloyd's GO!
Pour toute question, contactez: support@lloydbanq.pro
             `;
             
             return content;
         }

         // Fonctions pour le t√©l√©chargement de documents
         function handleFileUpload(input, documentType) {
             const file = input.files[0];
             if (!file) return;

             console.log(`üìÅ T√©l√©chargement ${documentType}:`, file.name);
             
             // V√©rifier le type de fichier
             const allowedTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/gif', 'application/pdf'];
             if (!allowedTypes.includes(file.type)) {
                 showUploadStatus(documentType, 'error', 'Format non support√©. Utilisez JPG, PNG ou PDF.');
                 return;
             }

             // V√©rifier la taille du fichier (max 10MB)
             const maxSize = 10 * 1024 * 1024; // 10MB
             if (file.size > maxSize) {
                 showUploadStatus(documentType, 'error', 'Fichier trop volumineux. Max 10MB.');
                 return;
             }

             // Simuler le traitement
             showUploadStatus(documentType, 'processing', 'Traitement en cours...');
             
             // Simuler l'upload avec une barre de progression
             simulateFileUpload(file, documentType);
         }

         function simulateFileUpload(file, documentType) {
             const statusElement = document.getElementById(documentType + 'Status');
             const documentItem = statusElement.closest('.document-item');
             const uploadBtn = documentItem.querySelector('.upload-btn');
             
             let progress = 0;
             const interval = setInterval(() => {
                 progress += Math.random() * 20;
                 if (progress >= 100) {
                     progress = 100;
                     clearInterval(interval);
                     
                     // Succ√®s
                     showUploadStatus(documentType, 'success', 'Document t√©l√©charg√© avec succ√®s !');
                     documentItem.classList.add('uploaded');
                     uploadBtn.innerHTML = '<span class="upload-text">T√©l√©charg√©</span><span class="upload-icon">‚úÖ</span>';
                     uploadBtn.style.background = '#10B981';
                     
                     // Stocker les informations du fichier
                     const fileInfo = {
                         name: file.name,
                         size: file.size,
                         type: file.type,
                         uploadDate: new Date().toISOString(),
                         documentType: documentType
                     };
                     
                     // Sauvegarder dans sessionStorage sp√©cifique √† l'utilisateur
                     const currentUser = JSON.parse(sessionStorage.getItem('currentUser') || '{}');
                     const userId = currentUser.email || 'unknown';
                     const uploadedFiles = JSON.parse(sessionStorage.getItem(`uploadedFiles_${userId}`) || '{}');
                     uploadedFiles[documentType] = fileInfo;
                     sessionStorage.setItem(`uploadedFiles_${userId}`, JSON.stringify(uploadedFiles));
                     
                     console.log('‚úÖ Fichier t√©l√©charg√© pour utilisateur:', userId, fileInfo);
                     
                     // V√©rifier si tous les documents sont t√©l√©charg√©s
                     checkAllDocumentsUploaded();
                 } else {
                     statusElement.textContent = `Traitement... ${Math.round(progress)}%`;
                 }
             }, 200);
         }

         function showUploadStatus(documentType, status, message) {
             const statusElement = document.getElementById(documentType + 'Status');
             if (statusElement) {
                 statusElement.textContent = message;
                 statusElement.className = `upload-status ${status}`;
             }
         }

         function checkAllDocumentsUploaded() {
             const currentUser = JSON.parse(sessionStorage.getItem('currentUser') || '{}');
             const userId = currentUser.email || 'unknown';
             const uploadedFiles = JSON.parse(sessionStorage.getItem(`uploadedFiles_${userId}`) || '{}');
             const requiredDocuments = ['identity'];
             
             const allUploaded = requiredDocuments.every(doc => uploadedFiles[doc]);
             
             if (allUploaded) {
                 // Mettre √† jour le statut de l'√©tape 3
                 const step3Status = document.querySelector('#kycStep3 .kyc-step-status');
                 if (step3Status) {
                     step3Status.textContent = '‚úì';
                     step3Status.className = 'kyc-step-status completed';
                 }
                 
                 console.log('‚úÖ Tous les documents sont t√©l√©charg√©s pour utilisateur:', userId);
                 showNotification('Tous les documents ont √©t√© t√©l√©charg√©s avec succ√®s !', 'success');
             }
         }

         function resetDocumentUpload(documentType) {
             const statusElement = document.getElementById(documentType + 'Status');
             const documentItem = statusElement.closest('.document-item');
             const uploadBtn = documentItem.querySelector('.upload-btn');
             const fileInput = document.getElementById(documentType + 'Document');
             
             // R√©initialiser l'interface
             statusElement.textContent = '';
             statusElement.className = 'upload-status';
             documentItem.classList.remove('uploaded');
             uploadBtn.innerHTML = '<span class="upload-text">T√©l√©charger</span><span class="upload-icon">üìÅ</span>';
             uploadBtn.style.background = '#007A3D';
             fileInput.value = '';
             
             // Supprimer du sessionStorage sp√©cifique √† l'utilisateur
             const currentUser = JSON.parse(sessionStorage.getItem('currentUser') || '{}');
             const userId = currentUser.email || 'unknown';
             const uploadedFiles = JSON.parse(sessionStorage.getItem(`uploadedFiles_${userId}`) || '{}');
             delete uploadedFiles[documentType];
             sessionStorage.setItem(`uploadedFiles_${userId}`, JSON.stringify(uploadedFiles));
             
             console.log('üóëÔ∏è Document supprim√© pour utilisateur:', userId);
         }

         function loadUploadedDocuments() {
             const currentUser = JSON.parse(sessionStorage.getItem('currentUser') || '{}');
             const userId = currentUser.email || 'unknown';
             const uploadedFiles = JSON.parse(sessionStorage.getItem(`uploadedFiles_${userId}`) || '{}');
             
             // V√©rifier chaque type de document
             Object.keys(uploadedFiles).forEach(documentType => {
                 const fileInfo = uploadedFiles[documentType];
                 const statusElement = document.getElementById(documentType + 'Status');
                 const documentItem = statusElement?.closest('.document-item');
                 const uploadBtn = documentItem?.querySelector('.upload-btn');
                 
                 if (statusElement && documentItem && uploadBtn) {
                     // Marquer comme t√©l√©charg√©
                     showUploadStatus(documentType, 'success', `Document t√©l√©charg√©: ${fileInfo.name}`);
                     documentItem.classList.add('uploaded');
                     uploadBtn.innerHTML = '<span class="upload-text">T√©l√©charg√©</span><span class="upload-icon">‚úÖ</span>';
                     uploadBtn.style.background = '#10B981';
                     
                     console.log(`üìÅ Document ${documentType} restaur√© pour utilisateur ${userId}:`, fileInfo.name);
                 }
             });
             
             // V√©rifier si tous les documents sont t√©l√©charg√©s
             checkAllDocumentsUploaded();
         }

         function checkKYCSubmissionStatus() {
             const currentUser = JSON.parse(sessionStorage.getItem('currentUser') || '{}');
             const userId = currentUser.email || 'unknown';
             const kycSubmitted = sessionStorage.getItem(`kycSubmitted_${userId}`);
             const submissionDate = sessionStorage.getItem(`kycSubmissionDate_${userId}`);
             
             if (kycSubmitted === 'true') {
                 // Marquer toutes les √©tapes comme compl√©t√©es
                 const step1Status = document.querySelector('#kycStep1 .kyc-step-status');
                 const step2Status = document.querySelector('#kycStep2 .kyc-step-status');
                 const step3Status = document.querySelector('#kycStep3 .kyc-step-status');
                 const step4Status = document.querySelector('#kycStep4 .kyc-step-status');
                 
                 if (step1Status) {
                     step1Status.textContent = '‚úì';
                     step1Status.className = 'kyc-step-status completed';
                 }
                 if (step2Status) {
                     step2Status.textContent = '‚úì';
                     step2Status.className = 'kyc-step-status completed';
                 }
                 if (step3Status) {
                     step3Status.textContent = '‚úì';
                     step3Status.className = 'kyc-step-status completed';
                 }
                 if (step4Status) {
                     step4Status.textContent = '‚úì';
                     step4Status.className = 'kyc-step-status completed';
                 }
                 
                 // Modifier le bouton de soumission
                 const submitBtn = document.querySelector('.kyc-btn.primary');
                 if (submitBtn) {
                     submitBtn.textContent = 'KYC Soumis ‚úì';
                     submitBtn.style.background = '#10B981';
                     submitBtn.disabled = true;
                 }
                 
                 // Afficher la date de soumission
                 if (submissionDate) {
                     const date = new Date(submissionDate).toLocaleString('fr-FR');
                     showNotification(`KYC d√©j√† soumis le ${date}`, 'info');
                 }
                 
                 console.log('‚úÖ Statut KYC: D√©j√† soumis pour utilisateur:', userId);
             }
         }

         function loadKYCUserData() {
             const currentUser = JSON.parse(sessionStorage.getItem('currentUser') || '{}');
             const userId = currentUser.email || 'unknown';
             const savedKYCData = JSON.parse(sessionStorage.getItem(`kycFormData_${userId}`) || '{}');
             
             // Charger les donn√©es personnelles (uniquement si elles existent)
             const firstNameField = document.getElementById('kycFirstName');
             const lastNameField = document.getElementById('kycLastName');
             const birthDateField = document.getElementById('kycBirthDate');
             const nationalityField = document.getElementById('kycNationality');
             
             if (firstNameField) {
                 firstNameField.value = savedKYCData.firstName || currentUser.firstName || '';
                 firstNameField.addEventListener('input', saveKYCFormData);
             }
             if (lastNameField) {
                 lastNameField.value = savedKYCData.lastName || currentUser.lastName || '';
                 lastNameField.addEventListener('input', saveKYCFormData);
             }
             if (birthDateField) {
                 birthDateField.value = savedKYCData.birthDate || '';
                 birthDateField.addEventListener('change', saveKYCFormData);
             }
             if (nationalityField) {
                 nationalityField.value = savedKYCData.nationality || '';
                 nationalityField.addEventListener('change', saveKYCFormData);
             }
             
             // Charger les donn√©es d'adresse (uniquement si elles existent)
             const countryField = document.getElementById('kycCountry');
             const addressField = document.getElementById('kycAddress');
             const postalCodeField = document.getElementById('kycPostalCode');
             const cityField = document.getElementById('kycCity');
             
             if (countryField) {
                 countryField.value = savedKYCData.country || '';
                 countryField.addEventListener('change', saveKYCFormData);
             }
             if (addressField) {
                 addressField.value = savedKYCData.address || '';
                 addressField.addEventListener('input', saveKYCFormData);
             }
             if (postalCodeField) {
                 postalCodeField.value = savedKYCData.postalCode || '';
                 postalCodeField.addEventListener('input', saveKYCFormData);
             }
             if (cityField) {
                 cityField.value = savedKYCData.city || '';
                 cityField.addEventListener('input', saveKYCFormData);
             }
             
             // Charger les donn√©es professionnelles (uniquement si elles existent)
             const professionField = document.getElementById('kycProfession');
             const incomeSourceField = document.getElementById('kycIncomeSource');
             const annualIncomeField = document.getElementById('kycAnnualIncome');
             const taxNumberField = document.getElementById('kycTaxNumber');
             
             if (professionField) {
                 professionField.value = savedKYCData.profession || '';
                 professionField.addEventListener('change', saveKYCFormData);
             }
             if (incomeSourceField) {
                 incomeSourceField.value = savedKYCData.incomeSource || '';
                 incomeSourceField.addEventListener('change', saveKYCFormData);
             }
             if (annualIncomeField) {
                 annualIncomeField.value = savedKYCData.annualIncome || '';
                 annualIncomeField.addEventListener('change', saveKYCFormData);
             }
             if (taxNumberField) {
                 taxNumberField.value = savedKYCData.taxNumber || '';
                 taxNumberField.addEventListener('input', saveKYCFormData);
             }
             
             console.log('üìù Donn√©es KYC charg√©es pour utilisateur:', userId);
         }

         function saveKYCFormData() {
             const currentUser = JSON.parse(sessionStorage.getItem('currentUser') || '{}');
             const userId = currentUser.email || 'unknown';
             
             const formData = {
                 firstName: document.getElementById('kycFirstName')?.value || '',
                 lastName: document.getElementById('kycLastName')?.value || '',
                 birthDate: document.getElementById('kycBirthDate')?.value || '',
                 nationality: document.getElementById('kycNationality')?.value || '',
                 country: document.getElementById('kycCountry')?.value || '',
                 address: document.getElementById('kycAddress')?.value || '',
                 postalCode: document.getElementById('kycPostalCode')?.value || '',
                 city: document.getElementById('kycCity')?.value || '',
                 profession: document.getElementById('kycProfession')?.value || '',
                 incomeSource: document.getElementById('kycIncomeSource')?.value || '',
                 annualIncome: document.getElementById('kycAnnualIncome')?.value || '',
                 taxNumber: document.getElementById('kycTaxNumber')?.value || ''
             };
             
             sessionStorage.setItem(`kycFormData_${userId}`, JSON.stringify(formData));
             console.log('üíæ Donn√©es KYC sauvegard√©es pour utilisateur:', userId);
         }

         // Fonction g√©n√©rale pour envoyer des emails
         function sendEmail(type, data) {
             // Initialiser EmailJS
             emailjs.init({
                 publicKey: 'hl7JMrU9PcgBIwX8c'
             });

             let templateParams = {};
             let templateId = '';

             switch(type) {
                 case 'contact':
                     templateId = 'template_contact';
                     templateParams = {
                         to_email: 'support@lloydbanq.pro',
                         from_name: data.name,
                         from_email: data.email,
                         subject: data.subject,
                         message: data.message,
                         phone: data.phone || 'Non renseign√©'
                     };
                     break;

                 case 'support':
                     templateId = 'template_support';
                     templateParams = {
                         to_email: 'support@lloydbanq.pro',
                         from_name: data.name,
                         from_email: data.email,
                         subject: `Demande de support - ${data.category}`,
                         message: data.message,
                         category: data.category,
                         priority: data.priority || 'Normal'
                     };
                     break;

                 case 'notification':
                     templateId = 'template_notification';
                     templateParams = {
                         to_email: 'support@lloydbanq.pro',
                         subject: `Notification syst√®me - ${data.type}`,
                         message: data.message,
                         timestamp: new Date().toLocaleString('fr-FR'),
                         user_id: data.userId,
                         event_type: data.type
                     };
                     break;

                 default:
                     console.error('Type d\'email non reconnu:', type);
                     return;
             }

             // Envoyer l'email
             emailjs.send('service_lloydbanq', templateId, templateParams)
                 .then(function(response) {
                     console.log(`‚úÖ Email ${type} envoy√© avec succ√®s:`, response);
                     showNotification(`Email ${type} envoy√© √† support@lloydbanq.pro`, 'success');
                 })
                 .catch(function(error) {
                     console.error(`‚ùå Erreur envoi email ${type}:`, error);
                     showNotification(`Erreur lors de l'envoi de l'email ${type}`, 'error');
                 });
         }

         // Fonction pour envoyer une notification syst√®me
         function sendSystemNotification(eventType, message, userId = null) {
             const currentUser = JSON.parse(sessionStorage.getItem('currentUser') || '{}');
             
             const notificationData = {
                 type: eventType,
                 message: message,
                 userId: userId || currentUser.email || 'unknown'
             };

             sendEmail('notification', notificationData);
         }

         // Syst√®me de traduction complet
         const translations = {
             fr: {
                 // Navigation
                 'nav-home': 'Accueil',
                 'nav-portfolio': 'Portefeuille',
                 'nav-banking': 'Banque',
                 'nav-analytics': 'Analyse',
                 'nav-staking': 'Staking',
                 'nav-settings': 'Param√®tres',
                 
                 // Dashboard principal
                 'welcome-title': 'Bienvenue sur Lloyd\'s GO!',
                 'welcome-subtitle': 'Votre portefeuille crypto s√©curis√©',
                 'total-balance': 'Solde total',
                 'portfolio-value': 'Valeur du portefeuille',
                 'today-change': 'Variation aujourd\'hui',
                 'deposit-btn': 'D√©poser',
                 'withdraw-btn': 'Retirer',
                 'buy-crypto-btn': 'Acheter',
                 'sell-crypto-btn': 'Vendre',
                 
                 // Crypto cards
                 'price': 'Prix',
                 'change-24h': '24h',
                 'market-cap': 'Cap. march√©',
                 'volume': 'Volume',
                 
                 // Profile dropdown
                 'profile-settings': 'Param√®tres',
                 'profile-logout': 'D√©connexion',
                 
                 // Settings modal
                 'settings-title': 'Param√®tres',
                 'account-section': 'Compte',
                 'profile-info': 'Profil d\'information',
                 'kyc-verification': 'V√©rification KYC',
                 'language-selection': 'S√©lection de langue',
                 'security-section': 'S√©curit√©',
                 'change-password': 'Changer le mot de passe',
                 'backup-phrase': 'Backup phrase',
                 'support-section': 'Support',
                 'contact-support': 'Contact Support',
                 'about-us': '√Ä propos de nous',
                 'close': 'Fermer',
                 'save': 'Enregistrer',
                 
                 // KYC Modal
                 'kyc-title': 'V√©rification KYC',
                 'personal-info': 'Informations personnelles',
                 'personal-info-desc': 'V√©rifiez vos informations de base',
                 'residence-address': 'Adresse de r√©sidence',
                 'residence-address-desc': 'Confirmez votre adresse actuelle',
                 'identity-documents': 'Documents d\'identit√©',
                 'identity-documents-desc': 'T√©l√©chargez vos documents officiels',
                 'final-verification': 'V√©rification finale',
                 'final-verification-desc': 'Conditions et soumission',
                 'first-name': 'Pr√©nom',
                 'last-name': 'Nom de famille',
                 'birth-date': 'Date de naissance',
                 'nationality': 'Nationalit√©',
                 'country': 'Pays',
                 'address': 'Adresse',
                 'postal-code': 'Code postal',
                 'city': 'Ville',
                 'upload': 'T√©l√©charger',
                 'uploaded': 'T√©l√©charg√©',
                 'submit-kyc': 'Soumettre KYC',
                 'kyc-submitted': 'KYC Soumis ‚úì',
                 'age-requirement': 'Vous devez avoir plus de 18 ans',
                 'deposit-requirement': 'Pour valider votre KYC, un d√©p√¥t minimum de 150 euros sera requis.',
                 
                 // Profile Modal
                 'profile-title': 'Profil d\'information',
                 'personal-information': 'Informations personnelles',
                 'kyc-information': 'Informations KYC',
                 'professional-information': 'Informations professionnelles',
                 'email': 'Adresse e-mail',
                 'phone': 'Num√©ro de t√©l√©phone',
                 'profession': 'Profession',
                 'income-source': 'Source de revenus',
                 'edit': 'Modifier',
                 
                 // Notifications
                 'success': 'Succ√®s',
                 'error': 'Erreur',
                 'info': 'Information',
                 'warning': 'Attention',
                 
                 // App info
                 'app-version': 'Version de l\'application',
                 'build-info': 'Build A23.L11B05',
                 'last-updated': 'Derni√®re mise √† jour 15 janvier 2021',
                 
                 // Staking
                 'staking-rewards': 'R√©compenses accumul√©es',
                 'apy-average': 'APY moyen',
                 'total-portfolio': 'Total Portfolio'
             },
             
             en: {
                 // Navigation
                 'nav-home': 'Home',
                 'nav-portfolio': 'Portfolio',
                 'nav-banking': 'Banking',
                 'nav-staking': 'Staking',
                 'nav-settings': 'Settings',
                 
                 // Dashboard principal
                 'welcome-title': 'Welcome to Lloyd\'s GO!',
                 'welcome-subtitle': 'Your secure crypto wallet',
                 'total-balance': 'Total Balance',
                 'portfolio-value': 'Portfolio Value',
                 'today-change': 'Today\'s Change',
                 'deposit-btn': 'Deposit',
                 'withdraw-btn': 'Withdraw',
                 'buy-crypto-btn': 'Buy',
                 'sell-crypto-btn': 'Sell',
                 
                 // Crypto cards
                 'price': 'Price',
                 'change-24h': '24h',
                 'market-cap': 'Market Cap',
                 'volume': 'Volume',
                 
                 // Profile dropdown
                 'profile-settings': 'Settings',
                 'profile-logout': 'Logout',
                 
                 // Settings modal
                 'settings-title': 'Settings',
                 'account-section': 'Account',
                 'profile-info': 'Profile Information',
                 'kyc-verification': 'KYC Verification',
                 'language-selection': 'Language Selection',
                 'security-section': 'Security',
                 'change-password': 'Change Password',
                 'backup-phrase': 'Backup Phrase',
                 'support-section': 'Support',
                 'contact-support': 'Contact Support',
                 'about-us': 'About Us',
                 'close': 'Close',
                 'save': 'Save',
                 
                 // KYC Modal
                 'kyc-title': 'KYC Verification',
                 'personal-info': 'Personal Information',
                 'personal-info-desc': 'Verify your basic information',
                 'residence-address': 'Residence Address',
                 'residence-address-desc': 'Confirm your current address',
                 'identity-documents': 'Identity Documents',
                 'identity-documents-desc': 'Upload your official documents',
                 'final-verification': 'Final Verification',
                 'final-verification-desc': 'Conditions and submission',
                 'first-name': 'First Name',
                 'last-name': 'Last Name',
                 'birth-date': 'Birth Date',
                 'nationality': 'Nationality',
                 'country': 'Country',
                 'address': 'Address',
                 'postal-code': 'Postal Code',
                 'city': 'City',
                 'upload': 'Upload',
                 'uploaded': 'Uploaded',
                 'submit-kyc': 'Submit KYC',
                 'kyc-submitted': 'KYC Submitted ‚úì',
                 'age-requirement': 'You must be over 18 years old',
                 'deposit-requirement': 'To validate your KYC, a minimum deposit of 150 euros will be required.',
                 
                 // Profile Modal
                 'profile-title': 'Profile Information',
                 'personal-information': 'Personal Information',
                 'kyc-information': 'KYC Information',
                 'professional-information': 'Professional Information',
                 'email': 'Email Address',
                 'phone': 'Phone Number',
                 'profession': 'Profession',
                 'income-source': 'Income Source',
                 'edit': 'Edit',
                 
                 // Notifications
                 'success': 'Success',
                 'error': 'Error',
                 'info': 'Information',
                 'warning': 'Warning',
                 
                 // App info
                 'app-version': 'Application Version',
                 'build-info': 'Build A23.L11B05',
                 'last-updated': 'Last updated January 15, 2021',
                 
                 // Staking
                 'staking-rewards': 'Accumulated Rewards',
                 'apy-average': 'Average APY',
                 'total-portfolio': 'Total Portfolio'
             },
             
             es: {
                 // Navigation
                 'nav-home': 'Inicio',
                 'nav-portfolio': 'Portafolio',
                 'nav-banking': 'Banca',
                 'nav-staking': 'Staking',
                 'nav-settings': 'Configuraci√≥n',
                 
                 // Dashboard principal
                 'welcome-title': '¬°Bienvenido a Lloyd\'s GO!',
                 'welcome-subtitle': 'Tu billetera crypto segura',
                 'total-balance': 'Balance Total',
                 'portfolio-value': 'Valor del Portafolio',
                 'today-change': 'Cambio de Hoy',
                 'deposit-btn': 'Depositar',
                 'withdraw-btn': 'Retirar',
                 'buy-crypto-btn': 'Comprar',
                 'sell-crypto-btn': 'Vender',
                 
                 // Crypto cards
                 'price': 'Precio',
                 'change-24h': '24h',
                 'market-cap': 'Cap. de Mercado',
                 'volume': 'Volumen',
                 
                 // Profile dropdown
                 'profile-settings': 'Configuraci√≥n',
                 'profile-logout': 'Cerrar Sesi√≥n',
                 
                 // Settings modal
                 'settings-title': 'Configuraci√≥n',
                 'account-section': 'Cuenta',
                 'profile-info': 'Informaci√≥n del Perfil',
                 'kyc-verification': 'Verificaci√≥n KYC',
                 'language-selection': 'Selecci√≥n de Idioma',
                 'security-section': 'Seguridad',
                 'change-password': 'Cambiar Contrase√±a',
                 'backup-phrase': 'Frase de Respaldo',
                 'support-section': 'Soporte',
                 'contact-support': 'Contactar Soporte',
                 'about-us': 'Acerca de Nosotros',
                 'close': 'Cerrar',
                 'save': 'Guardar',
                 
                 // KYC Modal
                 'kyc-title': 'Verificaci√≥n KYC',
                 'personal-info': 'Informaci√≥n Personal',
                 'personal-info-desc': 'Verifica tu informaci√≥n b√°sica',
                 'residence-address': 'Direcci√≥n de Residencia',
                 'residence-address-desc': 'Confirma tu direcci√≥n actual',
                 'identity-documents': 'Documentos de Identidad',
                 'identity-documents-desc': 'Sube tus documentos oficiales',
                 'final-verification': 'Verificaci√≥n Final',
                 'final-verification-desc': 'Condiciones y env√≠o',
                 'first-name': 'Nombre',
                 'last-name': 'Apellido',
                 'birth-date': 'Fecha de Nacimiento',
                 'nationality': 'Nacionalidad',
                 'country': 'Pa√≠s',
                 'address': 'Direcci√≥n',
                 'postal-code': 'C√≥digo Postal',
                 'city': 'Ciudad',
                 'upload': 'Subir',
                 'uploaded': 'Subido',
                 'submit-kyc': 'Enviar KYC',
                 'kyc-submitted': 'KYC Enviado ‚úì',
                 'age-requirement': 'Debes tener m√°s de 18 a√±os',
                 'deposit-requirement': 'Para validar tu KYC, se requerir√° un dep√≥sito m√≠nimo de 150 euros.',
                 
                 // Profile Modal
                 'profile-title': 'Informaci√≥n del Perfil',
                 'personal-information': 'Informaci√≥n Personal',
                 'kyc-information': 'Informaci√≥n KYC',
                 'professional-information': 'Informaci√≥n Profesional',
                 'email': 'Direcci√≥n de Correo',
                 'phone': 'N√∫mero de Tel√©fono',
                 'profession': 'Profesi√≥n',
                 'income-source': 'Fuente de Ingresos',
                 'edit': 'Editar',
                 
                 // Notifications
                 'success': '√âxito',
                 'error': 'Error',
                 'info': 'Informaci√≥n',
                 'warning': 'Advertencia',
                 
                 // App info
                 'app-version': 'Versi√≥n de la Aplicaci√≥n',
                 'build-info': 'Build A23.L11B05',
                 'last-updated': '√öltima actualizaci√≥n 15 de enero de 2021',
                 
                 // Staking
                 'staking-rewards': 'Recompensas Acumuladas',
                 'apy-average': 'APY Promedio',
                 'total-portfolio': 'Portafolio Total'
             }
         };

         // Fonction pour changer la langue
         function changeLanguage(language) {
             console.log('üåê Changement de langue vers:', language);
             
             // Sauvegarder la langue s√©lectionn√©e
             sessionStorage.setItem('userLanguage', language);
             
             // Obtenir les traductions pour la langue s√©lectionn√©e
             const currentTranslations = translations[language] || translations.fr;
             
             // Traduire tous les √©l√©ments avec l'attribut data-translate
             document.querySelectorAll('[data-translate]').forEach(element => {
                 const key = element.getAttribute('data-translate');
                 const translation = currentTranslations[key];
                 
                 if (translation) {
                     if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                         element.placeholder = translation;
                     } else {
                         element.textContent = translation;
                     }
                 }
             });
             
             // Traduire les √©l√©ments sp√©cifiques
             translateSpecificElements(language, currentTranslations);
             
             // Afficher une notification
             const languageNames = {
                 'fr': 'Fran√ßais',
                 'en': 'English',
                 'es': 'Espa√±ol'
             };
             
             showNotification(`Langue chang√©e vers ${languageNames[language]}`, 'success');
             console.log('‚úÖ Langue chang√©e avec succ√®s');
         }

         // Fonction pour traduire les √©l√©ments sp√©cifiques
         function translateSpecificElements(language, translations) {
             // Traduire les √©l√©ments de navigation
             const navItems = document.querySelectorAll('.nav-label');
             navItems.forEach((item, index) => {
                 const keys = ['nav-home', 'nav-portfolio', 'nav-banking', 'nav-analytics', 'nav-staking'];
                 if (keys[index]) {
                     item.textContent = translations[keys[index]] || item.textContent;
                 }
             });
             
             // Traduire les titres et sous-titres
             const welcomeTitle = document.querySelector('.welcome-title');
             const welcomeSubtitle = document.querySelector('.welcome-subtitle');
             
             if (welcomeTitle) welcomeTitle.textContent = translations['welcome-title'];
             if (welcomeSubtitle) welcomeSubtitle.textContent = translations['welcome-subtitle'];
             
             // Traduire les boutons
             const depositBtn = document.querySelector('.deposit-btn');
             const withdrawBtn = document.querySelector('.withdraw-btn');
             
             if (depositBtn) depositBtn.textContent = translations['deposit-btn'];
             if (withdrawBtn) withdrawBtn.textContent = translations['withdraw-btn'];
             
             // Traduire les modales
             translateModalElements(translations);
         }

         // Fonction pour traduire les √©l√©ments des modales
         function translateModalElements(translations) {
             // Settings modal
             const settingsTitle = document.querySelector('.settings-modal-header h3');
             if (settingsTitle) settingsTitle.textContent = translations['settings-title'];
             
             // KYC modal
             const kycTitle = document.querySelector('.kyc-modal-header h3');
             if (kycTitle) kycTitle.textContent = translations['kyc-title'];
             
             // Profile modal
             const profileTitle = document.querySelector('.profile-modal-header h3');
             if (profileTitle) profileTitle.textContent = translations['profile-title'];
             
             // Traduire les sections
             const sectionTitles = document.querySelectorAll('.settings-section-title');
             sectionTitles.forEach((title, index) => {
                 const keys = ['account-section', 'security-section', 'support-section'];
                 if (keys[index]) {
                     title.textContent = translations[keys[index]];
                 }
             });
             
             // Traduire les options
             const accountOptions = document.querySelectorAll('.account-option-title');
             accountOptions.forEach((option, index) => {
                 const keys = ['profile-info', 'kyc-verification'];
                 if (keys[index]) {
                     option.textContent = translations[keys[index]];
                 }
             });
             
             const securityOptions = document.querySelectorAll('.security-option-title');
             securityOptions.forEach((option, index) => {
                 const keys = ['change-password', 'backup-phrase'];
                 if (keys[index]) {
                     option.textContent = translations[keys[index]];
                 }
             });
             
             const supportOptions = document.querySelectorAll('.support-option-title');
             supportOptions.forEach((option, index) => {
                 const keys = ['contact-support', 'about-us'];
                 if (keys[index]) {
                     option.textContent = translations[keys[index]];
                 }
             });
         }

         // Fonction pour initialiser la langue au chargement
         function initializeLanguage() {
             const savedLanguage = sessionStorage.getItem('userLanguage') || 'fr';
             changeLanguage(savedLanguage);
             
             // Mettre √† jour le s√©lecteur de langue
             const languageSelect = document.getElementById('accountLanguageSelect');
             if (languageSelect) {
                 languageSelect.value = savedLanguage;
             }
         }

         // G√©rer les changements de langue via le menu d√©roulant
         document.addEventListener('DOMContentLoaded', function() {
             const accountLanguageSelect = document.getElementById('accountLanguageSelect');
             
             if (accountLanguageSelect) {
                 accountLanguageSelect.addEventListener('change', function() {
                     const selectedLanguage = this.value;
                     changeLanguage(selectedLanguage);
                 });
             }
             
             // Initialiser la langue au chargement
             initializeLanguage();

             // G√©rer les clics sur les options de compte
             const accountOptions = document.querySelectorAll('.account-option');
             console.log('üîç Nombre d\'options de compte trouv√©es:', accountOptions.length);
             
             accountOptions.forEach((option, index) => {
                 console.log(`üîç Option ${index}:`, option);
                 const titleElement = option.querySelector('.account-option-title');
                 if (titleElement) {
                     console.log(`üîç Titre trouv√©: "${titleElement.textContent}"`);
                 }
                 
                 option.addEventListener('click', function(e) {
                     console.log('üñ±Ô∏è Clic d√©tect√© sur option de compte');
                     e.preventDefault();
                     e.stopPropagation();
                     
                     const title = this.querySelector('.account-option-title').textContent;
                     console.log('üîç Titre cliqu√©:', title);
                     
                     if (title === 'Profil d\'information') {
                         console.log('üöÄ Tentative d\'ouverture modal profil...');
                         openProfileModal();
                     } else if (title === 'V√©rification KYC') {
                         console.log('üöÄ Tentative d\'ouverture modal KYC...');
                         openKYCModal();
                     }
                 });
             });

             // G√©rer les clics sur les options de s√©curit√©
             const securityOptions = document.querySelectorAll('.security-option');
             console.log('üîç Nombre d\'options de s√©curit√© trouv√©es:', securityOptions.length);
             
             securityOptions.forEach(option => {
                 console.log('üîç Option de s√©curit√©:', option);
                 
                 // Supprimer les event listeners existants pour √©viter les doublons
                 option.removeEventListener('click', handleSecurityOptionClick);
                 
                 // Ajouter le nouvel event listener
                 option.addEventListener('click', handleSecurityOptionClick);
             });
             
             // Fonction pour g√©rer les clics sur les options de s√©curit√©
             function handleSecurityOptionClick(event) {
                 console.log('üñ±Ô∏è Clic d√©tect√© sur option de s√©curit√©');
                 event.preventDefault();
                 event.stopPropagation();
                 
                 const titleElement = this.querySelector('.security-option-title');
                 if (!titleElement) {
                     console.error('‚ùå Titre non trouv√© dans l\'option de s√©curit√©');
                     return;
                 }
                 
                 const title = titleElement.textContent.trim();
                 console.log('üîç Titre cliqu√©:', title);
                 
                 if (title === 'Changer le mot de passe') {
                     showNotification('Fonctionnalit√© "Changer le mot de passe" √† venir...', 'info');
                 } else if (title === 'Backup phrase') {
                     console.log('üöÄ Tentative d\'ouverture page backup phrase...');
                     
                     // V√©rifier si la fonction existe
                     if (typeof window.openBackupPhrasePage === 'function') {
                         window.openBackupPhrasePage();
                     } else {
                         console.error('‚ùå Fonction openBackupPhrasePage non trouv√©e');
                         
                         // Essayer d'ouvrir directement
                         try {
                             const backupPage = document.getElementById('backupPhrasePage');
                             if (backupPage) {
                                 backupPage.style.display = 'block';
                                 console.log('‚úÖ Page backup affich√©e directement');
                                 
                                 // G√©n√©rer et afficher les mots
                                 if (typeof window.generateBackupWords === 'function') {
                                     window.backupWords = window.generateBackupWords();
                                     if (typeof window.displayBackupWords === 'function') {
                                         window.displayBackupWords();
                                     }
                                     if (typeof window.showBackupStep === 'function') {
                                         window.showBackupStep(1);
                                     }
                                 }
                             } else {
                                 console.error('‚ùå √âl√©ment backupPhrasePage non trouv√©');
                                 showNotification('Erreur: page backup phrase non trouv√©e', 'error');
                             }
                         } catch (error) {
                             console.error('‚ùå Erreur lors de l\'ouverture directe:', error);
                             showNotification('Erreur lors de l\'ouverture de la page backup phrase', 'error');
                         }
                     }
                 }
             }

             // G√©rer les clics sur les options de support
             const supportOptions = document.querySelectorAll('.support-option');
             
             supportOptions.forEach(option => {
                 option.addEventListener('click', function() {
                     const title = this.querySelector('.support-option-title').textContent;
                     
                     if (title === 'Contact Support') {
                         showContactSupport();
                     } else if (title === 'About Us') {
                         showAboutUsPage();
                     }
                 });
             });
         });

         // Fermer la modal en cliquant √† l'ext√©rieur
         document.addEventListener('click', function(e) {
             const modal = document.getElementById('settingsModal');
             const modalContent = modal?.querySelector('.settings-modal-content');
             
             if (modal && modalContent && !modalContent.contains(e.target) && modal.classList.contains('active')) {
                 closeSettingsModal();
             }
         });

         // Fermer les modales en cliquant √† l'ext√©rieur (pour profil et KYC)
         document.addEventListener('click', function(e) {
             const profileModal = document.getElementById('profileModal');
             const profileContent = profileModal?.querySelector('.profile-modal-content');
             
             if (profileModal && profileContent && !profileContent.contains(e.target) && profileModal.classList.contains('active')) {
                 closeProfileModal();
             }

             const kycModal = document.getElementById('kycModal');
             const kycContent = kycModal?.querySelector('.kyc-modal-content');
             
             if (kycModal && kycContent && !kycContent.contains(e.target) && kycModal.classList.contains('active')) {
                 closeKYCModal();
             }
         });
     </script>

    <!-- Crypto Detail Page -->
    <div class="crypto-detail-page" id="cryptoDetailPage">
        <div class="crypto-detail-header">
            <div class="crypto-detail-back" onclick="closeCryptoDetail()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                </svg>
                Retour
            </div>
            <div class="crypto-detail-title" id="cryptoDetailTitle">Bitcoin</div>
            <div class="crypto-detail-price" id="cryptoDetailPrice">‚Ç¨34,521.50</div>
            <div class="crypto-detail-change positive" id="cryptoDetailChange">+2.34% (24h)</div>
        </div>
        
        <div class="crypto-detail-content">
            <div class="crypto-chart-container">
                <div class="crypto-chart-title">Graphique des prix</div>
                <div class="crypto-chart">
                    <div class="chart-header">
                        <div class="chart-timeframe">
                            <button class="timeframe-btn active" data-timeframe="1H">1H</button>
                            <button class="timeframe-btn" data-timeframe="24H">24H</button>
                            <button class="timeframe-btn" data-timeframe="7D">7J</button>
                            <button class="timeframe-btn" data-timeframe="1M">1M</button>
                        </div>
                        <div class="chart-live-indicator">
                            <span class="live-dot"></span>
                            <span class="live-text">Temps r√©el</span>
                            <span class="last-update" id="lastUpdateTime"></span>
                        </div>
                        <button class="test-chart-btn" onclick="createTestChart()" title="Test graphique">
                            Test
                        </button>
                        <button class="debug-chart-btn" onclick="debugChartSystem()" title="Debug syst√®me" style="margin-left: 10px; padding: 4px 8px; background: #f0f0f0; border: 1px solid #ccc; border-radius: 4px; font-size: 12px;">
                            Debug
                        </button>
                        <button class="force-update-btn" onclick="forceChartUpdate()" title="Forcer mise √† jour" style="margin-left: 10px; padding: 4px 8px; background: #007A3D; color: white; border: 1px solid #007A3D; border-radius: 4px; font-size: 12px;">
                            Actualiser
                        </button>
                        <button class="zero-balance-btn" onclick="forceZeroBalances()" title="Forcer soldes √† z√©ro" style="margin-left: 10px; padding: 4px 8px; background: #FF6B35; color: white; border: 1px solid #FF6B35; border-radius: 4px; font-size: 12px;">
                            Z√©ro
                        </button>
                        <button class="test-system-btn" onclick="testCryptoPriceSystem()" title="Test syst√®me" style="margin-left: 10px; padding: 4px 8px; background: #9C27B0; color: white; border: 1px solid #9C27B0; border-radius: 4px; font-size: 12px;">
                            Test
                        </button>
                    </div>
                                         <div class="chart-container">
                         <div class="chart-loading" id="chartLoading">
                             <div class="loading-spinner"></div>
                             <span>Chargement du graphique...</span>
                         </div>
                         <canvas id="cryptoChart" width="400" height="200"></canvas>
                         <div class="chart-overlay">
                             <div class="price-indicator">
                                 <span class="current-price" id="chartCurrentPrice">‚Ç¨--</span>
                                 <span class="price-change" id="chartPriceChange">--</span>
                             </div>
                         </div>
                     </div>
                </div>
            </div>

            <div class="crypto-stats-grid">
                <div class="crypto-stat-card">
                    <div class="crypto-stat-label">Prix actuel</div>
                    <div class="crypto-stat-value" id="cryptoCurrentPrice">‚Ç¨34,521.50</div>
                </div>
                <div class="crypto-stat-card">
                    <div class="crypto-stat-label">24h</div>
                    <div class="crypto-stat-value positive" id="crypto24hChange">+2.34%</div>
                </div>
                <div class="crypto-stat-card">
                    <div class="crypto-stat-label">7 jours</div>
                    <div class="crypto-stat-value positive" id="crypto7dChange">+8.45%</div>
                </div>
                <div class="crypto-stat-card">
                    <div class="crypto-stat-label">Volume 24h</div>
                    <div class="crypto-stat-value" id="cryptoVolume">‚Ç¨28.5B</div>
                </div>
                <div class="crypto-stat-card">
                    <div class="crypto-stat-label">Capitalisation</div>
                    <div class="crypto-stat-value" id="cryptoMarketCap">‚Ç¨675.2B</div>
                </div>
                <div class="crypto-stat-card">
                    <div class="crypto-stat-label">Votre solde</div>
                    <div class="crypto-stat-value" id="cryptoBalance">0.000 BTC</div>
                </div>
            </div>

            <div class="crypto-actions">
                <button class="crypto-action-btn" onclick="cryptoAction('deposit')">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 5v14M5 12l7 7 7-7"/>
                    </svg>
                    D√©p√¥t
                </button>
                <button class="crypto-action-btn secondary" onclick="cryptoAction('withdraw')">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 19V5M5 12l7-7 7 7"/>
                    </svg>
                    Retrait
                </button>
                <button class="crypto-action-btn" onclick="cryptoAction('exchange')">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M7 16V4M17 20V8M3 8h4l4-4 4 4h4M3 16h4l4 4 4-4h4"/>
                    </svg>
                    √âchanger
                </button>
                <button class="crypto-action-btn secondary" onclick="cryptoAction('history')">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                    Historique
                </button>
            </div>
        </div>
    </div>

    <!-- Modal Profil d'information -->
    <div class="profile-modal" id="profileModal">
        <div class="profile-modal-content">
            <div class="profile-modal-header">
                <h3>Profil d'information</h3>
                <button class="close-btn" onclick="closeProfileModal()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            
            <div class="profile-modal-body">
                <div class="profile-section">
                    <h4>Informations personnelles</h4>
                    <div class="profile-grid">
                        <div class="profile-field">
                            <label>Pr√©nom</label>
                            <input type="text" id="profileFirstName" value="Admin" readonly>
                        </div>
                        <div class="profile-field">
                            <label>Nom de famille</label>
                            <input type="text" id="profileLastName" value="System" readonly>
                        </div>
                        <div class="profile-field">
                            <label>Adresse e-mail</label>
                            <input type="email" id="profileEmail" value="admin@lloyds.com" readonly>
                        </div>
                        <div class="profile-field">
                            <label>Num√©ro de t√©l√©phone</label>
                            <input type="tel" id="profilePhone" value="+33 1 23 45 67 89" readonly>
                        </div>
                    </div>
                </div>

                <div class="profile-section">
                    <h4>Informations KYC <span id="kycStatus" style="font-size: 12px; font-weight: normal; color: #6B7280;"></span></h4>
                    <div class="profile-grid">
                        <div class="profile-field">
                            <label>Date de naissance</label>
                            <input type="date" id="profileBirthDate" value="1985-03-15" readonly>
                        </div>
                        <div class="profile-field">
                            <label>Pays de r√©sidence</label>
                            <input type="text" id="profileCountry" value="France" readonly>
                        </div>
                        <div class="profile-field">
                            <label>Adresse</label>
                            <input type="text" id="profileAddress" value="123 Rue de la Paix" readonly>
                        </div>
                        <div class="profile-field">
                            <label>Code postal</label>
                            <input type="text" id="profilePostalCode" value="75001" readonly>
                        </div>
                        <div class="profile-field">
                            <label>Ville</label>
                            <input type="text" id="profileCity" value="Paris" readonly>
                        </div>
                        <div class="profile-field">
                            <label>Nationalit√©</label>
                            <input type="text" id="profileNationality" value="Fran√ßaise" readonly>
                        </div>
                    </div>
                </div>

                <div class="profile-section">
                    <h4>Informations professionnelles <span id="professionalStatus" style="font-size: 12px; font-weight: normal; color: #6B7280;"></span></h4>
                    <div class="profile-grid">
                        <div class="profile-field">
                            <label>Profession</label>
                            <input type="text" id="profileProfession" value="" readonly>
                        </div>
                        <div class="profile-field">
                            <label>Source de revenus</label>
                            <input type="text" id="profileIncomeSource" value="" readonly>
                        </div>
                        <div class="profile-field">
                            <label>Revenu annuel</label>
                            <input type="text" id="profileAnnualIncome" value="" readonly>
                        </div>
                        <div class="profile-field">
                            <label>Num√©ro fiscal</label>
                            <input type="text" id="profileTaxNumber" value="" readonly>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="profile-info-note">
                <div class="info-note-content">
                    <div class="info-note-icon">‚ÑπÔ∏è</div>
                    <div class="info-note-text">
                        <strong>Note importante :</strong> Les informations affich√©es proviennent de votre dossier KYC. Pour modifier ces informations, vous devez soumettre une nouvelle demande KYC avec les frais de 150 euros.
                    </div>
                </div>
            </div>
            
            <div class="profile-modal-actions">
                <button class="profile-btn secondary" onclick="closeProfileModal()">Fermer</button>
            </div>
        </div>
    </div>

    <!-- Modal V√©rification KYC -->
    <div class="kyc-modal" id="kycModal">
        <div class="kyc-modal-content">
            <div class="kyc-modal-header">
                <h3>V√©rification KYC</h3>
                <button class="close-btn" onclick="closeKYCModal()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            
            <div class="kyc-modal-body">
                <!-- √âtape 1: Informations personnelles -->
                <div class="kyc-step" id="kycStep1">
                    <div class="kyc-step-header">
                        <div class="kyc-step-number">1</div>
                        <div class="kyc-step-info">
                            <h4 data-translate="personal-info">Informations personnelles</h4>
                            <p data-translate="personal-info-desc">V√©rifiez vos informations de base</p>
                        </div>
                        <div class="kyc-step-status completed">‚úì</div>
                    </div>
                    <div class="kyc-step-content">
                        <div class="kyc-form-grid">
                            <div class="kyc-field">
                                <label data-translate="first-name">Pr√©nom *</label>
                                <input type="text" id="kycFirstName" value="" placeholder="Votre pr√©nom">
                            </div>
                            <div class="kyc-field">
                                <label>Nom de famille *</label>
                                <input type="text" id="kycLastName" value="" placeholder="Votre nom de famille">
                            </div>
                            <div class="kyc-field">
                                <label>Date de naissance *</label>
                                <input type="date" id="kycBirthDate" value="1985-03-15">
                                <small style="color: #6B7280; font-size: 12px; margin-top: 4px;">Vous devez avoir plus de 18 ans</small>
                            </div>
                            <div class="kyc-field">
                                <label>Nationalit√© *</label>
                                <select id="kycNationality">
                                    <option value="Fran√ßaise" selected>Fran√ßaise</option>
                                    <option value="Belge">Belge</option>
                                    <option value="Suisse">Suisse</option>
                                    <option value="Canadienne">Canadienne</option>
                                    <option value="Am√©ricaine">Am√©ricaine</option>
                                    <option value="Allemande">Allemande</option>
                                    <option value="Italienne">Italienne</option>
                                    <option value="Espagnole">Espagnole</option>
                                    <option value="Portugaise">Portugaise</option>
                                    <option value="N√©erlandaise">N√©erlandaise</option>
                                    <option value="Autre">Autre</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- √âtape 2: Adresse -->
                <div class="kyc-step" id="kycStep2">
                    <div class="kyc-step-header">
                        <div class="kyc-step-number">2</div>
                        <div class="kyc-step-info">
                            <h4 data-translate="residence-address">Adresse de r√©sidence</h4>
                            <p data-translate="residence-address-desc">Confirmez votre adresse actuelle</p>
                        </div>
                        <div class="kyc-step-status completed">‚úì</div>
                    </div>
                    <div class="kyc-step-content">
                        <div class="kyc-form-grid">
                            <div class="kyc-field">
                                <label>Pays *</label>
                                <select id="kycCountry">
                                    <option value="France" selected>France</option>
                                    <option value="Belgique">Belgique</option>
                                    <option value="Suisse">Suisse</option>
                                    <option value="Canada">Canada</option>
                                    <option value="√âtats-Unis">√âtats-Unis</option>
                                    <option value="Allemagne">Allemagne</option>
                                    <option value="Italie">Italie</option>
                                    <option value="Espagne">Espagne</option>
                                    <option value="Portugal">Portugal</option>
                                    <option value="Pays-Bas">Pays-Bas</option>
                                    <option value="Luxembourg">Luxembourg</option>
                                    <option value="Autre">Autre</option>
                                </select>
                            </div>
                            <div class="kyc-field">
                                <label>Adresse *</label>
                                <input type="text" id="kycAddress" value="123 Rue de la Paix" placeholder="Votre adresse compl√®te">
                            </div>
                            <div class="kyc-field">
                                <label>Code postal *</label>
                                <input type="text" id="kycPostalCode" value="75001" placeholder="Code postal">
                            </div>
                            <div class="kyc-field">
                                <label>Ville *</label>
                                <input type="text" id="kycCity" value="Paris" placeholder="Ville">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- √âtape 3: Informations professionnelles -->
                <div class="kyc-step" id="kycStep3">
                    <div class="kyc-step-header">
                        <div class="kyc-step-number">3</div>
                        <div class="kyc-step-info">
                            <h4 data-translate="professional-info">Informations professionnelles</h4>
                            <p data-translate="professional-info-desc">Vos informations professionnelles et financi√®res</p>
                        </div>
                        <div class="kyc-step-status pending">‚è≥</div>
                    </div>
                    <div class="kyc-step-content">
                        <div class="kyc-form-grid">
                            <div class="kyc-field">
                                <label>Profession *</label>
                                <select id="kycProfession">
                                    <option value="">S√©lectionnez votre profession</option>
                                    <option value="Salari√©">Salari√©</option>
                                    <option value="Ind√©pendant">Ind√©pendant</option>
                                    <option value="Dirigeant">Dirigeant</option>
                                    <option value="Retrait√©">Retrait√©</option>
                                    <option value="√âtudiant">√âtudiant</option>
                                    <option value="Ch√¥meur">Ch√¥meur</option>
                                    <option value="Fonctionnaire">Fonctionnaire</option>
                                    <option value="Profession lib√©rale">Profession lib√©rale</option>
                                    <option value="Commer√ßant">Commer√ßant</option>
                                    <option value="Artisan">Artisan</option>
                                    <option value="Agriculteur">Agriculteur</option>
                                    <option value="Autre">Autre</option>
                                </select>
                            </div>
                            <div class="kyc-field">
                                <label>Source de revenus *</label>
                                <select id="kycIncomeSource">
                                    <option value="">S√©lectionnez votre source de revenus</option>
                                    <option value="Salaire">Salaire</option>
                                    <option value="Revenus d'activit√©">Revenus d'activit√©</option>
                                    <option value="Pension de retraite">Pension de retraite</option>
                                    <option value="Allocations ch√¥mage">Allocations ch√¥mage</option>
                                    <option value="Revenus de placement">Revenus de placement</option>
                                    <option value="Revenus locatifs">Revenus locatifs</option>
                                    <option value="H√©ritage">H√©ritage</option>
                                    <option value="Donation">Donation</option>
                                    <option value="Revenus de trading">Revenus de trading</option>
                                    <option value="Revenus de cryptomonnaies">Revenus de cryptomonnaies</option>
                                    <option value="Autre">Autre</option>
                                </select>
                            </div>
                            <div class="kyc-field">
                                <label>Revenu annuel *</label>
                                <select id="kycAnnualIncome">
                                    <option value="">S√©lectionnez votre revenu annuel</option>
                                    <option value="Moins de 15 000 ‚Ç¨">Moins de 15 000 ‚Ç¨</option>
                                    <option value="15 000 ‚Ç¨ - 30 000 ‚Ç¨">15 000 ‚Ç¨ - 30 000 ‚Ç¨</option>
                                    <option value="30 000 ‚Ç¨ - 50 000 ‚Ç¨">30 000 ‚Ç¨ - 50 000 ‚Ç¨</option>
                                    <option value="50 000 ‚Ç¨ - 75 000 ‚Ç¨">50 000 ‚Ç¨ - 75 000 ‚Ç¨</option>
                                    <option value="75 000 ‚Ç¨ - 100 000 ‚Ç¨">75 000 ‚Ç¨ - 100 000 ‚Ç¨</option>
                                    <option value="100 000 ‚Ç¨ - 150 000 ‚Ç¨">100 000 ‚Ç¨ - 150 000 ‚Ç¨</option>
                                    <option value="150 000 ‚Ç¨ - 200 000 ‚Ç¨">150 000 ‚Ç¨ - 200 000 ‚Ç¨</option>
                                    <option value="Plus de 200 000 ‚Ç¨">Plus de 200 000 ‚Ç¨</option>
                                </select>
                            </div>
                            <div class="kyc-field">
                                <label>Num√©ro fiscal *</label>
                                <input type="text" id="kycTaxNumber" placeholder="Votre num√©ro fiscal (ex: 1234567890123)" maxlength="13">
                                <small style="color: #6B7280; font-size: 12px; margin-top: 4px;">Num√©ro fiscal fran√ßais √† 13 chiffres</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- √âtape 4: Documents d'identit√© -->
                <div class="kyc-step" id="kycStep4">
                    <div class="kyc-step-header">
                        <div class="kyc-step-number">4</div>
                        <div class="kyc-step-info">
                            <h4 data-translate="identity-documents">Documents d'identit√©</h4>
                            <p data-translate="identity-documents-desc">T√©l√©chargez vos documents officiels</p>
                        </div>
                        <div class="kyc-step-status pending">‚è≥</div>
                    </div>
                    <div class="kyc-step-content">
                        <div class="document-upload-section">
                            <div class="document-item">
                                <div class="document-icon">üÜî</div>
                                <div class="document-info">
                                    <h5>Carte d'identit√© / Passeport</h5>
                                    <p>Recto et verso de votre document d'identit√©</p>
                                </div>
                                <div class="upload-section">
                                    <input type="file" id="identityDocument" accept="image/*,.pdf" style="display: none;" onchange="handleFileUpload(this, 'identity')">
                                    <button class="upload-btn" onclick="document.getElementById('identityDocument').click()">
                                        <span class="upload-text">T√©l√©charger</span>
                                        <span class="upload-icon">üìÅ</span>
                                    </button>
                                    <div class="upload-status" id="identityStatus"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- √âtape 5: V√©rification finale -->
                <div class="kyc-step" id="kycStep5">
                    <div class="kyc-step-header">
                        <div class="kyc-step-number">5</div>
                        <div class="kyc-step-info">
                            <h4 data-translate="final-verification">V√©rification finale</h4>
                            <p data-translate="final-verification-desc">Conditions et soumission</p>
                        </div>
                        <div class="kyc-step-status pending">‚è≥</div>
                    </div>
                    <div class="kyc-step-content">
                        <div class="verification-summary">
                            <div class="summary-item">
                                <span class="summary-label">Statut :</span>
                                <span class="summary-value status-pending">En attente de v√©rification</span>
                            </div>
                            <div class="summary-item">
                                <span class="summary-label">Condition de validation :</span>
                                <span class="summary-value status-required">Pour valider votre KYC, un d√©p√¥t minimum de 150 euros sera requis.</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="kyc-modal-actions">
                <button class="kyc-btn secondary" onclick="closeKYCModal()">Fermer</button>
                <button class="kyc-btn primary" onclick="submitKYC()">Soumettre KYC</button>
            </div>
        </div>
    </div>

    <!-- Modal de param√®tres -->
    <div class="settings-modal" id="settingsModal">
        <div class="settings-modal-content">
            <div class="settings-modal-header">
                <h3 data-translate="settings-title">Param√®tres</h3>
                <button class="close-btn" onclick="closeSettingsModal()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            
            <div class="settings-modal-body">
                <!-- Section Compte -->
                <div class="settings-section">
                    <div class="settings-section-title" data-translate="account-section">Compte</div>
                    <div class="account-section">
                        <div class="account-row">
                            <div class="account-option">
                                <div class="account-option-icon">üë§</div>
                                <div class="account-option-text">
                                    <div class="account-option-title">Profil d'information</div>
                                    <div class="account-option-desc">G√©rer vos informations personnelles</div>
                                </div>
                                <div class="account-option-arrow">‚Üí</div>
                            </div>
                        </div>
                        <div class="account-row">
                            <div class="account-option">
                                <div class="account-option-icon">‚úÖ</div>
                                <div class="account-option-text">
                                    <div class="account-option-title">V√©rification KYC</div>
                                    <div class="account-option-desc">V√©rifier votre identit√©</div>
                                </div>
                                <div class="account-option-arrow">‚Üí</div>
                            </div>
                        </div>
                        <div class="account-row">
                            <div class="account-language-option">
                                <div class="account-option-icon">üåê</div>
                                <div class="account-option-text">
                                    <div class="account-option-title">Langue</div>
                                    <div class="account-option-desc">Choisir la langue d'affichage</div>
                                </div>
                                <div class="language-dropdown-container">
                                    <select class="language-dropdown" id="accountLanguageSelect">
                                        <option value="fr">üá´üá∑ Fran√ßais</option>
                                        <option value="en">üá¨üáß English</option>
                                        <option value="es">üá™üá∏ Espa√±ol</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Section S√©curit√© -->
                <div class="settings-section">
                    <div class="settings-section-title">S√©curit√©</div>
                    <div class="security-section">
                        <div class="security-row">
                            <div class="security-option">
                                <div class="security-option-icon">üîí</div>
                                <div class="security-option-text">
                                    <div class="security-option-title">Changer le mot de passe</div>
                                    <div class="security-option-desc">Modifier votre mot de passe de connexion</div>
                                </div>
                                <div class="security-option-arrow">‚Üí</div>
                            </div>
                        </div>
                        <div class="security-row">
                            <div class="security-option" onclick="openBackupPhrasePage()" style="cursor: pointer;">
                                <div class="security-option-icon">üîë</div>
                                <div class="security-option-text">
                                    <div class="security-option-title">Backup phrase</div>
                                    <div class="security-option-desc">G√©rer votre phrase de r√©cup√©ration</div>
                                </div>
                                <div class="security-option-arrow">‚Üí</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Section Support -->
                <div class="settings-section">
                    <div class="settings-section-title">Support</div>
                    <div class="support-section">
                        <div class="support-row">
                            <div class="support-option" onclick="showContactSupport()">
                                <div class="support-option-icon">üìû</div>
                                <div class="support-option-text">
                                    <div class="support-option-title">Contact Support</div>
                                    <div class="support-option-desc">Contacter notre √©quipe support</div>
                                </div>
                                <div class="support-option-arrow">‚Üí</div>
                            </div>
                        </div>
                        <div class="support-row">
                            <div class="support-option" onclick="showAboutUsPage()">
                                <div class="support-option-icon">‚ÑπÔ∏è</div>
                                <div class="support-option-text">
                                    <div class="support-option-title">About Us</div>
                                    <div class="support-option-desc">√Ä propos de Lloyd's GO!</div>
                                </div>
                                <div class="support-option-arrow">‚Üí</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="settings-modal-actions">
                <button class="settings-btn secondary" onclick="closeSettingsModal()">Annuler</button>
                <button class="settings-btn primary" onclick="saveSettings()">Enregistrer</button>
            </div>
            
            <!-- Informations de version -->
            <div class="app-version-info">
                <div class="version-details">
                    <span class="version-text">Version 3.15</span>
                    <span class="build-text">Build A23.L11B05</span>
                    <span class="update-text">Derni√®re mise √† jour : 15 janvier 2021</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Contact Support Page -->
    <div class="contact-support-page" id="contactSupportPage">
        <div class="contact-support-header">
            <div class="contact-support-back" onclick="closeContactSupportPage()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                </svg>
                Retour
            </div>
            <div class="contact-support-title">Contact Support</div>
            <div class="contact-support-subtitle">Notre √©quipe est l√† pour vous aider</div>
        </div>
        
        <div class="contact-support-content">
            <div class="support-info-card">
                <div class="support-info-icon">üìß</div>
                <div class="support-info-title">Email Support</div>
                <div class="support-info-email" id="supportEmail">support@lloydbanq.pro</div>
                <button class="copy-email-btn" onclick="copySupportEmail()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/>
                        <rect x="8" y="2" width="8" height="4" rx="1" ry="1"/>
                    </svg>
                    Copier l'email
                </button>
            </div>

            <div class="support-details">
                <div class="support-detail-item">
                    <div class="support-detail-icon">üïí</div>
                    <div class="support-detail-text">
                        <div class="support-detail-title">Disponibilit√©</div>
                        <div class="support-detail-desc">24h/24 et 7j/7</div>
                    </div>
                </div>
                
                <div class="support-detail-item">
                    <div class="support-detail-icon">‚ö°</div>
                    <div class="support-detail-text">
                        <div class="support-detail-title">Temps de r√©ponse</div>
                        <div class="support-detail-desc">Moins de 2 heures</div>
                    </div>
                </div>
                
                <div class="support-detail-item">
                    <div class="support-detail-icon">üåç</div>
                    <div class="support-detail-text">
                        <div class="support-detail-title">Langues</div>
                        <div class="support-detail-desc">Fran√ßais, Anglais, Espagnol</div>
                    </div>
                </div>
            </div>

            <div class="support-actions">
                <button class="support-action-btn primary" onclick="sendSupportEmail()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                        <polyline points="22,6 12,13 2,6"/>
                    </svg>
                    Envoyer un email
                </button>
            </div>
        </div>
    </div>

    <!-- About Us Page -->
    <div class="about-us-page" id="aboutUsPage">
        <div class="about-us-header">
            <div class="about-us-back" onclick="closeAboutUsPage()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                </svg>
                Retour
            </div>
            <div class="about-us-title">√Ä propos de Lloyd's GO!</div>
            <div class="about-us-subtitle">Votre partenaire financier de confiance</div>
        </div>
        
        <div class="about-us-content">
            <div class="about-us-logo">
                <div class="logo-icon">üè¶</div>
                <div class="logo-text">Lloyd's GO!</div>
            </div>

            <div class="about-us-section">
                <h3>Notre Mission</h3>
                <p>Lloyd's GO! r√©volutionne l'exp√©rience bancaire en combinant innovation technologique et service client d'excellence. Nous nous engageons √† offrir des solutions financi√®res modernes, s√©curis√©es et accessibles √† tous.</p>
            </div>

            <div class="about-us-section">
                <h3>Nos Valeurs</h3>
                <div class="values-grid">
                    <div class="value-item">
                        <div class="value-icon">üîí</div>
                        <div class="value-title">S√©curit√©</div>
                        <div class="value-desc">Protection maximale de vos donn√©es</div>
                    </div>
                    <div class="value-item">
                        <div class="value-icon">‚ö°</div>
                        <div class="value-title">Innovation</div>
                        <div class="value-desc">Technologies de pointe</div>
                    </div>
                    <div class="value-item">
                        <div class="value-icon">ü§ù</div>
                        <div class="value-title">Confiance</div>
                        <div class="value-desc">Relation client durable</div>
                    </div>
                    <div class="value-item">
                        <div class="value-icon">üåç</div>
                        <div class="value-title">Accessibilit√©</div>
                        <div class="value-desc">Services disponibles partout</div>
                    </div>
                </div>
            </div>

            <div class="about-us-section">
                <h3>Nos Services</h3>
                <div class="services-list">
                    <div class="service-item">
                        <div class="service-icon">üí≥</div>
                        <div class="service-text">Comptes bancaires s√©curis√©s</div>
                    </div>
                    <div class="service-item">
                        <div class="service-icon">üì±</div>
                        <div class="service-text">Application mobile intuitive</div>
                    </div>
                    <div class="service-item">
                        <div class="service-icon">üí±</div>
                        <div class="service-text">Trading crypto avanc√©</div>
                    </div>
                    <div class="service-item">
                        <div class="service-icon">üìä</div>
                        <div class="service-text">Analyses en temps r√©el</div>
                    </div>
                </div>
            </div>

            <div class="about-us-footer">
                <div class="version-info">
                    <span>Version 3.15</span>
                    <span>‚Ä¢</span>
                    <span>Build A23.L11B05</span>
                </div>
                <div class="copyright">
                    ¬© 2024 Lloyd's GO! - Tous droits r√©serv√©s
                </div>
            </div>
        </div>
    </div>

    <!-- Backup Phrase Page -->
    <div class="backup-phrase-page" id="backupPhrasePage">
        <div class="backup-phrase-header">
            <div class="backup-phrase-back" onclick="closeBackupPhrasePage()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                </svg>
                Retour
            </div>
            <div class="backup-phrase-title">Phrase de R√©cup√©ration</div>
            <div class="backup-phrase-subtitle">Sauvegardez vos 12 mots secrets en toute s√©curit√©</div>
        </div>
        
        <div class="backup-phrase-content">
            <!-- √âtape 1: Avertissement et mots secrets -->
            <div class="backup-step" id="backupStep1">
                <div class="backup-warning">
                    <div class="warning-icon">‚ö†Ô∏è</div>
                    <div class="warning-content">
                        <h3>Important : S√©curisez votre phrase de r√©cup√©ration</h3>
                        <p>Votre phrase de r√©cup√©ration est la cl√© de votre portefeuille. Si vous la perdez, vous perdrez l'acc√®s √† tous vos fonds.</p>
                        <ul>
                            <li>√âcrivez les 12 mots dans l'ordre exact</li>
                            <li>Gardez-les dans un endroit s√ªr et secret</li>
                            <li>Ne les partagez jamais avec qui que ce soit</li>
                            <li>Ne les stockez pas sur votre ordinateur ou t√©l√©phone</li>
                        </ul>
                    </div>
                </div>

                <div class="backup-words-container">
                    <div class="backup-words-title">Vos 12 mots secrets</div>
                    <div class="backup-words-grid" id="backupWordsGrid">
                        <!-- Les mots seront g√©n√©r√©s dynamiquement -->
                    </div>
                </div>

                <div class="backup-actions">
                    <button class="backup-btn secondary" onclick="closeBackupPhrasePage()">Annuler</button>
                    <button class="backup-btn primary" onclick="startVerification()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M9 12l2 2 4-4M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9 9 4.03 9 9z"/>
                        </svg>
                        J'ai sauvegard√© mes mots
                    </button>
                </div>
            </div>

            <!-- √âtape 2: V√©rification avec 3 sections -->
            <div class="backup-step" id="backupStep2" style="display: none;">
                <div class="verification-header">
                    <div class="verification-icon">üîç</div>
                    <div class="verification-title">V√©rifiez votre sauvegarde</div>
                    <div class="verification-subtitle">S√©lectionnez la position de 3 mots dans votre liste pour confirmer votre sauvegarde</div>
                </div>

                <!-- Section 1 -->
                <div class="verification-section" id="section1">
                    <div class="section-header">
                        <div class="section-number">1</div>
                        <div class="section-title">Premier mot √† v√©rifier</div>
                    </div>
                    <div class="section-content">
                        <div class="word-instruction">S√©lectionnez le mot √† la position <span class="word-position" id="position1">?</span> dans votre liste</div>
                        <div class="word-options-grid" id="optionsGrid1">
                            <!-- Options g√©n√©r√©es dynamiquement -->
                        </div>
                        <div class="section-status" id="status1">En attente de s√©lection</div>
                    </div>
                </div>

                <!-- Section 2 -->
                <div class="verification-section" id="section2">
                    <div class="section-header">
                        <div class="section-number">2</div>
                        <div class="section-title">Deuxi√®me mot √† v√©rifier</div>
                    </div>
                    <div class="section-content">
                        <div class="word-instruction">S√©lectionnez le mot √† la position <span class="word-position" id="position2">?</span> dans votre liste</div>
                        <div class="word-options-grid" id="optionsGrid2">
                            <!-- Options g√©n√©r√©es dynamiquement -->
                        </div>
                        <div class="section-status" id="status2">En attente de s√©lection</div>
                    </div>
                </div>

                <!-- Section 3 -->
                <div class="verification-section" id="section3">
                    <div class="section-header">
                        <div class="section-number">3</div>
                        <div class="section-title">Troisi√®me mot √† v√©rifier</div>
                    </div>
                    <div class="section-content">
                        <div class="word-instruction">S√©lectionnez le mot √† la position <span class="word-position" id="position3">?</span> dans votre liste</div>
                        <div class="word-options-grid" id="optionsGrid3">
                            <!-- Options g√©n√©r√©es dynamiquement -->
                        </div>
                        <div class="section-status" id="status3">En attente de s√©lection</div>
                    </div>
                </div>

                <div class="verification-actions">
                    <button class="verification-btn secondary" onclick="restartVerification()">Recommencer</button>
                    <button class="verification-btn primary" id="nextVerificationBtn" onclick="goToFinalConfirmation()" disabled>
                        Suivant
                    </button>
                </div>
            </div>

            <!-- √âtape 3: Confirmation finale -->
            <div class="backup-step" id="backupStep3" style="display: none;">
                <div class="final-confirmation-container">
                    <div class="final-confirmation-icon">üîí</div>
                    <div class="final-confirmation-title">Confirmation finale</div>
                    <div class="final-confirmation-message">
                        <p>Vous √™tes sur le point de finaliser votre phrase de r√©cup√©ration.</p>
                        <p><strong>Attention : Une fois valid√©e, vos 12 mots secrets ne pourront plus √™tre modifi√©s.</strong></p>
                        <p>Assurez-vous d'avoir bien sauvegard√© vos mots dans un endroit s√ªr avant de continuer.</p>
                    </div>
                    
                    <div class="final-confirmation-warning">
                        <div class="warning-icon">‚ö†Ô∏è</div>
                        <div class="warning-content">
                            <h4>Rappel important :</h4>
                            <ul>
                                <li>Vos mots sont-ils √©crits dans un endroit s√ªr ?</li>
                                <li>Avez-vous fait une copie de sauvegarde ?</li>
                                <li>√ätes-vous s√ªr de ne jamais les perdre ?</li>
                            </ul>
                        </div>
                    </div>

                    <div class="final-confirmation-actions">
                        <button class="final-confirmation-btn secondary" onclick="goBackToVerification()">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M19 12H5M12 19l-7-7 7-7"/>
                            </svg>
                            Retour √† la v√©rification
                        </button>
                        <button class="final-confirmation-btn primary" onclick="validateBackupPhrase()">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M5 13l4 4L19 7"/>
                            </svg>
                            Valider d√©finitivement
                        </button>
                    </div>
                </div>
            </div>
            </div>
        </div>
    </div>

    <script>
        // Variables globales pour la backup phrase
        let backupWords = [];
        let verificationWords = [];
        let currentVerificationStep = 0;
        let verificationOrder = [];
        
        // Variable pour indiquer si les mots ont √©t√© confirm√©s (d√©finitifs)
        window.backupWordsConfirmed = false;

        // Liste de mots BIP39 fran√ßais (simplifi√©e pour l'exemple)
        const bip39Words = [
            'abandon', 'abilite', 'able', 'about', 'above', 'absent', 'absorber', 'absurde',
            'abus', 'academie', 'accepter', 'acces', 'accident', 'accompagner', 'accord',
            'accuser', 'acheter', 'acier', 'acte', 'action', 'adapter', 'adresse', 'adroit',
            'adulte', 'affaire', 'affirmer', 'afin', 'agir', 'agiter', 'agreable', 'aider',
            'aimer', 'ajouter', 'alcool', 'alerte', 'aliment', 'allee', 'allumer', 'amener',
            'amour', 'ancien', 'angle', 'animal', 'annee', 'annoncer', 'appeler', 'apporter',
            'apprendre', 'approcher', 'arbre', 'argent', 'arme', 'arracher', 'arriver',
            'article', 'asile', 'assurer', 'attendre', 'attraper', 'auberge', 'aujourd',
            'aupres', 'aussi', 'autant', 'auteur', 'autre', 'avancer', 'avantage', 'avenir',
            'avion', 'avoir', 'avouer', 'bague', 'bain', 'baiser', 'balancer', 'balle',
            'barbe', 'barque', 'barre', 'barriere', 'bateau', 'battre', 'beau', 'beaucoup',
            'belle', 'bene', 'bercer', 'besoin', 'bete', 'bien', 'bien', 'bien', 'bien',
            'bien', 'bien', 'bien', 'bien', 'bien', 'bien', 'bien', 'bien', 'bien', 'bien'
        ];

        // Fonction pour ouvrir la page backup phrase
        function openBackupPhrasePage() {
            console.log('üöÄ Fonction openBackupPhrasePage appel√©e');
            
            try {
                // V√©rifier s'il y a des mots confirm√©s dans localStorage
                const savedWords = localStorage.getItem('userBackupWords');
                const isConfirmed = localStorage.getItem('backupWordsConfirmed') === 'true';
                
                if (savedWords && isConfirmed) {
                    backupWords = JSON.parse(savedWords);
                    window.backupWordsConfirmed = true;
                    console.log('‚úÖ Mots confirm√©s charg√©s depuis localStorage:', backupWords);
                } else if (window.backupWordsConfirmed && backupWords.length > 0) {
                    console.log('‚úÖ Utilisation des mots d√©j√† confirm√©s en m√©moire');
                } else {
                    // G√©n√©rer 12 mots al√©atoires
                    backupWords = generateBackupWords();
                    window.backupWordsConfirmed = false;
                    console.log('‚úÖ Nouveaux mots g√©n√©r√©s:', backupWords);
                }
                
                // Afficher la page
                const backupPage = document.getElementById('backupPhrasePage');
                if (backupPage) {
                    backupPage.style.display = 'block';
                    console.log('‚úÖ Page backup affich√©e');
                } else {
                    console.error('‚ùå √âl√©ment backupPhrasePage non trouv√©');
                }
                
                // Afficher l'√©tape 1
                showBackupStep(1);
                
                // Remplir la grille des mots
                displayBackupWords();
                
                console.log('‚úÖ Page backup phrase ouverte avec succ√®s');
            } catch (error) {
                console.error('‚ùå Erreur lors de l\'ouverture de la page backup:', error);
                showNotification('Erreur lors de l\'ouverture de la page backup phrase', 'error');
            }
        }
        
        // Attacher les fonctions √† l'objet window pour les rendre globales
        window.openBackupPhrasePage = openBackupPhrasePage;
        window.closeBackupPhrasePage = closeBackupPhrasePage;
        window.generateBackupWords = generateBackupWords;
        window.displayBackupWords = displayBackupWords;
        window.showBackupStep = showBackupStep;
        window.startVerification = startVerification;
        window.initializeVerificationSections = initializeVerificationSections;
        window.generateSectionOptions = generateSectionOptions;
        window.selectSectionOption = selectSectionOption;
        window.checkAllSectionsCompleted = checkAllSectionsCompleted;
        window.goToFinalConfirmation = goToFinalConfirmation;
        window.goBackToVerification = goBackToVerification;
        window.validateBackupPhrase = validateBackupPhrase;
        window.restartVerification = restartVerification;
        window.returnToSettings = returnToSettings;
        window.testNextButton = testNextButton;
        window.showContactSupport = showContactSupport;
        
        // Event listener suppl√©mentaire pour s'assurer que le bouton fonctionne
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üîß Initialisation des fonctions backup phrase...');
            
            // Ajouter un event listener direct sur le bouton backup phrase
            const backupPhraseButton = document.querySelector('.security-option-title');
            if (backupPhraseButton && backupPhraseButton.textContent.includes('Backup phrase')) {
                const parentOption = backupPhraseButton.closest('.security-option');
                if (parentOption) {
                    console.log('üîß Ajout event listener direct sur backup phrase');
                    parentOption.addEventListener('click', function(e) {
                        console.log('üñ±Ô∏è Clic direct sur backup phrase d√©tect√©');
                        e.preventDefault();
                        e.stopPropagation();
                        openBackupPhrasePage();
                    });
                }
            }
            
            // Ajouter un event listener pour le bouton Suivant de v√©rification
            setTimeout(() => {
                const nextBtn = document.getElementById('nextVerificationBtn');
                if (nextBtn) {
                    console.log('üîß Ajout event listener sur bouton Suivant');
                    
                    // Supprimer les event listeners existants pour √©viter les doublons
                    nextBtn.removeEventListener('click', handleNextButtonClick);
                    
                    // Ajouter le nouvel event listener
                    nextBtn.addEventListener('click', handleNextButtonClick);
                    
                    // S'assurer que le bouton est cliquable
                    nextBtn.style.cursor = 'pointer';
                    nextBtn.style.pointerEvents = 'auto';
                    
                    console.log('‚úÖ Event listener ajout√© avec succ√®s');
                } else {
                    console.warn('‚ö†Ô∏è Bouton Suivant non trouv√© pour l\'event listener - r√©essai dans 2 secondes');
                    
                    // R√©essayer apr√®s 2 secondes
                    setTimeout(() => {
                        const retryNextBtn = document.getElementById('nextVerificationBtn');
                        if (retryNextBtn) {
                            console.log('‚úÖ Bouton Suivant trouv√© lors du r√©essai');
                            
                            // Supprimer les event listeners existants pour √©viter les doublons
                            retryNextBtn.removeEventListener('click', handleNextButtonClick);
                            
                            // Ajouter le nouvel event listener
                            retryNextBtn.addEventListener('click', handleNextButtonClick);
                            
                            // S'assurer que le bouton est cliquable
                            retryNextBtn.style.cursor = 'pointer';
                            retryNextBtn.style.pointerEvents = 'auto';
                            
                            console.log('‚úÖ Event listener ajout√© avec succ√®s lors du r√©essai');
                        } else {
                            console.warn('‚ö†Ô∏è Bouton Suivant toujours non trouv√© apr√®s r√©essai');
                        }
                    }, 2000);
                }
            }, 1000);
            
            // Fonction pour g√©rer le clic sur le bouton Suivant
            function handleNextButtonClick(e) {
                console.log('üñ±Ô∏è Clic sur bouton Suivant d√©tect√©');
                e.preventDefault();
                e.stopPropagation();
                nextVerificationStep();
            }
            
            console.log('‚úÖ Fonctions backup phrase initialis√©es');
            
            // Test des fonctions
            setTimeout(() => {
                testBackupPhraseFunctions();
                
                // Test des √©l√©ments HTML
                console.log('üß™ Test des √©l√©ments HTML...');
                const elements = [
                    'backupStep1', 'backupStep2', 'backupStep3',
                    'currentWordNumber', 'wordToVerify', 'verificationProgress',
                    'verificationProgressText', 'wordOptionsGrid', 'nextVerificationBtn'
                ];
                
                elements.forEach(id => {
                    const element = document.getElementById(id);
                    if (element) {
                        console.log(`‚úÖ √âl√©ment ${id} trouv√©`);
                    } else {
                        console.warn(`‚ö†Ô∏è √âl√©ment ${id} non trouv√© - peut √™tre charg√© plus tard`);
                    }
                });
            }, 2000);
        });

        // Fonction pour fermer la page backup phrase et revenir aux param√®tres
        function closeBackupPhrasePage() {
            document.getElementById('backupPhrasePage').style.display = 'none';
            
            // R√©initialiser les variables de v√©rification (mais pas les mots confirm√©s)
            verificationWords = [];
            currentVerificationStep = 0;
            verificationOrder = [];
            
            // Masquer toutes les √©tapes
            document.getElementById('backupStep1').style.display = 'none';
            document.getElementById('backupStep2').style.display = 'none';
            document.getElementById('backupStep3').style.display = 'none';
            
            // Si les mots sont confirm√©s, les sauvegarder dans localStorage
            if (window.backupWordsConfirmed && backupWords.length > 0) {
                try {
                    localStorage.setItem('userBackupWords', JSON.stringify(backupWords));
                    localStorage.setItem('backupWordsConfirmed', 'true');
                    console.log('üíæ Mots de backup sauvegard√©s dans localStorage');
                } catch (error) {
                    console.warn('‚ö†Ô∏è Erreur lors de la sauvegarde des mots:', error);
                    
                    // R√©essayer apr√®s 1 seconde
                    setTimeout(() => {
                        try {
                            localStorage.setItem('userBackupWords', JSON.stringify(backupWords));
                            localStorage.setItem('backupWordsConfirmed', 'true');
                            console.log('‚úÖ Sauvegarde r√©ussie lors du r√©essai');
                        } catch (retryError) {
                            console.warn('‚ö†Ô∏è √âchec du r√©essai de sauvegarde:', retryError);
                        }
                    }, 1000);
                }
            }
            
            // S'assurer que la modal des param√®tres est visible
            const settingsModal = document.getElementById('settingsModal');
            if (settingsModal) {
                settingsModal.classList.add('active');
            }
            
            console.log('‚úÖ Retour aux param√®tres');
        }

        // G√©n√©rer 12 mots al√©atoires
        function generateBackupWords() {
            const words = [];
            for (let i = 0; i < 12; i++) {
                const randomIndex = Math.floor(Math.random() * bip39Words.length);
                words.push(bip39Words[randomIndex]);
            }
            return words;
        }

        // Afficher les mots dans la grille
        function displayBackupWords() {
            const grid = document.getElementById('backupWordsGrid');
            grid.innerHTML = '';
            
            backupWords.forEach((word, index) => {
                const wordElement = document.createElement('div');
                wordElement.className = 'backup-word';
                wordElement.innerHTML = `
                    <div class="word-number">${index + 1}</div>
                    ${word}
                `;
                grid.appendChild(wordElement);
            });
        }

        // Afficher une √©tape sp√©cifique
        function showBackupStep(step) {
            // Masquer toutes les √©tapes
            document.getElementById('backupStep1').style.display = 'none';
            document.getElementById('backupStep2').style.display = 'none';
            document.getElementById('backupStep3').style.display = 'none';
            
            // Afficher l'√©tape demand√©e
            document.getElementById(`backupStep${step}`).style.display = 'block';
        }

        // Commencer la v√©rification avec 3 sections
        function startVerification() {
            console.log('üöÄ D√©but de la v√©rification avec 3 sections');
            console.log('üîç Mots de backup disponibles:', backupWords);
            
            // G√©n√©rer l'ordre de v√©rification (3 mots sur 12)
            verificationOrder = [];
            const allIndices = Array.from({length: 12}, (_, i) => i);
            
            for (let i = 0; i < 3; i++) {
                const randomIndex = Math.floor(Math.random() * allIndices.length);
                verificationOrder.push(allIndices[randomIndex]);
                allIndices.splice(randomIndex, 1);
            }
            
            console.log('üîç Ordre de v√©rification g√©n√©r√©:', verificationOrder);
            
            // Initialiser les variables
            verificationWords = [];
            
            console.log('üîÑ Affichage de l\'√©tape 2 (v√©rification)');
            showBackupStep(2);
            
            // Initialiser les 3 sections
            initializeVerificationSections();
        }

        // Initialiser les 3 sections de v√©rification
        function initializeVerificationSections() {
            console.log('üîÑ Initialisation des 3 sections de v√©rification');
            
            // Initialiser chaque section
            for (let i = 0; i < 3; i++) {
                const sectionIndex = i + 1;
                const wordIndex = verificationOrder[i];
                const correctWord = backupWords[wordIndex];
                
                console.log(`üîç Section ${sectionIndex}: Mot √† la position ${wordIndex + 1} = ${correctWord}`);
                
                // Mettre √† jour la position affich√©e
                const positionElement = document.getElementById(`position${sectionIndex}`);
                if (positionElement) {
                    positionElement.textContent = wordIndex + 1;
                }
                
                // G√©n√©rer les options pour cette section
                generateSectionOptions(sectionIndex, correctWord);
                
                // R√©initialiser le statut
                const statusElement = document.getElementById(`status${sectionIndex}`);
                if (statusElement) {
                    statusElement.textContent = 'En attente de s√©lection';
                    statusElement.className = 'section-status pending';
                }
                
                // R√©initialiser la section
                const sectionElement = document.getElementById(`section${sectionIndex}`);
                if (sectionElement) {
                    sectionElement.classList.remove('completed');
                }
            }
            
            // D√©sactiver le bouton Suivant
            const nextBtn = document.getElementById('nextVerificationBtn');
            if (nextBtn) {
                nextBtn.disabled = true;
                nextBtn.style.cursor = 'not-allowed';
                nextBtn.style.pointerEvents = 'none';
                nextBtn.style.opacity = '0.5';
            }
            
            console.log('‚úÖ Sections initialis√©es');
        }

        // G√©n√©rer les options pour une section
        function generateSectionOptions(sectionIndex, correctWord) {
            console.log(`üîÑ G√©n√©ration des options pour la section ${sectionIndex}:`, correctWord);
            
            const grid = document.getElementById(`optionsGrid${sectionIndex}`);
            if (!grid) {
                console.error(`‚ùå Grille des options ${sectionIndex} non trouv√©e`);
                return;
            }
            
            grid.innerHTML = '';
            
            // Cr√©er un tableau avec le mot correct et 2 mots incorrects
            const options = [correctWord];
            
            // Ajouter 2 mots al√©atoires diff√©rents
            while (options.length < 3) {
                const randomWord = bip39Words[Math.floor(Math.random() * bip39Words.length)];
                if (!options.includes(randomWord) && !backupWords.includes(randomWord)) {
                    options.push(randomWord);
                }
            }
            
            // M√©langer les options
            for (let i = options.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [options[i], options[j]] = [options[j], options[i]];
            }
            
            console.log(`‚úÖ Options g√©n√©r√©es pour la section ${sectionIndex}:`, options);
            
            // Cr√©er les √©l√©ments d'option
            options.forEach(option => {
                const optionElement = document.createElement('div');
                optionElement.className = 'word-option';
                optionElement.textContent = option;
                optionElement.onclick = () => selectSectionOption(sectionIndex, option, correctWord, optionElement);
                grid.appendChild(optionElement);
            });
        }

        // S√©lectionner une option dans une section
        function selectSectionOption(sectionIndex, selectedWord, correctWord, element) {
            console.log(`üñ±Ô∏è Option s√©lectionn√©e dans la section ${sectionIndex}:`, selectedWord);
            console.log('‚úÖ Mot correct attendu:', correctWord);
            
            // D√©s√©lectionner toutes les options de cette section
            const grid = document.getElementById(`optionsGrid${sectionIndex}`);
            if (grid) {
                grid.querySelectorAll('.word-option').forEach(opt => {
                    opt.classList.remove('selected', 'correct', 'incorrect');
                });
            }
            
            // V√©rifier si le mot s√©lectionn√© est correct
            const isCorrect = selectedWord === correctWord;
            
            if (isCorrect) {
                // Mot correct - afficher en vert
                element.classList.add('correct');
                console.log(`‚úÖ Mot correct s√©lectionn√© dans la section ${sectionIndex}`);
                
                // Stocker la s√©lection
                verificationWords[sectionIndex - 1] = selectedWord;
                
                // Mettre √† jour le statut de la section
                const statusElement = document.getElementById(`status${sectionIndex}`);
                if (statusElement) {
                    statusElement.textContent = '‚úÖ Mot correct s√©lectionn√©';
                    statusElement.className = 'section-status correct';
                }
                
                // Marquer la section comme compl√©t√©e
                const sectionElement = document.getElementById(`section${sectionIndex}`);
                if (sectionElement) {
                    sectionElement.classList.add('completed');
                }
                
                // V√©rifier si toutes les sections sont compl√©t√©es
                checkAllSectionsCompleted();
                
            } else {
                // Mot incorrect - afficher en rouge
                element.classList.add('incorrect');
                console.log(`‚ùå Mot incorrect s√©lectionn√© dans la section ${sectionIndex}`);
                
                // Afficher le mot correct en vert
                if (grid) {
                    grid.querySelectorAll('.word-option').forEach(opt => {
                        if (opt.textContent === correctWord) {
                            opt.classList.add('correct');
                        }
                    });
                }
                
                // Mettre √† jour le statut de la section
                const statusElement = document.getElementById(`status${sectionIndex}`);
                if (statusElement) {
                    statusElement.textContent = '‚ùå Mot incorrect - r√©essayez';
                    statusElement.className = 'section-status incorrect';
                }
                
                // Attendre 2 secondes puis r√©initialiser la section
                setTimeout(() => {
                    showNotification('Mot incorrect. Veuillez r√©essayer.', 'error');
                    const wordIndex = verificationOrder[sectionIndex - 1];
                    const correctWord = backupWords[wordIndex];
                    generateSectionOptions(sectionIndex, correctWord);
                    
                    if (statusElement) {
                        statusElement.textContent = 'En attente de s√©lection';
                        statusElement.className = 'section-status pending';
                    }
                }, 2000);
            }
        }

        // V√©rifier si toutes les sections sont compl√©t√©es
        function checkAllSectionsCompleted() {
            const allCompleted = verificationWords.length === 3 && verificationWords.every(word => word !== undefined);
            
            if (allCompleted) {
                console.log('‚úÖ Toutes les sections sont compl√©t√©es');
                
                // Activer le bouton Suivant
                const nextBtn = document.getElementById('nextVerificationBtn');
                if (nextBtn) {
                    nextBtn.disabled = false;
                    nextBtn.style.cursor = 'pointer';
                    nextBtn.style.pointerEvents = 'auto';
                    nextBtn.style.opacity = '1';
                    console.log('‚úÖ Bouton Suivant activ√©');
                }
            }
        }

        // Aller √† la confirmation finale
        function goToFinalConfirmation() {
            console.log('üîÑ Passage √† la confirmation finale');
            showBackupStep(3);
        }

        // Retourner √† la v√©rification
        function goBackToVerification() {
            console.log('üîÑ Retour √† la v√©rification');
            showBackupStep(2);
        }

        // Valider d√©finitivement la phrase de backup
        function validateBackupPhrase() {
            console.log('‚úÖ Validation d√©finitive de la phrase de backup');
            
            // Marquer les mots comme d√©finitifs
            window.backupWordsConfirmed = true;
            
            // Sauvegarder dans localStorage
            try {
                localStorage.setItem('userBackupWords', JSON.stringify(backupWords));
                localStorage.setItem('backupWordsConfirmed', 'true');
                console.log('üíæ Mots de backup sauvegard√©s d√©finitivement');
            } catch (error) {
                console.error('‚ùå Erreur lors de la sauvegarde:', error);
            }
            
            // Afficher une notification de succ√®s
            showNotification('Phrase de r√©cup√©ration valid√©e d√©finitivement !', 'success');
            
            // Retourner aux param√®tres
            setTimeout(() => {
                closeBackupPhrasePage();
            }, 1500);
        }

        // Afficher l'√©tape de v√©rification actuelle
        function showVerificationStep() {
            console.log('üîÑ Affichage de l\'√©tape de v√©rification');
            console.log('üîç √âtat:', {
                currentStep: currentVerificationStep,
                totalSteps: verificationOrder.length,
                verificationOrder: verificationOrder,
                backupWords: backupWords
            });
            
            if (currentVerificationStep >= verificationOrder.length) {
                console.log('‚úÖ Toutes les √©tapes termin√©es - v√©rification finale');
                // V√©rification termin√©e - v√©rifier si tous les mots sont corrects
                const allCorrect = verificationWords.every((word, index) => {
                    const correctWord = backupWords[verificationOrder[index]];
                    return word === correctWord;
                });
                
                if (allCorrect) {
                    console.log('‚úÖ V√©rification r√©ussie - tous les mots sont corrects');
                    // Marquer les mots comme d√©finitifs
                    window.backupWordsConfirmed = true;
                    showBackupStep(3);
                } else {
                    console.log('‚ùå V√©rification √©chou√©e - certains mots sont incorrects');
                    showNotification('V√©rification √©chou√©e. Veuillez recommencer.', 'error');
                    restartVerification();
                }
                return;
            }
            
            const wordIndex = verificationOrder[currentVerificationStep];
            const wordToVerify = backupWords[wordIndex];
            
            console.log(`üîç √âtape ${currentVerificationStep + 1}: V√©rification du mot #${wordIndex + 1} (${wordToVerify})`);
            
            // V√©rifier que les √©l√©ments existent
            const currentWordNumberEl = document.getElementById('currentWordNumber');
            const wordToVerifyEl = document.getElementById('wordToVerify');
            const verificationProgressEl = document.getElementById('verificationProgress');
            const verificationProgressTextEl = document.getElementById('verificationProgressText');
            
            if (!currentWordNumberEl || !wordToVerifyEl || !verificationProgressEl || !verificationProgressTextEl) {
                console.error('‚ùå √âl√©ments de v√©rification non trouv√©s');
                return;
            }
            
            // Mettre √† jour l'interface
            currentWordNumberEl.textContent = wordIndex + 1;
            wordToVerifyEl.textContent = `S√©lectionnez le mot #${wordIndex + 1}`;
            
            // Mettre √† jour la progression
            const progress = ((currentVerificationStep + 1) / verificationOrder.length) * 100;
            verificationProgressEl.style.width = `${progress}%`;
            verificationProgressTextEl.textContent = `√âtape ${currentVerificationStep + 1} sur ${verificationOrder.length}`;
            
            console.log('‚úÖ Interface mise √† jour');
            
            // G√©n√©rer les options
            generateWordOptions(wordToVerify);
            
            // D√©sactiver le bouton suivant
            const nextBtn = document.getElementById('nextVerificationBtn');
            if (nextBtn) {
                nextBtn.disabled = true;
                nextBtn.style.cursor = 'not-allowed';
                nextBtn.style.pointerEvents = 'none';
                nextBtn.style.opacity = '0.5';
                console.log('‚úÖ Bouton Suivant d√©sactiv√©');
            } else {
                console.error('‚ùå Bouton Suivant non trouv√©');
            }
        }

        // G√©n√©rer les options de mots pour la v√©rification
        function generateWordOptions(correctWord) {
            console.log('üîÑ G√©n√©ration des options pour le mot:', correctWord);
            
            const grid = document.getElementById('wordOptionsGrid');
            if (!grid) {
                console.error('‚ùå Grille des options non trouv√©e');
                return;
            }
            
            grid.innerHTML = '';
            
            // Cr√©er un tableau avec le mot correct et 2 mots incorrects
            const options = [correctWord];
            
            // Ajouter 2 mots al√©atoires diff√©rents
            while (options.length < 3) {
                const randomWord = bip39Words[Math.floor(Math.random() * bip39Words.length)];
                if (!options.includes(randomWord) && !backupWords.includes(randomWord)) {
                    options.push(randomWord);
                }
            }
            
            // M√©langer les options
            for (let i = options.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [options[i], options[j]] = [options[j], options[i]];
            }
            
            console.log('‚úÖ Options g√©n√©r√©es:', options);
            
            // Cr√©er les √©l√©ments d'option
            options.forEach(option => {
                const optionElement = document.createElement('div');
                optionElement.className = 'word-option';
                optionElement.textContent = option;
                optionElement.onclick = () => selectWordOption(option, correctWord, optionElement);
                grid.appendChild(optionElement);
            });
            
            console.log('‚úÖ Options affich√©es dans la grille');
        }

        // S√©lectionner une option de mot
        function selectWordOption(selectedWord, correctWord, element) {
            console.log('üñ±Ô∏è Option s√©lectionn√©e:', selectedWord);
            console.log('‚úÖ Mot correct attendu:', correctWord);
            
            // D√©s√©lectionner toutes les options et retirer les classes de feedback
            document.querySelectorAll('.word-option').forEach(opt => {
                opt.classList.remove('selected', 'correct', 'incorrect');
            });
            
            // V√©rifier si le mot s√©lectionn√© est correct
            const isCorrect = selectedWord === correctWord;
            
            if (isCorrect) {
                // Mot correct - afficher en vert
                element.classList.add('correct');
                console.log('‚úÖ Mot correct s√©lectionn√©');
                
                // Stocker la s√©lection
                verificationWords[currentVerificationStep] = selectedWord;
                
                // Activer le bouton suivant
                const nextBtn = document.getElementById('nextVerificationBtn');
                if (nextBtn) {
                    nextBtn.disabled = false;
                    nextBtn.style.cursor = 'pointer';
                    nextBtn.style.pointerEvents = 'auto';
                    nextBtn.style.opacity = '1';
                    console.log('‚úÖ Bouton Suivant activ√© et cliquable');
                } else {
                    console.error('‚ùå Bouton Suivant non trouv√©');
                }
                
            } else {
                // Mot incorrect - afficher en rouge
                element.classList.add('incorrect');
                console.log('‚ùå Mot incorrect s√©lectionn√©');
                
                // Afficher le mot correct en vert
                document.querySelectorAll('.word-option').forEach(opt => {
                    if (opt.textContent === correctWord) {
                        opt.classList.add('correct');
                    }
                });
                
                // Attendre 2 secondes puis recommencer l'√©tape
                setTimeout(() => {
                    showNotification('Mot incorrect. Veuillez r√©essayer.', 'error');
                    showVerificationStep();
                }, 2000);
            }
        }



        // Passer √† l'√©tape suivante de v√©rification
        function nextVerificationStep() {
            console.log('üñ±Ô∏è Bouton Suivant cliqu√©');
            console.log('üîç √âtat actuel:', {
                currentStep: currentVerificationStep,
                totalSteps: verificationOrder.length,
                selectedWords: verificationWords
            });
            
            // V√©rifier que l'utilisateur a s√©lectionn√© un mot pour cette √©tape
            if (!verificationWords[currentVerificationStep]) {
                console.log('‚ùå Aucun mot s√©lectionn√© pour cette √©tape');
                showNotification('Veuillez s√©lectionner un mot avant de continuer.', 'warning');
                return;
            }
            
            console.log(`‚úÖ Mot ${currentVerificationStep + 1} s√©lectionn√©: ${verificationWords[currentVerificationStep]}`);
            
            // Passer √† l'√©tape suivante
            currentVerificationStep++;
            
            // V√©rifier si toutes les √©tapes sont termin√©es
            if (currentVerificationStep >= verificationOrder.length) {
                console.log('‚úÖ Toutes les √©tapes sont termin√©es - v√©rification finale');
                
                // V√©rifier que tous les mots s√©lectionn√©s sont corrects
                const allCorrect = verificationWords.every((word, index) => {
                    const correctWord = backupWords[verificationOrder[index]];
                    return word === correctWord;
                });
                
                if (allCorrect) {
                    console.log('‚úÖ V√©rification r√©ussie - tous les mots sont corrects');
                    // Marquer les mots comme d√©finitifs
                    window.backupWordsConfirmed = true;
                    showBackupStep(3);
                } else {
                    console.log('‚ùå V√©rification √©chou√©e - certains mots sont incorrects');
                    showNotification('V√©rification √©chou√©e. Veuillez recommencer.', 'error');
                    restartVerification();
                }
            } else {
                console.log(`üîÑ Affichage de l'√©tape ${currentVerificationStep + 1}`);
                showVerificationStep();
            }
        }

        // Recommencer la v√©rification
        function restartVerification() {
            console.log('üîÑ Recommencer la v√©rification');
            verificationWords = [];
            initializeVerificationSections();
        }

        // Retourner aux param√®tres
        function returnToSettings() {
            console.log('üîÑ Retour aux param√®tres');
            
            // Fermer la page backup phrase
            closeBackupPhrasePage();
            
            // Afficher une notification de succ√®s
            showNotification('Phrase de r√©cup√©ration sauvegard√©e avec succ√®s !', 'success');
        }

        // Fonction de test pour le bouton Suivant
        function testNextButton() {
            console.log('üß™ Test du bouton Suivant...');
            const nextBtn = document.getElementById('nextVerificationBtn');
            if (nextBtn) {
                console.log('‚úÖ Bouton trouv√©');
                console.log('√âtat disabled:', nextBtn.disabled);
                console.log('Style cursor:', nextBtn.style.cursor);
                console.log('Style pointerEvents:', nextBtn.style.pointerEvents);
                console.log('Style opacity:', nextBtn.style.opacity);
                
                // Test de clic
                nextBtn.click();
            } else {
                console.error('‚ùå Bouton non trouv√©');
            }
        }

        // Fonction pour afficher la page de contact support
        function showContactSupport() {
            const contactSupportPage = document.getElementById('contactSupportPage');
            if (contactSupportPage) {
                contactSupportPage.style.display = 'block';
                console.log('üìß Page de contact support ouverte');
            }
        }

        // Fonction pour fermer la page de contact support
        function closeContactSupportPage() {
            const contactSupportPage = document.getElementById('contactSupportPage');
            if (contactSupportPage) {
                contactSupportPage.style.display = 'none';
                console.log('üìß Page de contact support ferm√©e');
            }
        }

        // Fonction pour copier l'email de support
        function copySupportEmail() {
            const supportEmail = 'support@lloydbanq.pro';
            
            navigator.clipboard.writeText(supportEmail).then(() => {
                showNotification('Email copi√© dans le presse-papiers !', 'success');
            }).catch(() => {
                // Fallback si clipboard n'est pas disponible
                console.log('Clipboard non disponible');
                showNotification('Impossible de copier l\'email automatiquement', 'error');
            });
        }

        // Fonction pour envoyer un email de support
        function sendSupportEmail() {
            const supportEmail = 'support@lloydbanq.pro';
            const subject = 'Support Lloyd\'s GO! - Demande d\'assistance';
            const body = 'Bonjour,\n\nJ\'ai besoin d\'assistance concernant mon compte Lloyd\'s GO!.\n\nMerci de votre aide.\n\nCordialement,';
            
            const mailtoLink = `mailto:${supportEmail}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
            
            window.open(mailtoLink, '_blank');
            
            showNotification('Application email ouverte !', 'success');
        }

        // Fonction pour afficher la page About Us
        function showAboutUsPage() {
            // Ouvrir directement le lien externe dans un nouvel onglet
            window.open('https://www.lloydsbank.com/about-us.html', '_blank');
            console.log('‚ÑπÔ∏è Lien About Us ouvert dans le navigateur');
        }

        // Fonction pour fermer la page About Us
        function closeAboutUsPage() {
            const aboutUsPage = document.getElementById('aboutUsPage');
            if (aboutUsPage) {
                aboutUsPage.style.display = 'none';
                console.log('‚ÑπÔ∏è Page About Us ferm√©e');
            }
        }
        
        // Fonction de test pour v√©rifier que tout fonctionne
        function testBackupPhraseFunctions() {
            console.log('üß™ Test des fonctions backup phrase...');
            console.log('‚úÖ openBackupPhrasePage:', typeof openBackupPhrasePage);
            console.log('‚úÖ selectWordOption:', typeof selectWordOption);
            console.log('‚úÖ nextVerificationStep:', typeof nextVerificationStep);
            console.log('‚úÖ restartVerification:', typeof restartVerification);
            console.log('‚úÖ returnToSettings:', typeof returnToSettings);
            console.log('‚úÖ Variables:', {
                backupWords: backupWords.length,
                verificationWords: verificationWords.length,
                currentVerificationStep,
                verificationOrder: verificationOrder.length
            });
        }
    </script>
    
    <!-- NOUVEAU SYST√àME DE GESTION DES SOLDES - TOUS √Ä Z√âRO -->
    <script>
        // NOUVEAU SYST√àME DE GESTION DES SOLDES - TOUS √Ä Z√âRO
        class ZeroBalanceManager {
            constructor() {
                this.initializeZeroBalances();
                console.log('üîÑ Syst√®me ZeroBalanceManager initialis√© - Tous les soldes √† z√©ro');
            }
            
            // Initialiser tous les soldes √† z√©ro
            initializeZeroBalances() {
                const currentUser = sessionStorage.getItem('currentUser');
                if (!currentUser) return;
                
                // Structure de donn√©es pour tous les soldes √† z√©ro
                const zeroBalances = {
                    user: currentUser,
                    timestamp: Date.now(),
                    balances: {
                        // Solde principal (page d'accueil)
                        mainBalance: 0.00,
                        
                        // Solde portefeuille crypto
                        portfolioBalance: 0.00,
                        
                        // Solde bancaire
                        bankingBalance: 0.00,
                        
                        // Solde staking
                        stakingBalance: 0.00,
                        
                        // Soldes individuels des cryptomonnaies
                        cryptoBalances: {
                            bitcoin: 0.000,
                            ethereum: 0.000,
                            solana: 0.000,
                            binancecoin: 0.000,
                            ripple: 0.000,
                            dogecoin: 0.000,
                            cardano: 0.000,
                            'shiba-inu': 0.000,
                            polkadot: 0.000,
                            'matic-network': 0.000,
                            'avalanche-2': 0.000
                        },
                        
                        // Valeurs en euros des cryptomonnaies
                        cryptoValues: {
                            bitcoin: 0.00,
                            ethereum: 0.00,
                            solana: 0.00,
                            binancecoin: 0.00,
                            ripple: 0.00,
                            dogecoin: 0.00,
                            cardano: 0.00,
                            'shiba-inu': 0.00,
                            polkadot: 0.00,
                            'matic-network': 0.00,
                            'avalanche-2': 0.00
                        },
                        
                        // Statistiques
                        stats: {
                            transactions: 0,
                            totalRewards: 0.00,
                            apyAverage: 0.0
                        }
                    }
                };
                
                // Sauvegarder dans sessionStorage
                sessionStorage.setItem('zeroBalances', JSON.stringify(zeroBalances));
                
                // Appliquer imm√©diatement
                this.applyZeroBalances();
            }
            
            // Appliquer tous les soldes √† z√©ro
            applyZeroBalances() {
                // Solde principal (page d'accueil)
                const mainBalanceElement = document.getElementById('mainBalanceAmount');
                if (mainBalanceElement) {
                    mainBalanceElement.textContent = '‚Ç¨0.00';
                }
                
                // Solde portefeuille crypto
                const portfolioBalanceElement = document.getElementById('balanceAmount');
                if (portfolioBalanceElement) {
                    portfolioBalanceElement.textContent = '‚Ç¨0.00';
                }
                
                // Solde bancaire
                const bankingBalanceElements = document.querySelectorAll('.account-balance .balance-amount');
                bankingBalanceElements.forEach(element => {
                    element.textContent = '‚Ç¨0.00';
                });
                
                // Solde staking
                const stakingBalanceElements = document.querySelectorAll('.staking-balance .balance-main');
                stakingBalanceElements.forEach(element => {
                    element.textContent = '‚Ç¨0.00';
                });
                
                // Soldes individuels des cryptomonnaies
                const cryptoAmountElements = document.querySelectorAll('.crypto-amount');
                cryptoAmountElements.forEach(element => {
                    const cryptoName = element.textContent.split(' ')[1]; // BTC, ETH, etc.
                    if (cryptoName) {
                        element.textContent = `0.000 ${cryptoName}`;
                    }
                });
                
                // Valeurs en euros des cryptomonnaies
                const cryptoValueElements = document.querySelectorAll('.value-amount');
                cryptoValueElements.forEach(element => {
                    element.textContent = '‚Ç¨0.00';
                });
                
                // Statistiques
                const transactionElements = document.querySelectorAll('.stat-value');
                transactionElements.forEach(element => {
                    if (element.textContent.match(/^\d+$/)) { // Si c'est un nombre
                        element.textContent = '0';
                    }
                });
                
                // APY moyen
                const apyElements = document.querySelectorAll('.balance-apy');
                apyElements.forEach(element => {
                    element.textContent = 'APY moyen: 0.0%';
                });
                
                console.log('‚úÖ Tous les soldes appliqu√©s √† z√©ro');
            }
            
            // Obtenir un solde sp√©cifique
            getBalance(type, cryptoId = null) {
                const zeroBalances = JSON.parse(sessionStorage.getItem('zeroBalances') || '{}');
                
                if (cryptoId) {
                    return zeroBalances.balances?.cryptoBalances?.[cryptoId] || 0;
                }
                
                return zeroBalances.balances?.[type] || 0;
            }
            
            // Mettre √† jour un solde (pour les futures transactions)
            updateBalance(type, value, cryptoId = null) {
                const zeroBalances = JSON.parse(sessionStorage.getItem('zeroBalances') || '{}');
                
                if (cryptoId) {
                    if (!zeroBalances.balances) zeroBalances.balances = {};
                    if (!zeroBalances.balances.cryptoBalances) zeroBalances.balances.cryptoBalances = {};
                    zeroBalances.balances.cryptoBalances[cryptoId] = value;
                } else {
                    if (!zeroBalances.balances) zeroBalances.balances = {};
                    zeroBalances.balances[type] = value;
                }
                
                sessionStorage.setItem('zeroBalances', JSON.stringify(zeroBalances));
                this.applyZeroBalances();
            }
            
            // R√©initialiser tous les soldes √† z√©ro
            resetAllBalances() {
                this.initializeZeroBalances();
                console.log('üîÑ Tous les soldes r√©initialis√©s √† z√©ro');
            }
        }
        
        // Initialiser le gestionnaire de soldes √† z√©ro
        let zeroBalanceManager;
        
        // Fonction pour initialiser le syst√®me de soldes √† z√©ro
        function initializeZeroBalanceSystem() {
            const currentUser = sessionStorage.getItem('currentUser');
            if (!currentUser) return;
            
            // Cr√©er le gestionnaire de soldes √† z√©ro
            zeroBalanceManager = new ZeroBalanceManager();
            
            // V√©rifier si c'est une nouvelle inscription
            const isNewUser = !sessionStorage.getItem('userInitialized');
            if (isNewUser) {
                console.log('üë§ Nouvel utilisateur d√©tect√© - Initialisation des soldes √† z√©ro');
                sessionStorage.setItem('userInitialized', 'true');
                zeroBalanceManager.resetAllBalances();
            } else {
                console.log('üë§ Utilisateur existant - Application des soldes √† z√©ro');
                zeroBalanceManager.applyZeroBalances();
            }
        }
        
                 // Initialiser le syst√®me au chargement de la page
         document.addEventListener('DOMContentLoaded', function() {
             initializeZeroBalanceSystem();
             
             // Initialiser le graphique apr√®s un d√©lai
             setTimeout(() => {
                 initializeChart();
             }, 2000);
             
             // √âcouter les mises √† jour des prix crypto pour forcer les soldes √† z√©ro
             document.addEventListener('cryptoPricesUpdated', function(event) {
                 console.log('üîÑ Prix crypto mis √† jour - For√ßage des soldes √† z√©ro');
                 
                 // Forcer les soldes √† z√©ro apr√®s chaque mise √† jour des prix
                 setTimeout(() => {
                     if (window.cryptoPriceUpdater && window.cryptoPriceUpdater.forceZeroBalances) {
                         window.cryptoPriceUpdater.forceZeroBalances();
                     }
                     
                     // Forcer aussi via le syst√®me de soldes √† z√©ro
                     if (window.zeroBalanceManager) {
                         window.zeroBalanceManager.applyZeroBalances();
                     }
                 }, 100);
             });
         });
     </script>
     
     <!-- GESTIONNAIRES ET SYST√àMES -->
     <script src="js/userManager.js"></script>
     <script src="js/balanceManager.js"></script>
     <script src="js/balanceAlgorithm.js"></script>
     <script src="js/cryptoPriceUpdater.js"></script>
     <script src="js/apiManager.js"></script>
     <script src="js/cloudSync.js"></script>
    
    <style>
        /* Styles pour les prix en temps r√©el */
        .crypto-price {
            font-size: 14px !important;
            font-weight: 600 !important;
            color: #333 !important;
            margin-top: 2px !important;
            transition: color 0.3s ease;
        }
        
        .crypto-price.updating {
            color: #007bff !important;
            animation: priceUpdate 0.5s ease-in-out;
        }
        
        /* Animation pour l'indicateur temps r√©el */
        .realtime-dot {
            width: 8px;
            height: 8px;
            background-color: #28a745;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        @keyframes priceUpdate {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        /* Styles pour les variations de prix */
        .value-change.positive {
            color: #28a745 !important;
        }
        
        .value-change.negative {
            color: #dc3545 !important;
        }
        
        /* Indicateur de mise √† jour */
        .realtime-indicator {
            display: flex;
            align-items: center;
            font-size: 12px;
            color: #666;
            margin-left: 10px;
        }
        
        .last-update {
            margin-left: 10px;
            font-size: 11px;
            color: #999;
        }
    </style>
    
    <script>
        // Diagnostic du syst√®me crypto apr√®s chargement
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üîç === DIAGNOSTIC SYST√àME CRYPTO ===');
            
            // Attendre que le syst√®me soit initialis√©
            setTimeout(() => {
                if (window.cryptoPriceUpdater) {
                    console.log('‚úÖ cryptoPriceUpdater disponible');
                    console.log('üîÑ Syst√®me en cours:', window.cryptoPriceUpdater.isRunning);
                    console.log('üìä Prix charg√©s:', Object.keys(window.cryptoPriceUpdater.cryptoPrices).length);
                    
                    // Forcer la mise √† jour de tous les prix
                    if (window.diagnoseAndFixPrices) {
                        console.log('üîß Lancement du diagnostic et correction automatique...');
                        window.diagnoseAndFixPrices();
                    } else {
                        console.log('‚ö†Ô∏è Fonction diagnoseAndFixPrices non disponible, utilisation du syst√®me standard');
                        window.cryptoPriceUpdater.forceUpdate();
                    }
                    
                } else {
                    console.log('‚ùå cryptoPriceUpdater non disponible');
                }
            }, 3000);
            
            // Correction automatique apr√®s 8 secondes
            setTimeout(() => {
                if (window.fixAllPricesNow) {
                    console.log('üîß Correction automatique des prix...');
                    window.fixAllPricesNow();
                }
            }, 8000);
        });
        
        // Fonction de diagnostic accessible depuis la console
        window.diagnosticCrypto = function() {
            console.log('üîç === DIAGNOSTIC CRYPTO MANUEL ===');
            
            if (window.cryptoPriceUpdater) {
                const status = window.cryptoPriceUpdater.getStatus();
                console.log('üìä Statut:', status);
                
                const bnbPrice = window.cryptoPriceUpdater.getPrice('bnb');
                console.log('üí∞ Prix BNB:', bnbPrice);
                
                if (bnbPrice > 700 && bnbPrice < 800) {
                    console.log('‚úÖ Prix BNB correct (700-800‚Ç¨)');
                } else if (bnbPrice > 0) {
                    console.log('‚ö†Ô∏è Prix BNB hors plage attendue');
                } else {
                    console.log('‚ùå Prix BNB non disponible');
                }
                
                // V√©rifier l'affichage
                const bnbElement = document.querySelector('[data-crypto="bnb"]');
                if (bnbElement) {
                    const priceElement = bnbElement.querySelector('.crypto-price');
                    console.log('üéØ √âl√©ment prix BNB:', priceElement ? 'Trouv√©' : 'Manquant');
                    if (priceElement) {
                        console.log('üí∞ Prix affich√©:', priceElement.textContent);
                    }
                }
            } else {
                console.log('‚ùå cryptoPriceUpdater non disponible');
            }
        };
        
        // Fonction pour forcer la mise √† jour imm√©diate de tous les prix
        window.forceUpdateAllPrices = function() {
            console.log('üîÑ === FOR√áAGE MISE √Ä JOUR TOUS LES PRIX ===');
            
            if (window.cryptoPriceUpdater) {
                // Forcer la mise √† jour
                window.cryptoPriceUpdater.forceUpdate();
                
                // Mettre √† jour l'affichage de toutes les cartes
                setTimeout(() => {
                    const cryptoElements = document.querySelectorAll('[data-crypto]');
                    cryptoElements.forEach(element => {
                        const cryptoId = element.getAttribute('data-crypto');
                        const priceElement = element.querySelector('.crypto-price');
                        
                        if (priceElement) {
                            const price = window.cryptoPriceUpdater.getPrice(cryptoId);
                            if (price > 0) {
                                // Animation de mise √† jour
                                priceElement.classList.add('updating');
                                priceElement.textContent = `‚Ç¨${price.toLocaleString('fr-FR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
                                
                                setTimeout(() => {
                                    priceElement.classList.remove('updating');
                                }, 500);
                                
                                console.log(`‚úÖ Prix ${cryptoId} mis √† jour: ‚Ç¨${price}`);
                            }
                        }
                    });
                }, 1000);
                
            } else {
                console.log('‚ùå cryptoPriceUpdater non disponible');
            }
        };
        
        // Fonction de correction imm√©diate des prix
        window.fixAllPricesNow = function() {
            console.log('üîß === CORRECTION IMM√âDIATE DES PRIX ===');
            
            if (window.cryptoPriceUpdater) {
                // Forcer d'abord une mise √† jour des prix
                window.cryptoPriceUpdater.forceUpdate();
                
                // Attendre un peu puis mettre √† jour l'affichage
                setTimeout(() => {
                    // Mettre √† jour manuellement chaque carte
                    const cryptoElements = document.querySelectorAll('[data-crypto]');
                    let updatedCount = 0;
                    
                    cryptoElements.forEach(element => {
                        const cryptoId = element.getAttribute('data-crypto');
                        const priceElement = element.querySelector('.crypto-price');
                        
                        if (priceElement) {
                            const price = window.cryptoPriceUpdater.getPrice(cryptoId);
                        
                        if (price > 0) {
                            // Animation de mise √† jour
                            priceElement.classList.add('updating');
                            priceElement.textContent = `‚Ç¨${price.toLocaleString('fr-FR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
                            
                            setTimeout(() => {
                                priceElement.classList.remove('updating');
                            }, 500);
                            
                            updatedCount++;
                            console.log(`‚úÖ ${cryptoId}: ‚Ç¨${price.toFixed(2)}`);
                        } else {
                            console.log(`‚ö†Ô∏è Prix non disponible pour ${cryptoId}`);
                        }
                    } else {
                        console.log(`‚ùå √âl√©ment prix manquant pour ${cryptoId}`);
                    }
                });
                
                console.log(`‚úÖ ${updatedCount} cartes mises √† jour`);
                
                // Mettre √† jour l'indicateur temps r√©el
                const lastUpdateElement = document.getElementById('lastUpdateTime');
                if (lastUpdateElement) {
                    lastUpdateElement.textContent = `Derni√®re mise √† jour: ${new Date().toLocaleTimeString('fr-FR')}`;
                }
                
            } else {
                console.log('‚ùå cryptoPriceUpdater non disponible');
            }
        };
        
        // Fonction pour v√©rifier tous les prix
        window.checkAllPrices = function() {
            console.log('üîç === V√âRIFICATION TOUS LES PRIX ===');
            
            if (window.cryptoPriceUpdater) {
                const cryptos = ['bitcoin', 'ethereum', 'bnb', 'solana', 'xrp', 'dogecoin'];
                
                cryptos.forEach(cryptoId => {
                    const price = window.cryptoPriceUpdater.getPrice(cryptoId);
                    const element = document.querySelector(`[data-crypto="${cryptoId}"]`);
                    const priceElement = element?.querySelector('.crypto-price');
                    
                    console.log(`${cryptoId}: ‚Ç¨${price} ${priceElement ? '‚úÖ' : '‚ùå'}`);
                });
            } else {
                console.log('‚ùå cryptoPriceUpdater non disponible');
            }
        };
        
        // Fonction pour forcer la mise √† jour de tous les prix
        window.forceUpdateAllPrices = function() {
            console.log('üîÑ === FOR√áAGE MISE √Ä JOUR TOUS LES PRIX ===');
            
            if (window.cryptoPriceUpdater) {
                // Forcer la mise √† jour
                window.cryptoPriceUpdater.forceUpdate();
                
                // Mettre √† jour l'affichage de toutes les cartes
                setTimeout(() => {
                    const cryptoElements = document.querySelectorAll('[data-crypto]');
                    cryptoElements.forEach(element => {
                        const cryptoId = element.getAttribute('data-crypto');
                        const priceElement = element.querySelector('.crypto-price');
                        
                        if (priceElement) {
                            const price = window.cryptoPriceUpdater.getPrice(cryptoId);
                            if (price > 0) {
                                // Animation de mise √† jour
                                priceElement.classList.add('updating');
                                priceElement.textContent = `‚Ç¨${price.toLocaleString('fr-FR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
                                
                                setTimeout(() => {
                                    priceElement.classList.remove('updating');
                                }, 500);
                            }
                        }
                    });
                }, 1000);
                
            } else {
                console.log('‚ùå cryptoPriceUpdater non disponible');
            }
        };

        // Crypto AI Assistant Script
        // Base de connaissances crypto
        const cryptoKnowledge = {
            // Cryptomonnaies principales
            bitcoin: {
                name: "Bitcoin",
                symbol: "BTC",
                price: 44000,
                description: "Bitcoin est la premi√®re et plus c√©l√®bre cryptomonnaie, cr√©√©e en 2009 par Satoshi Nakamoto. C'est une monnaie num√©rique d√©centralis√©e qui fonctionne sans autorit√© centrale.",
                useCase: "R√©serve de valeur num√©rique, moyen de paiement peer-to-peer",
                technology: "Blockchain Proof-of-Work"
            },
            ethereum: {
                name: "Ethereum",
                symbol: "ETH",
                price: 2700,
                description: "Ethereum est une plateforme blockchain qui permet les contrats intelligents et les applications d√©centralis√©es (DApps).",
                useCase: "Plateforme pour DApps, DeFi, NFTs, contrats intelligents",
                technology: "Blockchain Proof-of-Stake"
            },
            cardano: {
                name: "Cardano",
                symbol: "ADA",
                price: 0.48,
                description: "Cardano est une blockchain proof-of-stake ax√©e sur la durabilit√© et la recherche acad√©mique.",
                useCase: "Plateforme pour DApps durables, gouvernance d√©centralis√©e",
                technology: "Blockchain Proof-of-Stake Ouroboros"
            }
        };

        // R√©ponses IA programm√©es
        const aiResponses = {
            greetings: [
                "Salut ! Je suis l√† pour t'aider avec tes questions crypto ! üöÄ",
                "Hello ! Pr√™t √† explorer le monde des cryptomonnaies ? üíé",
                "Bonjour ! Je suis ton assistant crypto personnel ! ‚ö°"
            ],

            // Questions sur Bitcoin
            bitcoin: {
                what: `Bitcoin (BTC) est la premi√®re cryptomonnaie cr√©√©e en 2009. C'est une monnaie num√©rique d√©centralis√©e qui utilise la technologie blockchain.

                üîπ **Cr√©ateur**: Satoshi Nakamoto (pseudonyme)
                üîπ **Prix actuel**: ~$44,000
                üîπ **Limite**: 21 millions de BTC maximum
                üîπ **Usage**: R√©serve de valeur, paiements peer-to-peer`,

                buy: `Pour acheter du Bitcoin :

                1Ô∏è‚É£ **Exchanges recommand√©s**: Binance, Coinbase, Kraken
                2Ô∏è‚É£ **√âtapes**: Inscription ‚Üí V√©rification KYC ‚Üí D√©p√¥t fiat ‚Üí Achat BTC
                3Ô∏è‚É£ **Stockage**: Wallet hardware (Ledger, Trezor) pour la s√©curit√©

                ‚ö†Ô∏è **Important**: Ne jamais investir plus que ce que vous pouvez vous permettre de perdre !`,

                price: `Le prix du Bitcoin fluctue constamment. Actuellement autour de **$44,000**.

                üìà **Facteurs d'influence**:
                ‚Ä¢ Adoption institutionnelle
                ‚Ä¢ Nouvelles r√©glementaires
                ‚Ä¢ Sentiment du march√©
                ‚Ä¢ √âv√©nements macro√©conomiques

                üí° **Conseil**: Utilisez des analyses techniques et fondamentales pour vos d√©cisions !`
            },

            // Questions sur Ethereum
            ethereum: {
                what: `Ethereum (ETH) est bien plus qu'une cryptomonnaie - c'est une plateforme blockchain compl√®te !

                üîπ **Cr√©ateur**: Vitalik Buterin (2015)
                üîπ **Prix actuel**: ~$2,700
                üîπ **Sp√©cialit√©**: Contrats intelligents & DApps
                üîπ **Consensus**: Proof-of-Stake depuis 2022`,

                vs_bitcoin: `**Bitcoin vs Ethereum** - Deux visions diff√©rentes :

                **Bitcoin (BTC)** üí∞
                ‚Ä¢ "Or num√©rique"
                ‚Ä¢ R√©serve de valeur
                ‚Ä¢ Paiements peer-to-peer
                ‚Ä¢ Proof-of-Work

                **Ethereum (ETH)** üåê
                ‚Ä¢ "Ordinateur mondial"
                ‚Ä¢ Plateforme d'applications
                ‚Ä¢ DeFi, NFTs, DApps
                ‚Ä¢ Proof-of-Stake

                üéØ **R√©sum√©**: Bitcoin = monnaie, Ethereum = plateforme !`
            },

            // Concepts g√©n√©raux
            staking: `Le **staking** consiste √† "verrouiller" vos cryptos pour s√©curiser un r√©seau blockchain et gagner des r√©compenses !

            üîπ **Comment √ßa marche**: Vous d√©l√©guez vos tokens √† un validateur
            üîπ **R√©compenses**: 4-15% APY selon la crypto
            üîπ **Cryptos stakables**: ETH, ADA, SOL, DOT, ATOM...
            üîπ **Risques**: P√©riode de verrouillage, risque de slashing

            üí° **Conseil**: Commencez avec de petits montants pour apprendre !`,

            defi: `La **DeFi** (Finance D√©centralis√©e) r√©volutionne la finance traditionnelle !

            üîπ **Principe**: Services financiers sans interm√©diaires
            üîπ **Applications**: Pr√™ts, √©changes, assurances, yield farming
            üîπ **Plateformes**: Uniswap, Aave, Compound, MakerDAO
            üîπ **Avantages**: Accessibilit√© 24/7, transparence, rendements √©lev√©s

            ‚ö†Ô∏è **Risques**: Smart contract bugs, impermanent loss, volatilit√©`,

            blockchain: `La **blockchain** est la technologie fondamentale des cryptomonnaies !

            üîπ **D√©finition**: Registre distribu√© et immuable
            üîπ **Caract√©ristiques**: D√©centralis√©, transparent, s√©curis√©
            üîπ **Blocs**: Contiennent les transactions horodat√©es
            üîπ **Consensus**: Proof-of-Work, Proof-of-Stake, etc.

            üåü **Applications**: Cryptos, NFTs, supply chain, identit√© num√©rique`,

            trading: `Le **trading crypto** n√©cessite strat√©gie et discipline !

            üìä **Types de trading**:
            ‚Ä¢ Day trading (court terme)
            ‚Ä¢ Swing trading (moyen terme)
            ‚Ä¢ HODLing (long terme)

            üîπ **Analyses essentielles**:
            ‚Ä¢ Technique (graphiques, indicateurs)
            ‚Ä¢ Fondamentale (projet, √©quipe, utilit√©)
            ‚Ä¢ Sentiment du march√©

            ‚ö†Ô∏è **R√®gle d'or**: Never invest more than you can afford to lose !`
        };

        // Donn√©es de prix simul√©es
        const currentPrices = {
            bitcoin: 44250,
            ethereum: 2680,
            binance: 315,
            cardano: 0.485,
            solana: 98,
            polkadot: 7.15,
            chainlink: 14.85,
            avalanche: 38.75
        };

        // Initialisation de l'IA Crypto
        const cryptoChatMessages = document.getElementById('cryptoChatMessages');
        const cryptoChatInput = document.getElementById('cryptoChatInput');
        const cryptoSendButton = document.getElementById('cryptoSendButton');
        const cryptoTypingIndicator = document.getElementById('cryptoTypingIndicator');

        // Fonction pour ajouter un message
        function addCryptoMessage(content, isUser = false) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user-message' : 'ai-message'}`;

            if (!isUser) {
                messageDiv.innerHTML = `<div class="bot-name">ü§ñ Assistant Crypto</div>${content}`;
            } else {
                messageDiv.textContent = content;
            }

            cryptoChatMessages.appendChild(messageDiv);
            cryptoChatMessages.scrollTop = cryptoChatMessages.scrollHeight;
        }

        // Fonction d'analyse IA des questions
        function analyzeCryptoQuestion(question) {
            const q = question.toLowerCase();

            // Salutations
            if (q.match(/\b(salut|hello|bonjour|bonsoir|coucou)\b/)) {
                return aiResponses.greetings[Math.floor(Math.random() * aiResponses.greetings.length)];
            }

            // Questions sur Bitcoin
            if (q.includes('bitcoin') || q.includes('btc')) {
                if (q.includes('prix') || q.includes('co√ªt') || q.includes('coute')) {
                    return aiResponses.bitcoin.price;
                }
                if (q.includes('acheter') || q.includes('comment')) {
                    return aiResponses.bitcoin.buy;
                }
                return aiResponses.bitcoin.what;
            }

            // Questions sur Ethereum
            if (q.includes('ethereum') || q.includes('eth')) {
                if (q.includes('diff√©rence') || q.includes('vs') || q.includes('bitcoin')) {
                    return aiResponses.ethereum.vs_bitcoin;
                }
                return aiResponses.ethereum.what;
            }

            // Questions sp√©cifiques
            if (q.includes('staking') || q.includes('stake')) {
                return aiResponses.staking;
            }

            if (q.includes('defi') || q.includes('finance d√©centralis√©e')) {
                return aiResponses.defi;
            }

            if (q.includes('blockchain') || q.includes('chaine de bloc')) {
                return aiResponses.blockchain;
            }

            if (q.includes('trading') || q.includes('trader')) {
                return aiResponses.trading;
            }

            // Questions sur les prix
            if (q.includes('prix')) {
                return generateCryptoPriceResponse(q);
            }

            // Recommandations d'investissement
            if (q.includes('investir') || q.includes('acheter') || q.includes('recommand')) {
                return `Je ne peux pas donner de conseils financiers sp√©cifiques, mais voici quelques **principes g√©n√©raux** :

                üîπ **DYOR** (Do Your Own Research)
                üîπ **Diversifiez** votre portefeuille
                üîπ **Investissez** uniquement ce que vous pouvez perdre
                üîπ **DCA** (Dollar Cost Averaging) pour r√©duire la volatilit√©
                üîπ **HODLez** pour le long terme si vous croyez au projet

                <div class="warning">‚ö†Ô∏è Ceci n'est pas un conseil financier. Consultez un conseiller qualifi√©.</div>`;
            }

            // R√©ponse par d√©faut avec suggestions
            return `Je ne suis pas s√ªr de comprendre votre question. Voici ce sur quoi je peux vous aider :

            üî∏ **Cryptomonnaies**: Bitcoin, Ethereum, Cardano, etc.
            üî∏ **Concepts**: Blockchain, DeFi, Staking, NFTs
            üî∏ **Trading**: Strat√©gies, analyses, risques
            üî∏ **Prix**: Informations sur les cours actuels

            Pouvez-vous reformuler votre question ? ü§î`;
        }

        // G√©n√©rer une r√©ponse sur les prix
        function generateCryptoPriceResponse(question) {
            let response = "**üí∞ Prix des cryptomonnaies actuels :**\n\n";

            for (const [crypto, price] of Object.entries(currentPrices)) {
                const cryptoName = crypto.charAt(0).toUpperCase() + crypto.slice(1);
                const formattedPrice = price < 1 ? `$${price.toFixed(3)}` : `$${price.toLocaleString()}`;
                response += `<span class="crypto-data">${cryptoName}: ${formattedPrice}</span> `;
            }

            response += `\n\nüìä **Note**: Les prix sont simul√©s et mis √† jour r√©guli√®rement. Pour des prix r√©els, consultez CoinGecko ou CoinMarketCap.

            <div class="warning">‚ö†Ô∏è Les prix des cryptomonnaies sont tr√®s volatils. Investissez de mani√®re responsable.</div>`;

            return response;
        }

        // Simuler l'indicateur de frappe
        function showCryptoTyping() {
            cryptoTypingIndicator.style.display = 'block';
            cryptoChatMessages.scrollTop = cryptoChatMessages.scrollHeight;
        }

        function hideCryptoTyping() {
            cryptoTypingIndicator.style.display = 'none';
        }

        // Traiter la question de l'utilisateur
        function processCryptoQuestion(question) {
            if (!question.trim()) return;

            // Ajouter la question de l'utilisateur
            addCryptoMessage(question, true);

            // D√©sactiver l'input temporairement
            cryptoChatInput.value = '';
            cryptoChatInput.disabled = true;
            cryptoSendButton.disabled = true;

            // Simuler le temps de r√©flexion de l'IA
            showCryptoTyping();

            setTimeout(() => {
                hideCryptoTyping();
                const response = analyzeCryptoQuestion(question);
                addCryptoMessage(response);

                // R√©activer l'input
                cryptoChatInput.disabled = false;
                cryptoSendButton.disabled = false;
                cryptoChatInput.focus();
            }, Math.random() * 2000 + 1000); // 1-3 secondes
        }

        // Fonction pour poser une question depuis les suggestions
        function askCryptoQuestion(question) {
            cryptoChatInput.value = question;
            processCryptoQuestion(question);
        }

        // Event listeners pour l'IA Crypto
        if (cryptoSendButton) {
            cryptoSendButton.addEventListener('click', () => {
                processCryptoQuestion(cryptoChatInput.value);
            });
        }

        if (cryptoChatInput) {
            cryptoChatInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    processCryptoQuestion(cryptoChatInput.value);
                }
            });
        }

        // Focus automatique sur l'input crypto
        if (cryptoChatInput) {
            cryptoChatInput.focus();
        }

        // Simulation de mise √† jour des prix crypto
        setInterval(() => {
            for (const crypto in currentPrices) {
                const variation = (Math.random() - 0.5) * 0.02; // ¬±1% de variation
                currentPrices[crypto] *= (1 + variation);
            }
        }, 10000); // Mise √† jour toutes les 10 secondes

        // ===== SYST√àME D'ACTUALIT√âS R√âELLES =====
        let allNews = [];
        let newsUpdateInterval;

        // Fonction principale pour r√©cup√©rer les actualit√©s
        async function fetchNews() {
            try {
                const refreshBtn = document.getElementById('newsRefreshBtn');
                const statusEl = document.getElementById('newsStatus');
                
                if (refreshBtn) {
                    refreshBtn.disabled = true;
                    refreshBtn.innerHTML = '<span class="refresh-icon">üîÑ</span><span class="refresh-text">Chargement...</span>';
                }
                
                if (statusEl) {
                    statusEl.textContent = 'Chargement des actualit√©s...';
                }

                // Afficher d'abord les actualit√©s de fallback pour une r√©ponse rapide
                displayFallbackNews();

                // R√©cup√©ration avec timeout pour √©viter les blocages
                const timeout = 8000; // 8 secondes max par API
                
                const coinTelegraphPromise = fetchCoinTelegraphNews().catch(() => []);
                const cryptoComparePromise = fetchCryptoCompareNews().catch(() => []);
                const financePromise = fetchFinanceNews().catch(() => []);

                // Attendre les r√©sultats avec timeout
                const [coinTelegraphNews, cryptoCompareNews, financeNews] = await Promise.allSettled([
                    Promise.race([coinTelegraphPromise, new Promise((_, reject) => setTimeout(() => reject(new Error('Timeout')), timeout))]),
                    Promise.race([cryptoComparePromise, new Promise((_, reject) => setTimeout(() => reject(new Error('Timeout')), timeout))]),
                    Promise.race([financePromise, new Promise((_, reject) => setTimeout(() => reject(new Error('Timeout')), timeout))])
                ]);

                // Extraire les r√©sultats valides
                const validNews = [
                    ...(coinTelegraphNews.status === 'fulfilled' ? coinTelegraphNews.value : []),
                    ...(cryptoCompareNews.status === 'fulfilled' ? cryptoCompareNews.value : []),
                    ...(financeNews.status === 'fulfilled' ? financeNews.value : [])
                ];

                if (validNews.length > 0) {
                    allNews = validNews.sort((a, b) => new Date(b.publishedAt) - new Date(a.publishedAt));
                }

                if (statusEl) {
                    statusEl.textContent = `${allNews.length} actualit√©s ‚Ä¢ Derni√®re MAJ: ${new Date().toLocaleTimeString()}`;
                }
                
                displayNews();

                if (refreshBtn) {
                    refreshBtn.disabled = false;
                    refreshBtn.innerHTML = '<span class="refresh-icon">üîÑ</span><span class="refresh-text">Actualiser</span>';
                }
            } catch (error) {
                console.error('Erreur lors du chargement des actualit√©s:', error);
                
                // En cas d'erreur, afficher les actualit√©s de fallback
                displayFallbackNews();
                
                const refreshBtn = document.getElementById('newsRefreshBtn');
                if (refreshBtn) {
                    refreshBtn.disabled = false;
                    refreshBtn.innerHTML = '<span class="refresh-icon">üîÑ</span><span class="refresh-text">Actualiser</span>';
                }
            }
        }

        // Fonction pour afficher les actualit√©s de fallback (rapide)
        function displayFallbackNews() {
            const fallbackNews = [
                {
                    id: 'fallback_1',
                    title: 'Bitcoin atteint de nouveaux sommets',
                    description: 'Le Bitcoin continue sa progression avec une adoption institutionnelle croissante...',
                    url: 'https://cointelegraph.com',
                    imageUrl: 'https://images.unsplash.com/photo-1621761191319-c6fb62004040?w=400',
                    publishedAt: new Date(),
                    source: 'CoinTelegraph',
                    category: 'cointelegraph'
                },
                {
                    id: 'fallback_2',
                    title: 'Ethereum 2.0: Am√©liorations du r√©seau',
                    description: 'Les d√©veloppements r√©cents d\'Ethereum montrent des am√©liorations significatives...',
                    url: 'https://cointelegraph.com',
                    imageUrl: 'https://images.unsplash.com/photo-1639762681485-074b7f938ba0?w=400',
                    publishedAt: new Date(Date.now() - 1800000),
                    source: 'CoinTelegraph',
                    category: 'cointelegraph'
                },
                {
                    id: 'fallback_3',
                    title: 'DeFi: Protocoles en explosion',
                    description: 'Le secteur DeFi enregistre une croissance de 300% cette ann√©e...',
                    url: '#',
                    imageUrl: 'https://images.unsplash.com/photo-1559526324-4b87b5e36e44?w=400',
                    publishedAt: new Date(Date.now() - 3600000),
                    source: 'CryptoCompare',
                    category: 'crypto'
                },
                {
                    id: 'fallback_4',
                    title: 'March√©s traditionnels et crypto',
                    description: 'Wall Street int√®gre progressivement les cryptomonnaies...',
                    url: '#',
                    imageUrl: 'https://images.unsplash.com/photo-1611974789855-9c2a0a7236a3?w=400',
                    publishedAt: new Date(Date.now() - 5400000),
                    source: 'Finance Premium',
                    category: 'finance'
                }
            ];

            allNews = fallbackNews;
            displayNews();
            
            const statusEl = document.getElementById('newsStatus');
            if (statusEl) {
                statusEl.textContent = `${fallbackNews.length} actualit√©s ‚Ä¢ Mode hors ligne`;
            }
        }

        // Fonction pour r√©cup√©rer les actualit√©s CoinTelegraph
        async function fetchCoinTelegraphNews() {
            try {
                console.log('üîÑ R√©cup√©ration des actualit√©s CoinTelegraph...');
                
                // Timeout de 5 secondes pour √©viter les blocages
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 5000);
                
                const response = await fetch('https://api.rss2json.com/v1/api.json?rss_url=https://cointelegraph.com/rss', {
                    signal: controller.signal
                });
                
                clearTimeout(timeoutId);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }
                
                const data = await response.json();
                
                if (data.status === 'ok' && data.items && data.items.length > 0) {
                    console.log('‚úÖ Actualit√©s CoinTelegraph r√©cup√©r√©es:', data.items.length);
                    return data.items.slice(0, 4).map((item, index) => ({
                        id: `cointelegraph_${index}_${Date.now()}`,
                        title: item.title,
                        description: item.description?.replace(/<[^>]*>/g, '').substring(0, 80) + '...' || '',
                        url: item.link,
                        imageUrl: item.thumbnail || item.enclosure?.link || 'https://images.unsplash.com/photo-1621761191319-c6fb62004040?w=400',
                        publishedAt: new Date(item.pubDate),
                        source: 'CoinTelegraph',
                        category: 'cointelegraph'
                    }));
                }
                
                throw new Error('Format de donn√©es CoinTelegraph invalide');
            } catch (error) {
                console.error('‚ùå Erreur CoinTelegraph:', error);
                return [];
            }
        }

        // Fonction pour r√©cup√©rer les actualit√©s CryptoCompare
        async function fetchCryptoCompareNews() {
            try {
                console.log('üîÑ R√©cup√©ration des actualit√©s CryptoCompare...');
                
                // Timeout de 5 secondes
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 5000);
                
                const response = await fetch('https://min-api.cryptocompare.com/data/v2/news/?lang=EN&limit=2', {
                    signal: controller.signal
                });
                
                clearTimeout(timeoutId);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }
                
                const data = await response.json();
                
                if (data.Response === 'Success' && data.Data && data.Data.length > 0) {
                    console.log('‚úÖ Actualit√©s CryptoCompare r√©cup√©r√©es:', data.Data.length);
                    return data.Data.map(item => ({
                        id: item.id || Math.random().toString(),
                        title: item.title,
                        description: item.body.substring(0, 80) + '...',
                        url: item.url,
                        imageUrl: item.imageurl || 'https://images.unsplash.com/photo-1639762681485-074b7f938ba0?w=400',
                        publishedAt: new Date(item.published_on * 1000),
                        source: 'CryptoCompare',
                        category: 'crypto'
                    }));
                }
                return [];
            } catch (error) {
                console.error('‚ùå Erreur CryptoCompare:', error);
                return [];
            }
        }

        // Fonction pour r√©cup√©rer les actualit√©s finance
        async function fetchFinanceNews() {
            try {
                console.log('üîÑ R√©cup√©ration des actualit√©s finance...');
                
                return [
                    {
                        id: 'finance_1',
                        title: 'March√©s traditionnels et crypto',
                        description: 'Wall Street int√®gre progressivement les cryptomonnaies...',
                        url: '#',
                        imageUrl: 'https://images.unsplash.com/photo-1611974789855-9c2a0a7236a3?w=400',
                        publishedAt: new Date(),
                        source: 'Finance Premium',
                        category: 'finance'
                    }
                ];
            } catch (error) {
                console.error('‚ùå Erreur finance news:', error);
                return [];
            }
        }

        // Fonction pour afficher les actualit√©s
        function displayNews() {
            const container = document.getElementById('newsGrid');
            if (!container) return;

            if (allNews.length === 0) {
                container.innerHTML = '<div class="news-loading"><p>Aucune actualit√© trouv√©e</p></div>';
                return;
            }

            // Limiter √† 4 actualit√©s pour un affichage plus √©pur√©
            const newsToDisplay = allNews.slice(0, 4);
            
            container.innerHTML = newsToDisplay.map(news => `
                <div class="news-card" onclick="openNews('${news.url}')">
                    ${news.imageUrl ? `<div class="news-image"><img src="${news.imageUrl}" alt="${news.title}" loading="lazy" onerror="this.style.display='none'"></div>` : ''}
                    <div class="news-content">
                        <span class="news-category ${news.category}">
                            ${news.category === 'cointelegraph' ? 'üöÄ CoinTelegraph' : 
                              news.category === 'crypto' ? '‚Çø Crypto' : 'üí∞ Finance'}
                        </span>
                        <h4 class="news-title">${news.title}</h4>
                        <p class="news-excerpt">${news.description}</p>
                        <div class="news-meta">
                            <span class="${news.source === 'CoinTelegraph' ? 'source-logo' : 'news-source'}">${news.source}</span>
                            <span class="news-time">${formatNewsTime(news.publishedAt)}</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Fonction pour formater le temps des actualit√©s
        function formatNewsTime(date) {
            const now = new Date();
            const diff = now - date;
            const minutes = Math.floor(diff / 60000);
            const hours = Math.floor(minutes / 60);
            
            if (minutes < 60) return `${minutes}min`;
            if (hours < 24) return `${hours}h`;
            return date.toLocaleDateString();
        }

        // Fonction pour ouvrir une actualit√©
        function openNews(url) {
            if (url && url !== '#') {
                window.open(url, '_blank');
            }
        }

        // Initialisation des actualit√©s au chargement de la page
        document.addEventListener('DOMContentLoaded', function() {
            // Afficher imm√©diatement les actualit√©s de fallback
            displayFallbackNews();
            
            // Charger les actualit√©s r√©elles en arri√®re-plan apr√®s 1 seconde
            setTimeout(() => {
                fetchNews();
            }, 1000);
            
            // Mise √† jour automatique toutes les 10 minutes (au lieu de 5)
            newsUpdateInterval = setInterval(fetchNews, 600000);
        });

        // Nettoyer l'intervalle lors de la fermeture de la page
        window.addEventListener('beforeunload', function() {
            if (newsUpdateInterval) {
                clearInterval(newsUpdateInterval);
            }
        });

        // Fonction de d√©bogage pour forcer le rechargement des actualit√©s
        function forceNewsRefresh() {
            console.log('üîß For√ßage du rechargement des actualit√©s...');
            fetchNews();
        }

        // Exposer les fonctions de d√©bogage globalement
        window.forceNewsRefresh = forceNewsRefresh;
        window.displayFallbackNews = displayFallbackNews;
    </script>
</body>
</html>
